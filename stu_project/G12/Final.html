<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="//cdn.jsdelivr.net/npm/phaser@3.52.0/dist/phaser.min.js"></script>
</head>


<body>
    <script>
        //game scene setting
        let cursors;
        let timer = 0;
        let objectSpeed = 2.5;
        let gameOverText = '';
        let resultBoard;
        //pause
        let pause = false;

        //CATS
        let cat_orange;
        let cat_ugly;
        let cat_pink;
        let cat_gentle;
        let cat_white;
        let cat_bomb;
        let catCathedNumber = [6];
        catCathedNumber[0] = 0; catCathedNumber[1] = 0; catCathedNumber[2] = 0;
        catCathedNumber[3] = 0; catCathedNumber[4] = 0; catCathedNumber[5] = 0;

        //score
        let highScore = 0;
        let score = 0;
        let scoreMagnification;
        let basicMagnification = 1;


        //player
        let player;
        let speed = 300;
        let jumpTimes = 1;

        const Game = {
            key: 'Game',
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: { y: 500 },
                    //debug: true
                }
            },
            preload: function () {
                //basic
                this.load.image('background', 'assets/other/background.png');
                this.load.image('trunk', 'assets/other/trunk.png');
                this.load.image('ground', 'assets/other/ground.png');
                this.load.image('ground_empty', 'assets/other/ground_empty.png');
                this.load.image('deadline', 'assets/other/deadline.png');
                this.load.image('grass', 'assets/other/grass.png');
                this.load.image('resultBoard', 'assets/other/result.png');
                this.load.image('house', 'assets/other/house.png');
                //UI
                this.load.image('pause_button', 'assets/UI/pause.png');
                this.load.image('stop_button', 'assets/UI/stop.png');
                this.load.image('play_button', 'assets/UI/play.png');
                this.load.image('restart_button', 'assets/UI/return.png');
                this.load.image('home_button', 'assets/UI/home.png');
                this.load.image('pauseScreen', 'assets/UI/gamePause.png');
                //cat
                this.load.image('cat_1', 'assets/cats/cat1.png');
                this.load.image('cat_2', 'assets/cats/cat2.png');
                this.load.image('cat_3', 'assets/cats/cat3.png');
                this.load.image('cat_4', 'assets/cats/cat4.png');
                this.load.image('cat_5', 'assets/cats/cat5.png');
                this.load.image('cat_6', 'assets/cats/cat6.png');
                //tree
                this.load.image('tree_400', 'assets/trees/tree_1.png');
                this.load.image('tree_800', 'assets/trees/tree_2.png');
                this.load.image('tree_200', 'assets/trees/tree_3.png');
                this.load.image('stump', 'assets/trees/stump.png');
                //item
                this.load.image('bubble', 'assets/items/bubble.png');
                this.load.image('bubble_fish', 'assets/items/bubble_fish.png');
                this.load.image('bubble_cucumber', 'assets/items/bubble_cucumber.png');
                this.load.image('bubble_can', 'assets/items/bubble_can.png');
                this.load.image('bubble_chocolate', 'assets/items/bubble_chocolate.png');
                this.load.image('rollingWood', 'assets/items/rollingWood.png');
                this.load.image('rock', 'assets/items/rock.png');
                //animation
                this.load.spritesheet('charater', 'assets/other/charater.png', { frameWidth: 237, frameHeight: 263 });
                this.load.spritesheet('bird', 'assets/items/bird.png', { frameWidth: 500, frameHeight: 500 });
                //audio
                this.load.audio('BGM', 'assets/audios/SandCastle.mp3');
                this.load.audio('bubblePop', 'assets/audios/bubblePop.wav');
                this.load.audio('do', 'assets/audios/do.mp3');
            },
            create: function () {
                //moving setting
                cursors = this.input.keyboard.addKeys(
                    {
                        up: Phaser.Input.Keyboard.KeyCodes.W,
                        down: Phaser.Input.Keyboard.KeyCodes.S,
                        left: Phaser.Input.Keyboard.KeyCodes.A,
                        right: Phaser.Input.Keyboard.KeyCodes.D
                    });

                //background
                this.background = this.add.tileSprite(800, 450, 1600, 900, 'background');
                this.frontBackground = this.add.tileSprite(800, 450, 1600, 900, 'trunk');
                this.movingGround = this.add.tileSprite(800, 875, 1600, 68, 'ground');
                this.grass = this.add.tileSprite(800, 815, 1600, 50, 'grass');
                this.house = this.physics.add.sprite(800, 450, 'house'); this.house.body.setAllowGravity(false);
                //text
                this.scoreText = this.add.text(16, 16, '', { font: '36px 微軟正黑體', color: 'white', backgroundColor: 'rgba(100,220,100,0.5)' });

                //pause_button
                this.pause_button = this.add.image(1550, 50, 'pause_button').setScale(0.3).setInteractive().on('pointerup', () => {

                    if (!pause) {
                        stopGame();
                        this.physics.pause();
                        blackScreen = this.add.image(800, 450, 'pauseScreen');
                        resume = this.add.image(500, 450, 'play_button').setScale(0.5).setInteractive().on('pointerup', () => {
                            resumeGame();
                            this.physics.resume();
                            resume.destroy();
                            restart.destroy();
                            menu.destroy();
                            blackScreen.destroy();
                        });
                        restart = this.add.image(800, 450, 'restart_button').setScale(0.5).setInteractive().on('pointerup', () => {
                            BGM.stop();
                            resumeGame();
                            gameScoreSet();
                            gameReset();
                            this.scene.start('Game');
                        });
                        menu = this.add.image(1100, 450, 'home_button').setScale(0.5).setInteractive().on('pointerup', () => {
                            BGM.stop();
                            resumeGame();
                            gameReset();
                            this.scene.start('House');
                        });
                    }

                });
                //audio
                BGM = this.sound.add('BGM', {
                    volume: 2,
                    loop: true
                });
                BGM.play();
                bubblepop = this.sound.add('bubblePop', {
                    volume: 1,
                    loop: false
                });
                catchted = this.sound.add('do', {
                    volume: 1,
                    loop: false
                });

                //edge
                this.ground = this.physics.add.staticGroup().create(800, 875, 'ground_empty');
                this.deadline = this.physics.add.staticGroup().create(-230, 450, 'deadline');
                this.frontLimit = this.physics.add.staticGroup().create(1700, 450, 'deadline');

                //tree
                this.stump = this.physics.add.sprite(-1000, 0, 'stump').setImmovable().setScale(0.9);
                this.tree_1 = this.physics.add.sprite(-1000, 0, 'tree_400').setImmovable();
                this.tree_2 = this.physics.add.sprite(-1000, 0, 'tree_800').setImmovable();
                this.tree_3 = this.physics.add.sprite(-1000, 0, 'tree_200').setImmovable();
                this.stump.body.setAllowGravity(false); this.tree_1.body.setAllowGravity(false); this.tree_2.body.setAllowGravity(false); this.tree_3.body.setAllowGravity(false);
                this.stump.body.friction.x = 0.4; this.tree_2.body.friction.x = 0.4; this.tree_1.body.friction.x = 0.4; this.tree_3.body.friction.x = 0.4;

                //item 
                this.rollingWood = this.physics.add.sprite(-1000, -1000, 'rollingWood').setScale(0.33).setBounce(0.2);
                this.rock = this.physics.add.sprite(-1000, -1000, 'rock').setScale(0.35);
                //cats
                cat_orange = this.physics.add.sprite(-1000, -1000, 'cat_1').setScale(0.27).setBounce(0.5).disableBody(true, true);
                cat_ugly = this.physics.add.sprite(-1000, -1000, 'cat_3').setScale(0.25).setBounce(0.6).disableBody(true, true);
                cat_pink = this.physics.add.sprite(-1000, -1000, 'cat_2').setScale(0.22).setBounce(0.7).disableBody(true, true);
                cat_gentle = this.physics.add.sprite(-1000, -1000, 'cat_4').setScale(0.27).setBounce(0.7).disableBody(true, true);
                cat_white = this.physics.add.sprite(-1000, -1000, 'cat_5').setScale(0.24).setBounce(0.6).disableBody(true, true);
                cat_bomb = this.physics.add.sprite(-1000, -1000, 'cat_6').setScale(0.24).setBounce(0.8).disableBody(true, true);

                //bubble
                this.bubble_can = this.physics.add.sprite(-1000, -1000, 'bubble_can').setScale(0.3).setInteractive().on('pointerdown', () => {
                    ScorePlus(800);
                    bubblepop.play();
                    this.bubble_can.disableBody(true, true);
                })
                this.bubble_can.disableBody(true, true); this.bubble_can.body.setAllowGravity(false);
                this.bubble_fish = this.physics.add.sprite(-1000, -1000, 'bubble_fish').setScale(0.35).setInteractive().on('pointerdown', () => {
                    ScorePlus(150);
                    bubblepop.play();
                    this.bubble_fish.disableBody(true, true);
                })
                this.bubble_fish.disableBody(true, true); this.bubble_fish.body.setAllowGravity(false);
                this.bubble_cucumber = this.physics.add.sprite(-1000, -1000, 'bubble_cucumber').setScale(0.35).setInteractive().on('pointerdown', () => {
                    ScorePlus(-400);
                    bubblepop.play();
                    this.bubble_cucumber.disableBody(true, true);
                })
                this.bubble_cucumber.disableBody(true, true); this.bubble_cucumber.body.setAllowGravity(false);
                this.bubble_chocolate = this.physics.add.sprite(-1000, -1000, 'bubble_chocolate').setScale(0.35).setInteractive().on('pointerdown', () => {
                    this.bubble_chocolate.disableBody(true, true);
                    bubblepop.play();
                    gameOver('貓咪不能吃巧克力呦 !');
                })
                this.bubble_chocolate.disableBody(true, true); this.bubble_chocolate.body.setAllowGravity(false);

                //animate
                //player
                player = this.physics.add.sprite(400, 750, 'charater').setBounce(0.1).setScale(0.7);
                this.anims.create({
                    key: 'run',
                    frames: this.anims.generateFrameNumbers('charater', { start: 0, end: 2 }),
                    frameRate: 10,
                    repeat: -1
                });
                player.anims.play('run', true);
                //bird
                this.bird = this.physics.add.sprite(-1000, -1000, 'bird').setScale(0.25); this.bird.body.setAllowGravity(false);
                this.anims.create({
                    key: 'bird_flying',
                    frames: this.anims.generateFrameNumbers('bird', { start: 0, end: 1 }),
                    frameRate: 8,
                    repeat: -1
                });
                this.bird.anims.play('bird_flying', true);


                //gameover canvas
                this.resultBoard = this.add.image(800, 450, 'resultBoard'); this.resultBoard.visible = false;
                this.resultText = this.add.text(620, 220, '', { font: '50px 微軟正黑體', color: 'black' });
                this.continue_button = this.add.image(800, 650, 'home_button').setScale(0.5).setInteractive().on('pointerup', () => {
                    resumeGame();
                    gameScoreSet();
                    gameReset();
                    BGM.stop();
                    this.scene.start('House');
                    //this.scene.start('Menu');
                }); this.continue_button.visible = false;

                //collider
                this.physics.add.collider(player, this.ground);
                this.physics.add.collider(player, this.frontLimit);
                this.physics.add.collider(player, this.stump);
                this.physics.add.collider(player, this.tree_1);
                this.physics.add.collider(player, this.tree_2);
                this.physics.add.collider(player, this.tree_3);
                this.physics.add.collider(cat_orange, this.ground);
                this.physics.add.collider(cat_orange, this.stump);
                this.physics.add.collider(cat_orange, this.tree_1);
                this.physics.add.collider(cat_orange, this.tree_2);
                this.physics.add.collider(cat_orange, this.tree_3);
                this.physics.add.collider(cat_pink, this.ground);
                this.physics.add.collider(cat_pink, this.stump);
                this.physics.add.collider(cat_pink, this.tree_1);
                this.physics.add.collider(cat_pink, this.tree_2);
                this.physics.add.collider(cat_pink, this.tree_3);
                this.physics.add.collider(cat_ugly, this.ground);
                this.physics.add.collider(cat_ugly, this.stump);
                this.physics.add.collider(cat_ugly, this.tree_1);
                this.physics.add.collider(cat_ugly, this.tree_2);
                this.physics.add.collider(cat_ugly, this.tree_3);
                this.physics.add.collider(cat_gentle, this.ground);
                this.physics.add.collider(cat_gentle, this.stump);
                this.physics.add.collider(cat_gentle, this.tree_1);
                this.physics.add.collider(cat_gentle, this.tree_2);
                this.physics.add.collider(cat_gentle, this.tree_3);
                this.physics.add.collider(cat_white, this.ground);
                this.physics.add.collider(cat_white, this.stump);
                this.physics.add.collider(cat_white, this.tree_1);
                this.physics.add.collider(cat_white, this.tree_2);
                this.physics.add.collider(cat_white, this.tree_3);
                this.physics.add.collider(cat_bomb, this.ground);
                this.physics.add.collider(cat_bomb, this.stump);
                this.physics.add.collider(cat_bomb, this.tree_1);
                this.physics.add.collider(cat_bomb, this.tree_2);
                this.physics.add.collider(cat_bomb, this.tree_3);
                this.physics.add.collider(this.rollingWood, this.ground);
                this.physics.add.collider(this.rollingWood, this.stump);
                this.physics.add.collider(this.rollingWood, this.tree_1);
                this.physics.add.collider(this.rollingWood, this.tree_2);
                this.physics.add.collider(this.rollingWood, this.tree_3);
                this.physics.add.collider(this.rock, this.ground);
                this.physics.add.overlap(player, this.deadline, deadlineTrigger);
                this.physics.add.overlap(player, this.bird, bird_touched);
                this.physics.add.overlap(player, this.rollingWood, rollwood_touched);
                this.physics.add.overlap(player, this.rock, rock_touched);
                this.physics.add.overlap(player, cat_orange, orangeCat_catched);
                this.physics.add.overlap(player, cat_pink, pinkCat_catched);
                this.physics.add.overlap(player, cat_ugly, uglyCat_catched);
                this.physics.add.overlap(player, cat_gentle, gentleCat_catched);
                this.physics.add.overlap(player, cat_white, whiteCat_catched);
                this.physics.add.overlap(player, cat_bomb, bombCat_catched);

                //cat funcion   
                function orangeCat_catched() {
                    catchted.play();
                    ScorePlus(100);
                    catCathedNumber[0]++;
                    cat_orange.disableBody(true, true);
                }
                function uglyCat_catched() {
                    catchted.play();
                    ScorePlus(300);
                    catCathedNumber[1]++;
                    cat_ugly.disableBody(true, true);
                }
                function pinkCat_catched() {
                    catchted.play();
                    ScorePlus(600);
                    catCathedNumber[2]++;
                    cat_pink.disableBody(true, true);
                }
                function gentleCat_catched() {
                    catchted.play();
                    ScorePlus(1000);
                    catCathedNumber[3]++;
                    cat_gentle.disableBody(true, true);
                }
                function whiteCat_catched() {
                    catchted.play();
                    ScorePlus(1500);
                    catCathedNumber[4]++;
                    cat_white.disableBody(true, true);
                }
                function bombCat_catched() {
                    catchted.play();
                    ScorePlus(10000);
                    catCathedNumber[5]++;
                    cat_bomb.disableBody(true, true);
                    gameOver('你犧牲自己拯\n救了炸彈貓貓');
                }
                //item funtion
                function deadlineTrigger() {
                    gameOver('你出局了><');
                }
                function bird_touched() {
                    gameOver('Chicken Attack~~');
                }
                function rollwood_touched() {
                    gameOver('  奔跑時請\n  小心滾木');
                }
                function rock_touched() {
                    if (!pause)
                        ScorePlus(-3);
                }
                //funtion
                function gameOver(killtext) {
                    player.disableBody(true, true);
                    if (!pause)
                        gameScoreSet();
                    stopGame();
                    gameOverText = killtext;
                }
                function gameScoreSet() {
                    this.scoreCount = Math.round(score + timer / 20);
                    if (this.scoreCount > highScore)
                        highScore = this.scoreCount;
                }
                function gameReset() {
                    basicMagnification = 1;
                    score = 0;
                    timer = 0;
                    gameOverText = '';
                }
                function ScorePlus(value) {
                    score += value * scoreMagnification;
                }
                function stopGame() {
                    objectSpeed = 0;
                    speed = 0;
                    pause = true;
                }
                function resumeGame() {
                    speed = 300;
                    pause = false;
                }

            },

            update: function () {
                //background moving
                this.background.tilePositionX += objectSpeed;
                this.frontBackground.tilePositionX += objectSpeed;
                this.movingGround.tilePositionX += objectSpeed;
                this.grass.tilePositionX += objectSpeed;

                if (!pause)
                    timer++;

                //charater moveing
                if (cursors.left.isDown) {
                    player.setVelocityX(-speed * 1.8);
                } else if (cursors.right.isDown) {
                    player.setVelocityX(speed);
                } else if (!cursors.left.isDown && !cursors.right.isDown) {
                    player.setVelocityX(0);
                }
                if (cursors.up.isDown && jumpTimes == 1) {
                    jumpTimes--;
                    player.setVelocityY(-530);
                }
                if (cursors.down.isDown && jumpTimes == 0) {
                    jumpTimes--;
                    player.setVelocityY(400);
                }

                //player jump controller
                if (player.body.touching.down)
                    jumpTimes = 1;
                else if (!player.body.touching.down && jumpTimes >= 0)
                    jumpTimes = 0;

                //show score
                scoreMagnification = basicMagnification + timer / 7200;
                score = Math.round(score);
                this.scoreText.setText('Score :  ' + Math.round(score + timer / 20) + '  Highscore  : ' + highScore);

                ////object
                //tree                
                //stage 1               
                if (timer < 2000) {
                    if (timer % 800 == 650) {
                        this.tree_1.enableBody(true, 1800, 610, true, true);
                    }
                    if (timer % 700 == 200) {
                        this.tree_3.enableBody(true, 1700, 350, true, true);
                    }
                    if (timer % 900 == 100) {
                        this.tree_2.enableBody(true, 2000, 610, true, true);
                    }
                }
                //stage 2
                if (timer > 2000 && timer < 5000) {
                    if (timer % 1000 == 600) {
                        tree_ramdon = Phaser.Math.Between(0, 1);
                        if (tree_ramdon == 0) {
                            this.stump.enableBody(true, 1700, 710, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.tree_2.enableBody(true, 2000, 620, true, true);
                        }
                    }
                    if (timer % 1000 == 100) {
                        tree_ramdon = Phaser.Math.Between(0, 3);
                        if (tree_ramdon == 0) {
                            this.tree_1.enableBody(true, 1700, 600, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.tree_3.enableBody(true, 1700, 550, true, true);
                        }
                        if (tree_ramdon >= 2) {
                            this.tree_3.enableBody(true, 1700, 700, true, true);
                            this.tree_1.enableBody(true, 2250, 500, true, true);
                        }
                    }
                }
                //stage 3
                if (timer > 5000 && timer < 8500) {
                    if (timer % 1000 == 100) {
                        tree_ramdon = Phaser.Math.Between(0, 2);
                        if (tree_ramdon == 0) {
                            this.tree_1.enableBody(true, 1700, 600, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.tree_1.enableBody(true, 1800, 300, true, true);
                            this.tree_3.enableBody(true, 2300, 600, true, true);
                        }
                        if (tree_ramdon >= 2) {
                            this.tree_3.enableBody(true, 1700, 600, true, true);
                            this.tree_1.enableBody(true, 2250, 600, true, true);
                        }
                    }
                    if (timer % 1000 == 600) {
                        tree_ramdon = Phaser.Math.Between(0, 1);
                        if (tree_ramdon == 0) {
                            this.stump.enableBody(true, 2300, 480, true, true);
                            this.tree_2.enableBody(true, 2000, 620, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.stump.enableBody(true, 1650, 710, true, true);
                            this.tree_2.enableBody(true, 2300, 450, true, true);
                        }
                    }
                }
                //stage 4
                if (timer > 8500) {
                    if (timer % 1000 == 600) {
                        tree_ramdon = Phaser.Math.Between(1, 1);
                        if (tree_ramdon == 0) {
                            this.tree_3.enableBody(true, 1650, 610, true, true);
                            this.tree_2.enableBody(true, 2200, 350, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.tree_3.enableBody(true, 1950, 350, true, true);
                            this.tree_2.enableBody(true, 1950, 610, true, true);
                        }
                    }
                    if (timer % 1000 == 100) {
                        tree_ramdon = Phaser.Math.Between(0, 1);
                        if (tree_ramdon == 0) {
                            this.tree_1.enableBody(true, 2200, 450, true, true);
                            this.stump.enableBody(true, 1650, 710, true, true);
                        }
                        if (tree_ramdon == 1) {
                            this.tree_1.enableBody(true, 1700, 600, true, true);
                            this.stump.enableBody(true, 2050, 710, true, true);
                        }
                    }
                }
                //bubble
                if (timer % 1200 == 100 && score > 3000)
                    this.bubble_can.enableBody(true, 1700, Phaser.Math.Between(80, 300), true, true);
                if (timer % 1000 == 400 && score > 200)
                    this.bubble_fish.enableBody(true, 1700, Phaser.Math.Between(80, 300), true, true);
                if (timer % 1000 == 900 && score > 500)
                    this.bubble_cucumber.enableBody(true, 1700, Phaser.Math.Between(80, 300), true, true);
                if (timer % 2000 == 0 && score > 5000)
                    this.bubble_chocolate.enableBody(true, 1700, Phaser.Math.Between(80, 300), true, true);
                //bird
                if (timer % 1000 == 0 && score > 6000)
                    this.bird.enableBody(true, 1900, Phaser.Math.Between(100, 200), true, true);

                //item
                if (timer % 1600 == 0 && timer > 2500)
                    this.rollingWood.enableBody(true, 2200, 450, true, true);
                this.rollingWood.rotation -= 0.05;
                if (timer % 600 == 0 && timer > 1000)
                    this.rock.enableBody(true, 1800, 800, true, true);
                //cat
                if (timer % 800 == 300 && score < 6000)
                    cat_orange.enableBody(true, 2000, 50, true, true);
                if (timer % 800 == 0 && score >= 100 && score < 15000)
                    cat_ugly.enableBody(true, 2000, 50, true, true);
                if (timer % 800 == 600 && score > 1000)
                    cat_pink.enableBody(true, 2000, 50, true, true);
                if (timer % 800 == 300 && score > 6000)
                    cat_gentle.enableBody(true, 2000, 50, true, true);
                if (timer % 800 == 0 && score > 15000)
                    cat_white.enableBody(true, 2000, 50, true, true);
                if (timer == 6000) {
                    bomb_ramdon = Phaser.Math.Between(0, 3);
                    if (bomb_ramdon == 1)
                        cat_bomb.enableBody(true, 2000, 50, true, true);
                }
                //gameover
                if (!gameOverText == '') {
                    time_sec = Math.round(timer / 140);
                    this.resultText.setText('Score :  ' + Math.round(score + timer / 20) + '\n\n' + 'Time :  ' + Math.floor(time_sec / 60) + ' min ' + Math.round(time_sec % 60) + ' sec ' + '\n\n' + gameOverText);
                    this.continue_button.setVisible(true);
                    this.resultBoard.setVisible(true);
                }
                //object speed set
                if (!pause)
                    objectSpeed = 2.5 + timer / 4000;
                //object speed  
                this.house.setVelocityX(-objectSpeed * 143);
                this.stump.setVelocityX(-objectSpeed * 143);
                this.tree_1.setVelocityX(-objectSpeed * 143);
                this.tree_2.setVelocityX(-objectSpeed * 143);
                this.tree_3.setVelocityX(-objectSpeed * 143);
                this.bubble_can.setVelocityX(-speed * 3.0);
                this.bubble_fish.setVelocityX(-speed * 2.5);
                this.bubble_cucumber.setVelocityX(-speed * 2)
                this.bubble_chocolate.setVelocityX(-speed * 2.5);
                this.bird.setVelocityX(-objectSpeed * 143 - 250);
                this.rollingWood.setVelocityX(-objectSpeed * 143 - 250);
                this.rock.setVelocityX(-objectSpeed * 143);
                cat_orange.setVelocityX(-500); cat_ugly.setVelocityX(-650); cat_pink.setVelocityX(-750);
                cat_gentle.setVelocityX(-600); cat_white.setVelocityX(-750); cat_bomb.setVelocityX(-600);
            }
        }
        const Menu = {
            key: 'Menu',
            preload: function () {
                bg = this.load.image('bkgrnd', 'assets/assets_2/pics/bkgnd.png');
                this.load.image('start', 'assets/assets_2/pics/play.png');
                this.load.image('title', 'assets/assets_2/pics/title.png');
                this.load.image('musicOn', 'assets/assets_2/pics/on.png');
                this.load.image('musicOff', 'assets/assets_2/pics/off.png');
                this.load.audio('bgmusic', 'assets/assets_2/sound/FallGuysTheme.mp3');
            },
            create: function () {
                //background  
                bg = this.add.image(800, 450, 'bkgrnd');
                //title
                t = this.add.image(775, 350, 'title').setScale(1.2);
                //music
                bgmusic = this.sound.add('bgmusic', {
                    volume: 1,
                    loop: true
                });
                bgmusic.play();
                let on = this.add.image(50, 50, 'musicOn').setScale(0.2).setInteractive().on('pointerdown', () => {
                    if (on.texture.key == 'musicOn') {
                        on.setTexture('musicOff');
                    }
                    else {
                        on.setTexture('musicOn');
                    }
                    if (bgmusic.mute) {
                        bgmusic.setMute(false);
                    } else {
                        bgmusic.setMute(true);
                    }
                });
                //start
                s = this.add.image(800, 500, 'start').setScale(1).setInteractive().on('pointerup', () => {
                    bgmusic.stop();
                    this.scene.start('House');
                });

            },
            update: function () {

            }
        }
        const House = {
            key: 'House',
            preload: function () {
                this.load.image('chousebg', 'assets/assets_2/pics/chousebg.png');
                this.load.image('musicOn', 'assets/assets_2/pics/on.png');
                this.load.image('musicOff', 'assets/assets_2/pics/off.png');
                this.load.audio('catHousemusic', 'assets/assets_2/sound/strawberry flavor love.mp3');
                this.load.image('cat1', 'assets/assets_2/cats/cat1.png');
                this.load.image('cat2', 'assets/assets_2/cats/cat2.png');
                this.load.image('cat3', 'assets/assets_2/cats/cat3.png');
                this.load.image('cat4', 'assets/assets_2/cats/cat4.png');
                this.load.image('cat5', 'assets/assets_2/cats/cat5.png');
                this.load.image('cat6', 'assets/assets_2/cats/cat6.png');
                this.load.image('backhome', 'assets/assets_2/pics/backhome.png');
                this.load.audio('catSound1', 'assets/assets_2/sound/catSound1.mp3');
                this.load.audio('catSound2', 'assets/assets_2/sound/catSound2.mp3');
                this.load.audio('catSound3', 'assets/assets_2/sound/catSound3.mp3');
                this.load.audio('bombsound', 'assets/assets_2/sound/bomb.mp3');
                this.load.image('startgm', 'assets/assets_2/pics/startgm.png');
                this.load.image('gotobook', 'assets/assets_2/pics/gotobook.png');

            },
            create: function () {
                //background  
                this.add.image(800, 450, 'chousebg').setScale(1);
                //bakc home
                this.add.image(50, 130, 'backhome').setScale(0.3).setInteractive().on('pointerdown', () => {
                    bgmusic.stop();
                    this.scene.start('Menu');
                });
                //music
                bgmusic = this.sound.add('catHousemusic', {
                    volume: 1,
                    loop: true
                });
                bgmusic.play();

                let on = this.add.image(50, 50, 'musicOn').setScale(0.2).setInteractive().on('pointerdown', () => {
                    if (on.texture.key == 'musicOn') {
                        on.setTexture('musicOff');
                    }
                    else {
                        on.setTexture('musicOn');
                    }
                    if (bgmusic.mute) {
                        bgmusic.setMute(false);
                    } else {
                        bgmusic.setMute(true);
                    }
                });
                //gotobook
                this.add.image(1450, 200, 'gotobook').setScale(0.7).setInteractive().on('pointerdown', () => {
                    bgmusic.stop();
                    this.scene.start("Book");
                });
                //startgm
                this.add.image(200, 800, 'startgm').setScale(1).setInteractive().on('pointerdown', () => {
                    bgmusic.stop();
                    this.scene.start("Game");
                });
                //showCat
                for (var i = 0; i < 3; i++) {

                    if (catCathedNumber[0] != 0) {
                        catSound1 = this.sound.add('catSound1', {
                            volume: 7,
                            loop: false
                        });
                        this.add.image(1050, 650, 'cat1').setScale(0.4).setInteractive().on('pointerdown', () => {
                            catSound1.play();
                        });
                    }
                    if (catCathedNumber[1] != 0) {
                        catSound1 = this.sound.add('catSound1', {
                            volume: 1,
                            loop: false
                        });
                        this.add.image(580, 320, 'cat4').setScale(0.3).setInteractive().on('pointerdown', () => {
                            catSound1.play();
                        });
                    }
                    if (catCathedNumber[2] != 0) {
                        catSound3 = this.sound.add('catSound3', {
                            volume: 10,
                            loop: false
                        });
                        this.add.image(650, 750, 'cat3').setScale(0.5).setInteractive().on('pointerdown', () => {
                            catSound3.play();
                        });
                    }
                    if (catCathedNumber[3] != 0) {
                        catSound3 = this.sound.add('catSound3', {
                            volume: 10,
                            loop: false
                        });
                        this.add.image(1450, 530, 'cat5').setScale(0.4).setInteractive().on('pointerdown', () => {
                            catSound3.play();
                        });
                    }
                    if (catCathedNumber[4] != 0) {
                        catSound2 = this.sound.add('catSound2', {
                            volume: 1,
                            loop: false
                        });
                        this.add.image(400, 475, 'cat2').setScale(0.4).setInteractive().on('pointerdown', () => {
                            catSound2.play();
                        });
                    }
                    if (catCathedNumber[5] != 0) {
                        bombsound = this.sound.add('bombsound', {
                            volume: 1,
                            loop: false
                        });
                        this.add.image(1125, 350, 'cat6').setScale(0.15).setInteractive().on('pointerdown', () => {
                            bombsound.play();
                        });
                    }
                }
            },
            update: function () {

            }
        }
        const Book = {
            key: 'Book',
            preload: function () {
                this.load.image('chousebgDark', 'assets/assets_2/pics/chousebgDark.jpg');
                this.load.image('book', 'assets/assets_2/pics/book.png');
                this.load.image('list', 'assets/assets_2/pics/list.png');
                this.load.image('musicOn', 'assets/assets_2/pics/on.png');
                this.load.image('musicOff', 'assets/assets_2/pics/off.png');
                this.load.audio('catHousemusic', 'assets/assets_2/sound/strawberry flavor love.mp3');
                this.load.audio('pt', 'assets/assets_2/sound/page turn.mp3');
                c1 = this.load.image('cat1', 'assets/assets_2/cats/cat1.png');
                c2 = this.load.image('cat2', 'assets/assets_2/cats/cat2.png');
                c3 = this.load.image('cat3', 'assets/assets_2/cats/cat3.png');
                c4 = this.load.image('cat4', 'assets/assets_2/cats/cat4.png');
                this.load.image('cat5', 'assets/assets_2/cats/cat5.png');
                this.load.image('cat6', 'assets/assets_2/cats/cat6.png');
                this.load.image('backhome', 'assets/assets_2/pics/backhome.png');
                this.load.image('dlgbox', 'assets/assets_2/pics/dlgbox.jpg');
                this.load.image('cat1_1txt', 'assets/assets_2/bookwd//cat11.png');
                this.load.image('cat2_1txt', 'assets/assets_2/bookwd//cat21.png');
                this.load.image('cat3_1txt', 'assets/assets_2/bookwd//cat31.png');
                this.load.image('cat4_1txt', 'assets/assets_2/bookwd//cat41.png');
                this.load.image('cat5_1txt', 'assets/assets_2/bookwd//cat51.png');
                this.load.image('cat6_1txt', 'assets/assets_2/bookwd//cat61.png');
                this.load.image('cat1_2txt', 'assets/assets_2/bookwd//cat12.png');
                this.load.image('cat2_2txt', 'assets/assets_2/bookwd//cat22.png');
                this.load.image('cat3_2txt', 'assets/assets_2/bookwd//cat32.png');
                this.load.image('cat4_2txt', 'assets/assets_2/bookwd//cat42.png');
                this.load.image('cat5_2txt', 'assets/assets_2/bookwd//cat52.png');
                this.load.image('cat6_2txt', 'assets/assets_2/bookwd//cat62.png');
                this.load.image('next', 'assets/assets_2/pics/right.png');
                this.load.image('back', 'assets/assets_2/pics/left.png');
            },
            create: function () {
                //background  
                this.add.image(800, 450, 'chousebgDark').setScale(1);
                //book
                this.add.image(800, 450, 'book').setScale(1.4);
                //cats
                for (var i = 0; i < 4; i++) {	//P1左上貓
                    let myFont = {
                        font: '20px 微軟正黑體',
                        fill: '#4B0091',
                    };
                    if (catCathedNumber[0] > 0) {
                        c1 = this.add.image(390, 200, 'cat1').setScale(0.5);
                        cat1txt = this.add.text(390, 350, '數量:' + catCathedNumber[0], myFont);
                        if (catCathedNumber[0] >= 3) {
                            d1 = this.add.image(670, 160, 'cat1_1txt').setScale(0.3);
                        }
                        if (catCathedNumber[0] >= 10) {
                            d2 = this.add.image(670, 325, 'cat1_2txt').setScale(0.3);
                        }
                    }
                    //P1右下貓
                    if (catCathedNumber[1] > 0) {
                        c2 = this.add.image(700, 540, 'cat4').setScale(0.5);
                        cat1txt = this.add.text(650, 680, '數量:' + catCathedNumber[1], myFont);
                        if (catCathedNumber[1] >= 3) {
                            d3 = this.add.image(450, 520, 'cat4_1txt').setScale(0.3);
                        }
                        if (catCathedNumber[1] >= 10) {
                            d4 = this.add.image(450, 640, 'cat4_2txt').setScale(0.3);
                        }
                    }
                    //P2左上貓
                    if (catCathedNumber[2] > 0) {
                        c3 = this.add.image(1000, 200, 'cat3').setScale(0.5);
                        cat1txt = this.add.text(980, 340, '數量:' + catCathedNumber[2], myFont);
                        if (catCathedNumber[2] >= 3) {
                            d5 = this.add.image(1270, 160, 'cat3_1txt').setScale(0.3);
                        }
                        if (catCathedNumber[2] >= 10) {
                            d6 = this.add.image(1270, 325, 'cat3_2txt').setScale(0.3);
                        }
                    }
                    //P2右下貓
                    if (catCathedNumber[3] > 0) {
                        c4 = this.add.image(1200, 550, 'cat5').setScale(0.5);
                        cat1txt = this.add.text(1150, 690, '數量:' + catCathedNumber[3], myFont);
                        if (catCathedNumber[3] >= 3) {
                            d7 = this.add.image(950, 500, 'cat5_1txt').setScale(0.3);
                        }
                        if (catCathedNumber[3] >= 10) {
                            d8 = this.add.image(950, 620, 'cat5_2txt').setScale(0.3);
                        }
                    }
                }
                //nextPage
                n = this.add.image(1500, 450, 'next').setScale(0.3).setInteractive().on('pointerdown', () => {
                    //翻頁聲
                    pt = this.sound.add('pt', {
                        volume: 1,
                        loop: false
                    });
                    pt.play();
                    //隱藏下頁鍵
                    n.setVisible(false);
                    b.setVisible(true);

                    let myFont = {
                        font: '20px 微軟正黑體',
                        fill: '#4B0091',
                    };
                    this.add.image(800, 450, 'book').setScale(1.4);
                    this.add.image(1100, 300, 'list').setScale(0.25);
                    if (catCathedNumber[4] > 0) {
                        c5 = this.add.image(390, 200, 'cat2').setScale(0.5);
                        cat1txt = this.add.text(390, 350, '數量:' + catCathedNumber[4], myFont);
                        if (catCathedNumber[4] >= 3) {
                            d1 = this.add.image(680, 160, 'cat2_1txt').setScale(0.3);
                        }
                        if (catCathedNumber[4] >= 10) {
                            d2 = this.add.image(670, 325, 'cat2_2txt').setScale(0.3);
                        }
                    }
                    //P3右下貓
                    if (catCathedNumber[5] > 0) {
                        c6 = this.add.image(690, 540, 'cat6').setScale(0.4);
                        cat1txt = this.add.text(650, 680, '數量:' + catCathedNumber[5], myFont);
                        d3 = this.add.image(390, 500, 'cat6_1txt').setScale(0.3);
                        if (catCathedNumber[5] >= 2) {
                            d4 = this.add.image(390, 620, 'cat6_2txt').setScale(0.3);
                        }
                    }
                });
                //lastPage
                b = this.add.image(100, 450, 'back').setScale(0.3).setInteractive().on('pointerdown', () => {
                    //翻頁聲
                    pt = this.sound.add('pt', {
                        volume: 1,
                        loop: false
                    });
                    pt.play();
                    //隱藏上頁鍵
                    b.setVisible(false);
                    n.setVisible(true);
                    for (var i = 0; i < 4; i++) {	//P1左上貓
                        let myFont = {
                            font: '20px 微軟正黑體',
                            fill: '#4B0091',
                        };
                        this.add.image(800, 450, 'book').setScale(1.4);
                        if (catCathedNumber[0] > 0) {
                            c1 = this.add.image(390, 200, 'cat1').setScale(0.5);
                            cat1txt = this.add.text(390, 350, '數量:' + catCathedNumber[0], myFont);
                            if (catCathedNumber[0] >= 3) {
                                d1 = this.add.image(670, 160, 'cat1_1txt').setScale(0.3);
                            }
                            if (catCathedNumber[0] >= 10) {
                                d2 = this.add.image(670, 325, 'cat1_2txt').setScale(0.3);
                            }
                        }
                        //P1右下貓
                        if (catCathedNumber[1] > 0) {
                            c2 = this.add.image(700, 540, 'cat4').setScale(0.5);
                            cat1txt = this.add.text(650, 680, '數量:' + catCathedNumber[1], myFont);
                            if (catCathedNumber[1] >= 3) {
                                d3 = this.add.image(450, 520, 'cat4_1txt').setScale(0.3);
                            }
                            if (catCathedNumber[1] >= 10) {
                                d4 = this.add.image(450, 640, 'cat4_2txt').setScale(0.3);
                            }
                        }
                        //P2左上貓
                        if (catCathedNumber[2] > 0) {
                            c3 = this.add.image(1000, 200, 'cat3').setScale(0.5);
                            cat1txt = this.add.text(980, 340, '數量:' + catCathedNumber[2], myFont);
                            if (catCathedNumber[2] >= 3) {
                                d5 = this.add.image(1270, 160, 'cat3_1txt').setScale(0.3);
                            }
                            if (catCathedNumber[2] >= 10) {
                                d6 = this.add.image(1270, 325, 'cat3_2txt').setScale(0.3);
                            }
                        }
                        //P2右下貓
                        if (catCathedNumber[3] > 0) {
                            c4 = this.add.image(1200, 550, 'cat5').setScale(0.5);
                            cat1txt = this.add.text(1150, 690, '數量:' + catCathedNumber[3], myFont);
                            if (catCathedNumber[3] >= 3) {
                                d7 = this.add.image(950, 500, 'cat5_1txt').setScale(0.3);
                            }
                            if (catCathedNumber[3] >= 10) {
                                d8 = this.add.image(950, 620, 'cat5_2txt').setScale(0.3);
                            }
                        }
                    }
                });
                //back home
                this.add.image(50, 130, 'backhome').setScale(0.3).setInteractive().on('pointerdown', () => {
                    bgmusic.stop();
                    this.scene.start('House');
                });
                //music
                bgmusic = this.sound.add('catHousemusic', {
                    volume: 1,
                    loop: true
                });
                bgmusic.play();

                let on = this.add.image(50, 50, 'musicOn').setScale(0.2).setInteractive().on('pointerdown', () => {
                    if (on.texture.key == 'musicOn') {
                        on.setTexture('musicOff');
                    }
                    else {
                        on.setTexture('musicOn');
                    }
                    if (bgmusic.mute) {
                        bgmusic.setMute(false);
                    } else {
                        bgmusic.setMute(true);
                    }
                });
            },
            update: function () {

            }
        }
        const config = {
            type: Phaser.AUTO,
            width: 1600,
            height: 900,
            backgroundColor: '#00000',
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH
            },
            scene: [
                Menu,
                Game,
                Book,
                House,
            ]
        }
        const game = new Phaser.Game(config);
    </script>