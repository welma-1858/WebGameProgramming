<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="assets/role/boy.png">
    <title>減肥吧!豬豬</title>
    <script src="js/phaser.js"></script>
    <script src="js/phaser.min.js"></script>

    <style type="text/css">
        body {
            margin: 0 auto;
        }
    </style>
</head>

<body>
    <script>
        /* ============================================================================================================== */
        //開始
        const scene_start_Config = {
            key: 'scene_start',
            active: true,
            preload: scene_start_preload,
            create: scene_start_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //房間
        const scene_room_Config = {
            key: 'scene_room',
            active: false,
            preload: scene_room_preload,
            create: scene_room_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第一關
        const scene_part1_Config = {
            key: 'scene_part1',
            active: false,
            preload: scene_part1_preload,
            create: scene_part1_create,
            update: scene_part1_update,
            extend: {
                move_brick1: move_brick1,
                move_brick2: move_brick2,
                collectLove: collectLove,
                pass_map1: pass_map1,
                Hit_wall: Hit_wall,
                Hit_U_wall: Hit_U_wall,
                lose: lose,
                collectFlower: collectFlower
            }
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //換關變數
        let wardrobe_num = 0,
            backpack_num = 0;
        let map2_to_map1 = false;
        let map1_pass = false;
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第一關劇情
        const scene_part1_text_Config = {
            key: 'scene_part1_text',
            active: false,
            preload: scene_part1_text_preload,
            create: scene_part1_text_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第二關
        const scene_part2_Config = {
            key: 'scene_part2',
            active: false,
            preload: scene_part2_preload,
            create: scene_part2_create,
            update: scene_part2_update,
            extend: {
                pass: pass,
                collectEgg: collectEgg,
                collectflour: collectflour,
                collectmilk: collectmilk,
                create_mul_egg: create_mul_egg,
                giveEgg: giveEgg,
                collectdrug: collectdrug,
                collectDumb: collectDumb,
                // collectpoison: collectpoison,
                moveL: moveL,
                moveR: moveR,
                moveU: moveU,
                moveD: moveD,
                pickBP: pickBP
            }
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第二關劇情
        const scene_part2_text_Config = {
            key: 'scene_part2_text',
            active: false,
            preload: scene_part2_text_preload,
            create: scene_part2_text_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第三關
        const scene_part3_Config = {
            key: 'scene_part3',
            active: false,
            preload: scene_part3_preload,
            create: scene_part3_create,
            update: scene_part3_update,
            extend: {
                appear_boss: appear_boss,
                secound_shit: secound_shit,
                shut_UR: shut_UR,
                shut_DL: shut_DL,
                secound_appear: secound_appear,
                appear_trapUD: appear_trapUD,
                appear_trapLR: appear_trapLR,
                secound_move: secound_move,
                move_WS1: move_WS1,
                move_WH2: move_WH2,
                move_WH3: move_WH3,
                move_MS1: move_MS1,
                move_MH1: move_MH1,
                loseLove: loseLove,
                lose_love_W: lose_love_W,
                lose_love_M: lose_love_M,
                lose_love_tD: lose_love_tD,
                lose_love_t: lose_love_t,
                influence_speed_H_4: influence_speed_H_4,
                influence_speed_S_2: influence_speed_S_2,
                influence_speed_S_4: influence_speed_S_4,
                influence_speed_S: influence_speed_S,
                trap_move_1: trap_move_1,
                trap_move_2: trap_move_2,
                trap_move_3: trap_move_3,
                Recap: Recap,
                chat_Awan: chat_Awan,
                wind_change_speed: wind_change_speed,
                set_poison: set_poison,
                lose_map3: lose_map3,
                win: win,
            }
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第三關劇情
        const scene_part3_text_Config = {
            key: 'scene_part3_text',
            active: false,
            preload: scene_part3_text_preload,
            create: scene_part3_text_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第四關
        const scene_part4_Config = {
            key: 'scene_part4',
            active: false,
            preload: scene_part4_preload,
            create: scene_part4_create,
            update: scene_part4_update,
            extend: {
                secound_move4: secound_move4,
                move_BS1: move_BS1,
                move_BH1: move_BH1,
                move_BH2: move_BH2,
                move_BCH3: move_BCH3,
                move_BCS3: move_BCS3,
                move_BPH: move_BPH,
                move_BPS: move_BPS,
                collect_flower: collect_flower,
                move_brick: move_brick,
                changeMove1: changeMove1,
                changeMove2: changeMove2,
                loseLove_map4: loseLove_map4,
                lose_love_M_map4: lose_love_M_map4,
                ugle_move4: ugle_move4,
                c_ugle_move: c_ugle_move,
                move_1: move_1,
                move_2: move_2,
                move_3: move_3,
                move_4: move_4,
                Lighting: Lighting,
                CVD_speed: CVD_speed,
                CVR_speed: CVR_speed,
                wind_water: wind_water,
                music: music,
                lose_map4: lose_map4
            }
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第四關劇情
        const scene_part4_text_Config = {
            key: 'scene_part4_text',
            active: false,
            preload: scene_part4_text_preload,
            create: scene_part4_text_create
        };
        /* ==============================================================================================================*/

        /* ============================================================================================================== */
        //遊戲失敗 & 重新開始 & 回上一關
        const scene_lose_Config = {
            key: 'scene_lose',
            active: false,
            preload: scene_lose_preload,
            create: scene_lose_create
        };
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        const config = {
            type: Phaser.AUTO,
            width: 1920,
            height: 1080,
            scale: {
                mode: Phaser.Scale.FIT,
                autoCenter: Phaser.Scale.CENTER_BOTH
            },
            physics: {
                default: 'arcade',
                arcade: {
                    gravity: {
                        y: 0
                    },
                    debug: false
                }
            },
            scene: [scene_start_Config, scene_room_Config, scene_part1_Config, scene_part1_text_Config,
                scene_part2_Config, scene_part2_text_Config, scene_part3_Config, scene_part3_text_Config,
                scene_part4_Config, scene_part4_text_Config,
                scene_lose_Config
            ]
        };
        const game = new Phaser.Game(config);
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //開始

        function scene_start_preload() {
            /* ============================================================================================================== */
            //開始
            this.load.image('background', 'assets/start/start-20.jpg');
            this.load.spritesheet('startbtn', 'assets/start/start_btn.png', {
                frameWidth: 531,
                frameHeight: 644
            });
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //說明
            this.load.image('explainground', 'assets/explain/explain.png');
            this.load.spritesheet('explaintext', 'assets/explain/explain_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            this.load.spritesheet('backbtn', 'assets/explain/backbtn.png', {
                frameWidth: 322,
                frameHeight: 108
            });
            this.load.spritesheet('nextbtn', 'assets/explain/nextbtn.png', {
                frameWidth: 322,
                frameHeight: 108
            });
            this.load.spritesheet('gobtn', 'assets/explain/gobtn.png', {
                frameWidth: 322,
                frameHeight: 108
            });
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //前情提要
            this.load.image('recapground', 'assets/explain/recap.png');
            this.load.spritesheet('recaptext', 'assets/explain/recap_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');
            this.load.audio('startmusic', 'assets/backgroundmusic/1_start.mp3');
            /* ============================================================================================================== */

        }

        let start, startBtn, start_bird; //開始

        let explain, explaintext, explain_backbtn, explain_nextbtn, explain_gobtn; //說明

        let recap, recap_text, recap_backbtn, recap_nextbtn, recap_gobtn, t = 0; //前情提要

        let startmusic; //音樂音效

        function scene_start_create() {
            /* ============================================================================================================== */
            //音樂音效
            startmusic = this.sound.add('startmusic', {
                volume: 1,
                loop: true
            });
            startmusic.play();
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //開始

            start = this.add.sprite(0, 0, 'background').setOrigin(0, 0);

            //開始按鈕

            startBtn = this.add.sprite(110, 510, 'startbtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    startBtn.setFrame(1);
                })
                .on('pointerout', () => {
                    startBtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    startBtn.setFrame(1);
                })
                .on('pointerup', () => {
                    explain.setVisible(true);
                    explaintext.setVisible(true);
                    explain_nextbtn.setVisible(true);
                    explain_gobtn.setVisible(true);
                });
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //說明

            explain = this.add.image(0, 0, 'explainground').setOrigin(0, 0);
            explaintext = this.add.sprite(0, 0, 'explaintext').setOrigin(0, 0);
            explain_backbtn = this.add.sprite(600, 870, 'backbtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    explain_backbtn.setFrame(1);
                })
                .on('pointerout', () => {
                    explain_backbtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    explain_backbtn.setFrame(1);
                })
                .on('pointerup', () => {
                    explain_nextbtn.setVisible(true);
                    explain_backbtn.setVisible(false);
                    explaintext.setFrame(0);
                });
            explain_nextbtn = this.add.sprite(950, 870, 'nextbtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    explain_nextbtn.setFrame(1);
                })
                .on('pointerout', () => {
                    explain_nextbtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    explain_nextbtn.setFrame(1);
                })
                .on('pointerup', () => {
                    explain_backbtn.setVisible(true);
                    explain_nextbtn.setVisible(false);
                    explaintext.setFrame(1);
                });
            explain_gobtn = this.add.sprite(1300, 870, 'gobtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    explain_gobtn.setFrame(1);
                })
                .on('pointerout', () => {
                    explain_gobtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    explain_gobtn.setFrame(1);
                })
                .on('pointerup', () => {
                    //關閉說明
                    explain.setVisible(false);
                    explaintext.setVisible(false);
                    explain_backbtn.setVisible(false);
                    explain_nextbtn.setVisible(false);
                    explain_gobtn.setVisible(false);
                    //開啟前情
                    recap.setVisible(true);
                    recap_text.setVisible(true);
                    recap_nextbtn.setVisible(true);
                    recap_gobtn.setVisible(true);
                });
            explain.setVisible(false);
            explaintext.setVisible(false);
            explain_backbtn.setVisible(false);
            explain_nextbtn.setVisible(false);
            explain_gobtn.setVisible(false);
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //前情提要

            recap = this.add.image(0, 0, 'recapground').setOrigin(0, 0);
            recap_text = this.add.sprite(0, 0, 'recaptext').setOrigin(0, 0);
            recap_backbtn = this.add.sprite(600, 870, 'backbtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    recap_backbtn.setFrame(1);
                })
                .on('pointerout', () => {
                    recap_backbtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    recap_backbtn.setFrame(1);
                })
                .on('pointerup', () => {
                    if (t > 0)
                        t--;
                    recap_text.setFrame(t);
                    if (recap_text.setFrame(t) && t < 3)
                        recap_nextbtn.setVisible(true);
                    if (recap_text.setFrame(t) && t < 1)
                        recap_backbtn.setVisible(false);
                });
            recap_nextbtn = this.add.sprite(950, 870, 'nextbtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    recap_nextbtn.setFrame(1);
                })
                .on('pointerout', () => {
                    recap_nextbtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    recap_nextbtn.setFrame(1);
                })
                .on('pointerup', () => {
                    if (t < 3)
                        t++
                        recap_text.setFrame(t);
                    if (recap_text.setFrame(t) && t > 0)
                        recap_backbtn.setVisible(true);
                    if (recap_text.setFrame(t) && t > 2)
                        recap_nextbtn.setVisible(false);
                });
            recap_gobtn = this.add.sprite(1300, 870, 'gobtn').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerover', () => {
                    recap_gobtn.setFrame(1);
                })
                .on('pointerout', () => {
                    recap_gobtn.setFrame(0);
                })
                .on('pointerdown', () => {
                    recap_gobtn.setFrame(1);
                })
                .on('pointerup', () => {
                    //音樂
                    startmusic.stop();

                    //第一關
                    this.scene.start('scene_part3');
                    this.scene.stop('scene_start');
                });
            //跳過
            recap.setVisible(false);
            recap_text.setVisible(false);
            recap_backbtn.setVisible(false);
            recap_nextbtn.setVisible(false);
            recap_gobtn.setVisible(false);
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //開啟/關閉音樂

            let speaker = this.add.image(config.width - 50, config.height - 50, 'speaker').setScale(0.2)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (startmusic.mute) {
                        startmusic.setMute(false);
                    } else {
                        startmusic.setMute(true);
                    }
                });
            /* ============================================================================================================== */

        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //房間
        function scene_room_preload() {
            /* ============================================================================================================== */
            //衣櫃背包
            this.load.image("room_back", "assets/room/room_back.png");
            this.load.image("room_wardrobe", "assets/room/room_wardrobe.png");
            this.load.image("room_pig", "assets/room/room_pig.png");
            this.load.image("room_backpack", "assets/room/room_backpack.png");
            this.load.image("room_bed", "assets/room/room_bed.png");
            this.load.image("wardrobe_window", "assets/room/wardrobe_click.png");
            this.load.image("wardrobe_back", "assets/room/wardrobe_back.png");
            this.load.image("wardrobe_next", "assets/room/wardrobe_next.png");
            this.load.image("wardrobe_open", "assets/room/wardrobe_open.png");
            this.load.image("btn_go1", "assets/room/btn_Gogame1.png");
            this.load.image("btn_go2", "assets/room/btn_Gogame2.png");
            this.load.image("btn_go3", "assets/room/btn_Gogame3.png");
            this.load.image("btn_go4", "assets/room/btn_Gogame4.png");
            this.load.image("backpack_window", "assets/room/backpack_window.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //衣服
            this.load.image("Fboy", "assets/role/fat_boy.png");
            this.load.image("clothe1", "assets/clothes/clothe1_1.png");
            this.load.image("clothe2", "assets/clothes/clothe2_1.png");
            this.load.image("clothe3", "assets/clothes/clothe3_1.png");
            this.load.image("clothe4", "assets/clothes/clothe4_1.png");
            this.load.image("clothe5", "assets/clothes/clothe5_1.png");
            this.load.image("clothe6", "assets/clothes/clothe6_1.png");
            this.load.image("clothe7", "assets/clothes/clothe7_1.png");
            this.load.image("clothe8", "assets/clothes/clothe8_1.png");
            this.load.image("clothe9", "assets/clothes/clothe9_1.png");
            this.load.image("clothe10", "assets/clothes/clothe10_1.png");
            this.load.image("clothe11", "assets/clothes/clothe11_1.png");
            this.load.image("clothe12", "assets/clothes/clothe12_1.png");
            this.load.image("clothe13", "assets/clothes/clothe13_1.png");

            this.load.image("clothe1_change", "assets/clothes/clothe1.png");
            this.load.image("clothe2_change", "assets/clothes/clothe2.png");
            this.load.image("clothe3_change", "assets/clothes/clothe3.png");
            this.load.image("clothe4_change", "assets/clothes/clothe4.png");
            this.load.image("clothe5_change", "assets/clothes/clothe5.png");
            this.load.image("clothe6_change", "assets/clothes/clothe6.png");
            this.load.image("clothe7_change", "assets/clothes/clothe7.png");
            this.load.image("clothe8_change", "assets/clothes/clothe8.png");
            this.load.image("clothe9_change", "assets/clothes/clothe9.png");
            this.load.image("clothe10_change", "assets/clothes/clothe10.png");
            this.load.image("clothe11_change", "assets/clothes/clothe11.png");
            this.load.image("clothe12_change", "assets/clothes/clothe12.png");
            this.load.image("clothe13_change", "assets/clothes/clothe13.png");
            /* ============================================================================================================== */

            //map2道具
            this.load.image("egg", "assets/map2/tool2_egg.png");
            this.load.image("drug", "assets/tool/tool_drug.png");
            this.load.image("poison", "assets/tool/poison.png");
            this.load.image("Dumbbell", "assets/tool/Dumbbell.png");

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');

            this.load.audio('room_music', 'assets/backgroundmusic/room.mp3');
            /* ============================================================================================================== */
        }

        let room_wardrobe; //衣櫃背包
        let wardrobe_window;
        let backpack_window;
        let btn_go1, btn_go2, btn_go3, btn_go4;
        let back, wardrobe, pig, backpack, bed;
        let wardrobe_back, wardrobe_next;
        let clothe1, clothe2, clothe3, clothe4, clothe5, clothe6, c = 0;

        let Fboy_clothe = 0;

        let room_music;

        function scene_room_create() {
            /* ============================================================================================================== */
            //音樂音效
            room_music = this.sound.add('room_music', {
                volume: 1,
                loop: true
            });
            room_music.play();
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //衣櫃背包

            var wardrobe_click = false;
            var backpack_click = false;

            let room_back = this.add.image(0, 0, "room_back").setOrigin(0, 0);
            room_wardrobe = this.add.image(750, 0, "room_wardrobe").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    wardrobe_click = !wardrobe_click;
                    if (wardrobe_click == true) {
                        wardrobe_window.setVisible(true);
                        switch (wardrobe_num) {
                            case 0:

                                break;
                            case 1:
                                wardrobe_next.setVisible(true);
                                clothe1.setVisible(true);
                                clothe2.setVisible(true);
                                clothe3.setVisible(true);
                                clothe4.setVisible(true);
                                clothe5.setVisible(true);
                                clothe6.setVisible(true);
                                break;
                        }

                        backpack.setVisible(false);
                        room_wardrobe.setTexture('wardrobe_open');
                    } else {
                        wardrobe_window.setVisible(false);
                        wardrobe_back.setVisible(false);
                        wardrobe_next.setVisible(false);
                        clothe1.setVisible(false);
                        clothe2.setVisible(false);
                        clothe3.setVisible(false);
                        clothe4.setVisible(false);
                        clothe5.setVisible(false);
                        clothe6.setVisible(false);
                        c = 0;
                        backpack.setVisible(true);
                        room_wardrobe.setTexture('room_wardrobe');
                    }
                });
            let room_bed = this.add.image(0, 105, "room_bed").setOrigin(0, 0);
            let room_pig = this.add.image(1320, 480, "room_pig").setOrigin(0, 0);

            backpack = this.add.image(-80, 520, "room_backpack").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    backpack_click = !backpack_click;
                    if (backpack_click == true) {
                        backpack_window.setVisible(true);
                        room_wardrobe.setVisible(false);

                        switch (backpack_num) {
                            case 0:
                                if (map2_to_map1) {
                                    btn_go1.setVisible(true);
                                    btn_go2.setVisible(true);
                                } else {
                                    btn_go1.setVisible(true);
                                }
                                break;
                            case 1:
                                btn_go1.setVisible(true);
                                btn_go2.setVisible(true);
                                break;
                            case 2:
                                btn_go1.setVisible(true);
                                btn_go2.setVisible(true);
                                btn_go3.setVisible(true);
                                break;
                            case 3:
                                btn_go1.setVisible(true);
                                btn_go2.setVisible(true);
                                btn_go3.setVisible(true);
                                btn_go4.setVisible(true);
                                break;
                        }

                        if (egg_num > 0) {
                            B_egg.setVisible(true);
                            B1_text.setVisible(true);
                        }
                        if (Dumb_num > 0) {
                            B_Dumb.setVisible(true);
                            B2_text.setVisible(true);

                        }
                        if (drug_num > 0) {
                            B_drug.setVisible(true);
                            B3_text.setVisible(true);

                        }
                        if (poison_num > 0) {
                            B_poison.setVisible(true);
                            B4_text.setVisible(true);
                        }

                    } else {
                        backpack_window.setVisible(false);
                        btn_go1.setVisible(false);
                        btn_go2.setVisible(false);
                        btn_go3.setVisible(false);
                        btn_go4.setVisible(false);

                        B_egg.setVisible(false);
                        B1_text.setVisible(false);

                        B_Dumb.setVisible(false);
                        B2_text.setVisible(false);

                        B_drug.setVisible(false);
                        B3_text.setVisible(false);

                        B4_text.setVisible(false);
                        B_poison.setVisible(false);

                        room_wardrobe.setVisible(true);
                    }
                });
            wardrobe_window = this.add.image(0, 0, "wardrobe_window").setOrigin(0, 0);
            wardrobe_window.setVisible(false);
            wardrobe_back = this.add.image(20, 475, "wardrobe_back").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    wardrobe_next.setVisible(true);
                    c--;
                    switch (c) {
                        case 0:
                            clothe1.setTexture('clothe1');
                            clothe3.setTexture('clothe3');
                            clothe5.setTexture('clothe5');

                            clothe2.setTexture('clothe2');
                            clothe4.setTexture('clothe4');
                            clothe6.setTexture('clothe6');
                            break;
                        case 1:
                            clothe1.setTexture('clothe2');
                            clothe3.setTexture('clothe4');
                            clothe5.setTexture('clothe6');

                            clothe2.setTexture('clothe7');
                            clothe4.setTexture('clothe9');
                            clothe6.setTexture('clothe11');
                            break;
                        case 2:
                            clothe1.setTexture('clothe7');
                            clothe3.setTexture('clothe9');
                            clothe5.setTexture('clothe11');

                            clothe2.setTexture('clothe8');
                            clothe4.setTexture('clothe10');
                            clothe6.setTexture('clothe12');

                            clothe6.setVisible(true);
                            break;

                    }

                    if (c < 3) {
                        wardrobe_next.setVisible(true);
                    }

                    if (c < 1) {
                        wardrobe_back.setVisible(false);
                        c = 0;
                    }

                });
            wardrobe_back.setVisible(false);
            wardrobe_next = this.add.image(850, 475, "wardrobe_next").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    wardrobe_back.setVisible(true);
                    c++;
                    switch (c) {
                        case 1:
                            clothe1.setTexture('clothe2');
                            clothe3.setTexture('clothe4');
                            clothe5.setTexture('clothe6');

                            clothe2.setTexture('clothe7');
                            clothe4.setTexture('clothe9');
                            clothe6.setTexture('clothe11');
                            break;
                        case 2:
                            clothe1.setTexture('clothe7');
                            clothe3.setTexture('clothe9');
                            clothe5.setTexture('clothe11');

                            clothe2.setTexture('clothe8');
                            clothe4.setTexture('clothe10');
                            clothe6.setTexture('clothe12');
                            break;
                        case 3:
                            clothe1.setTexture('clothe8');
                            clothe3.setTexture('clothe10');
                            clothe5.setTexture('clothe12');

                            clothe2.setTexture('clothe13');
                            clothe4.setTexture('Fboy');
                            clothe6.setVisible(false);
                            break;
                    }

                    if (c > 0)
                        wardrobe_back.setVisible(true);
                    if (c > 2) {
                        wardrobe_next.setVisible(false);
                        c = 3;
                    }

                });
            wardrobe_next.setVisible(false);
            backpack_window = this.add.image(770, 0, "backpack_window").setOrigin(0, 0);
            backpack_window.setVisible(false);
            btn_go1 = this.add.image(800, 400, "btn_go1").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {

                    if (map2_to_map1) {
                        //第一關function變數
                        Hit_W = false;

                        Move = true;
                        movetime = 0;
                        change = false;

                        Is_move1 = true;
                        Is_move2 = true;
                        i1 = 0;
                        i2 = 0;

                        collect = 0;
                        ugle_move = false;

                        map2_1 = true;

                        this.scene.start('scene_part1');
                        this.scene.stop('scene_room');

                        //關掉音樂
                        room_music.stop();

                    } else if (!map1_pass) {
                        //第一關function變數
                        blood_num = 2;
                        Hit_W = false;
                        secound_hit = 0;

                        Move = true;
                        movetime = 0;
                        change = false;

                        Is_move1 = true;
                        Is_move2 = true;
                        i1 = 0;
                        i2 = 0;

                        collect = 0;
                        ugle_move = false;

                        this.scene.start('scene_part1');
                        this.scene.stop('scene_room');

                        //關掉音樂
                        room_music.stop();
                    }

                });
            btn_go1.setVisible(false);
            btn_go2 = this.add.image(1080, 400, "btn_go2").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (map2_to_map1_task) {
                        //第一關變數

                        Hit_W = false;
                        Move = true;
                        movetime = 0;
                        change = false;

                        Is_move1 = true;
                        Is_move2 = true;
                        i1 = 0;
                        i2 = 0;

                        collect = 0;
                        ugle_move = false;

                        //第二關變數

                        S_coo = false;

                        Hit_M = false;

                        chat_num = 0;
                        H_egg = 0,
                            H_milk = 0,
                            H_flour = 0,
                            H_coin = 30;

                        enable_cle = false,
                            enable_clo = false,
                            enable_peo = false;

                        task1 = false,
                            task2 = false;
                        task3 = false;
                        Re = false;
                        pass_task1 = false;
                        change_cle = false,
                            can_buy_egg = true;

                        buy = false;
                        leave = false;

                        give_num = 0;

                    } else {
                        //第一關變數

                        Hit_W = false;
                        Move = true;
                        movetime = 0;
                        change = false;

                        Is_move1 = true;
                        Is_move2 = true;
                        i1 = 0;
                        i2 = 0;

                        collect = 0;
                        ugle_move = false;

                        //第二關變數

                        S_coo = false;

                        Hit_M = false;

                        chat_num = 0;
                        H_egg = 0,
                            H_milk = 0,
                            H_flour = 0,
                            H_coin = 30;

                        enable_cle = false,
                            enable_clo = false,
                            enable_peo = false;
                        task1 = false,
                            task2 = false;
                        task3 = false;
                        Re = false;
                        map2_to_map1_task = false;
                        pass_task1 = false;
                        change_cle = false,
                            can_buy_egg = true;

                        buy = false;
                        leave = false;

                        give_num = 0;
                    }

                    this.scene.start('scene_part2');
                    this.scene.stop('scene_room');
                    //關掉音樂
                    room_music.stop();
                });
            btn_go2.setVisible(false);
            btn_go3 = this.add.image(1360, 400, "btn_go3").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    //第一關變數

                    Hit_W = false;
                    Move = true;
                    movetime = 0;
                    change = false;

                    Is_move1 = true;
                    Is_move2 = true;
                    i1 = 0;
                    i2 = 0;

                    collect = 0;
                    ugle_move = false;

                    //第二關變數

                    S_coo = false;

                    Hit_M = false;

                    chat_num = 0;
                    H_egg = 0,
                        H_milk = 0,
                        H_flour = 0,
                        H_coin = 30;

                    enable_cle = false,
                        enable_clo = false,
                        enable_peo = false;
                    task1 = false,
                        task2 = false;
                    task3 = false;
                    Re = false;
                    pass_task1 = false;
                    change_cle = false,
                        can_buy_egg = true;

                    buy = false;
                    leave = false;

                    give_num = 0;

                    //第三關

                    s_1 = 0;
                    s_2 = 0;
                    s_3 = 0;

                    s_UD = 0,
                        S_LR = 0;


                    s_wait_shutUR = 0,
                        s_wait_shutDL = 0;

                    s_boss = 0;
                    record_s = 0;

                    this.scene.start('scene_part3');
                    this.scene.stop('scene_room');
                    //關掉音樂
                    room_music.stop();
                });
            btn_go3.setVisible(false);
            btn_go4 = this.add.image(1640, 400, "btn_go4").setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    //第一關變數

                    Hit_W = false;
                    Move = true;
                    movetime = 0;
                    change = false;

                    Is_move1 = true;
                    Is_move2 = true;
                    i1 = 0;
                    i2 = 0;

                    collect = 0;
                    ugle_move = false;

                    //第二關變數

                    S_coo = false;

                    Hit_M = false;

                    chat_num = 0;
                    H_egg = 0,
                        H_milk = 0,
                        H_flour = 0,
                        H_coin = 30;

                    enable_cle = false,
                        enable_clo = false,
                        enable_peo = false;
                    task1 = false,
                        task2 = false;
                    task3 = false;
                    Re = false;
                    pass_task1 = false;
                    change_cle = false,
                        can_buy_egg = true;

                    buy = false;
                    leave = false;

                    give_num = 0;

                    //第三關

                    s_1 = 0;
                    s_2 = 0;
                    s_3 = 0;

                    s_UD = 0,
                        S_LR = 0;


                    s_wait_shutUR = 0,
                        s_wait_shutDL = 0;

                    s_boss = 0;
                    record_s = 0;

                    //第四關

                    speed4 = 80;
                    wait4 = false;
                    s_wait4 = 0;

                    secound_light = 0;

                    collect_num = 0;
                    change_B_1 = true,
                        change_B_2 = true;
                    con = true,
                        con2 = true;
                    sec_3 = 0,
                        sec_2 = 0,
                        sec_1 = 0,
                        sec_4 = 0;

                    U_move_time = 0,
                        U_change = true;


                    this.scene.start('scene_part4');
                    this.scene.stop('scene_room');
                    //關掉音樂
                    room_music.stop();
                });
            btn_go4.setVisible(false);

            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //衣服

            clothe1 = this.add.image(110, 50, "clothe1").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe1_change').setScale(0.6);
                            Fboy_clothe = 1;
                            break;
                        case 1:
                            room_pig.setTexture('clothe2_change').setScale(0.6);
                            Fboy_clothe = 2
                            break;
                        case 2:
                            room_pig.setTexture('clothe7_change').setScale(0.6);
                            Fboy_clothe = 7;
                            break;
                        case 3:
                            room_pig.setTexture('clothe8_change').setScale(0.6);
                            Fboy_clothe = 8;
                            break;
                    }
                });
            clothe1.setVisible(false);
            clothe2 = this.add.image(510, 50, "clothe2").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe2_change').setScale(0.6);
                            Fboy_clothe = 2;
                            break;
                        case 1:
                            room_pig.setTexture('clothe7_change').setScale(0.6);
                            Fboy_clothe = 7;
                            break;
                        case 2:
                            room_pig.setTexture('clothe8_change').setScale(0.6);
                            Fboy_clothe = 8;
                            break;
                        case 3:
                            room_pig.setTexture('clothe13_change').setScale(0.6);
                            Fboy_clothe = 13;
                            break;
                    }
                });
            clothe2.setVisible(false);
            clothe3 = this.add.image(110, 390, "clothe3").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe3_change').setScale(0.6);
                            Fboy_clothe = 3;
                            break;
                        case 1:
                            room_pig.setTexture('clothe4_change').setScale(0.6);
                            Fboy_clothe = 4;
                            break;
                        case 2:
                            room_pig.setTexture('clothe9_change').setScale(0.6);
                            Fboy_clothe = 9;
                            break;
                        case 3:
                            room_pig.setTexture('clothe10_change').setScale(0.6);
                            Fboy_clothe = 10;
                            break;
                    }
                });
            clothe3.setVisible(false);
            clothe4 = this.add.image(510, 390, "clothe4").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe4_change').setScale(0.6);
                            Fboy_clothe = 4;
                            break;
                        case 1:
                            room_pig.setTexture('clothe9_change').setScale(0.6);
                            Fboy_clothe = 9;
                            break;
                        case 2:
                            room_pig.setTexture('clothe10_change').setScale(0.6);
                            Fboy_clothe = 10;
                            break;
                        case 3:
                            room_pig.setTexture('room_pig').setScale(0.6);
                            Fboy_clothe = 0;
                            break;
                    }
                });
            clothe4.setVisible(false);
            clothe5 = this.add.image(110, 740, "clothe5").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe5_change').setScale(0.6);
                            Fboy_clothe = 5;
                            break;
                        case 1:
                            room_pig.setTexture('clothe6_change').setScale(0.6);
                            Fboy_clothe = 6;
                            break;
                        case 2:
                            room_pig.setTexture('clothe11_change').setScale(0.6);
                            Fboy_clothe = 11;
                            break;
                        case 3:
                            room_pig.setTexture('clothe12_change').setScale(0.6);
                            Fboy_clothe = 12;
                            break;
                    }
                });
            clothe5.setVisible(false);
            clothe6 = this.add.image(510, 740, "clothe6").setOrigin(0, 0).setScale(0.3)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    switch (c) {
                        case 0:
                            room_pig.setTexture('clothe6_change').setScale(0.6);
                            Fboy_clothe = 6;
                            break;
                        case 1:
                            room_pig.setTexture('clothe11_change').setScale(0.6);
                            Fboy_clothe = 11;
                            break;
                        case 2:
                            room_pig.setTexture('clothe12_change').setScale(0.6);
                            Fboy_clothe = 12;
                            break;
                        case 3:
                            break;
                    }
                });
            clothe6.setVisible(false);
            /* ============================================================================================================== */

            B_egg = this.add.image(950, 930, "egg").setScale(0.4);
            B1_text = this.add.text(950, 950, "X" + egg_num, {
                fontSize: "40px",
                fill: "#000"
            });
            B_egg.setVisible(false);
            B1_text.setVisible(false);


            B_Dumb = this.add.image(1150, 930, "Dumbbell").setScale(0.6);
            B_Dumb.setVisible(false);
            B2_text = this.add.text(1150, 950, "X" + Dumb_num, {
                fontSize: "40px",
                fill: "#000"
            });
            B2_text.setVisible(false);

            B_drug = this.add.image(1350, 930, "drug").setScale(0.6);
            B_drug.setVisible(false);
            B3_text = this.add.text(1350, 950, "X" + drug_num, {
                fontSize: "40px",
                fill: "#000"
            });
            B3_text.setVisible(false);

            B_poison = this.add.image(1550, 930, "poison").setScale(0.6);
            B_poison.setVisible(false);
            B4_text = this.add.text(1550, 950, "X" + poison_num, {
                fontSize: "40px",
                fill: "#000"
            });
            B4_text.setVisible(false);

            /* ============================================================================================================== */
            //開啟/關閉音樂

            let speaker = this.add.image(config.width - 50, config.height - 50, 'speaker').setScale(0.2)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (room_music.mute) {
                        room_music.setMute(false);
                    } else {
                        room_music.setMute(true);
                    }
                });
            /* ============================================================================================================== */
        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第一關

        function scene_part1_preload() {

            /* ============================================================================================================== */
            //遊戲
            this.load.crossOrigin = 'anonymous';
            this.load.image("gameUI", "assets/map1/game1UI.jpg");
            this.load.image("home", "assets/room/home.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //血條
            this.load.image("blood", "assets/blood.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //地圖
            // this.load.image("map", "room/map1/map1.png");
            this.load.image('mazeTiles', 'assets/map/tiles_map1.png');
            this.load.tilemapCSV('map', 'assets/map/map_1.csv');
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //人物
            this.load.image("boy", "assets/role/boy.png");
            this.load.image("Fboy", "assets/role/fat_boy.png");
            this.load.image("girl", "assets/role/girl.png");
            this.load.image("ugle", "assets/role/ugle.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //map1道具
            this.load.image("love", "assets/map1/love.png");
            this.load.image("flower", "assets/map1/Brick8.png");
            /* ============================================================================================================== */

            //map2道具
            this.load.image("egg", "assets/map2/tool2_egg.png");
            this.load.image("drug", "assets/tool/tool_drug.png");
            this.load.image("poison", "assets/tool/poison.png");
            this.load.image("Dumbbell", "assets/tool/Dumbbell.png");

            /* ============================================================================================================== */
            //map1阻礙(F)
            this.load.image("brick1_map1", "assets/map1/Brick1.png");
            this.load.image("brick2_map1", "assets/map1/Brick2.png");
            this.load.image("brickLock_map1", "assets/map1/brick_lock.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //第一關文字
            this.load.plugin('rexbbcodetextplugin',
                'https://raw.githubusercontent.com/rexrainbow/phaser3-rex-notes/master/dist/rexbbcodetextplugin.min.js',
                true);
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //衣服
            this.load.image("clothe1_change", "assets/clothes/clothe1.png");
            this.load.image("clothe2_change", "assets/clothes/clothe2.png");
            this.load.image("clothe3_change", "assets/clothes/clothe3.png");
            this.load.image("clothe4_change", "assets/clothes/clothe4.png");
            this.load.image("clothe5_change", "assets/clothes/clothe5.png");
            this.load.image("clothe6_change", "assets/clothes/clothe6.png");
            this.load.image("clothe7_change", "assets/clothes/clothe7.png");
            this.load.image("clothe8_change", "assets/clothes/clothe8.png");
            this.load.image("clothe9_change", "assets/clothes/clothe9.png");
            this.load.image("clothe10_change", "assets/clothes/clothe10.png");
            this.load.image("clothe11_change", "assets/clothes/clothe11.png");
            this.load.image("clothe12_change", "assets/clothes/clothe12.png");
            this.load.image("clothe13_change", "assets/clothes/clothe13.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');
            this.load.audio('PART1_music', 'assets/backgroundmusic/PART1.mp3');

            this.load.audio('eat_heart', 'assets/effectsound/eat_heart.wav');
            this.load.audio('hit_the_wall', 'assets/effectsound/hit_the_wall.wav');
            this.load.audio('drug_music', 'assets/effectsound/drug.wav');
            this.load.audio('dumbbell_music', 'assets/effectsound/dumbbell.mp3');
            /* ============================================================================================================== */

        }

        let cursors, cam, cam1, min_cam;

        let apple, poison, Dumbbell, drug; //道具

        let blood;

        let PART1_music; //音樂音效
        let eat_heart, hit_the_wall;

        let map;
        let tileset, layer;

        let boy, Fboy, girl, ugle;
        let dis;
        let flowers, loves;
        let b1, b2, b3, b4, bs2;
        let brick1_m1s, brick2_m1s, brick3_m1s, brickLock;

        let taskText, plotText;

        //function變數
        let blood_num = 2;
        let Hit_W = false;
        let secound_hit = 0;

        let map2_1 = false;
        let flower_map2;

        function scene_part1_create() {
            /* ============================================================================================================== */
            //音樂音效

            PART1_music = this.sound.add('PART1_music', {
                volume: 1,
                loop: true
            });
            PART1_music.play();

            //音效
            eat_heart = this.sound.add('eat_heart', {
                volume: 1,
                loop: false
            });
            eat_heart.stop();

            hit_the_wall = this.sound.add('hit_the_wall', {
                volume: 1,
                loop: false
            });
            hit_the_wall.stop();

            let drug_music = this.sound.add('drug_music', {
                volume: 1,
                loop: false
            });
            drug_music.stop();

            let dumbbell_music = this.sound.add('dumbbell_music', {
                volume: 1,
                loop: false
            });
            dumbbell_music.stop();
            /* ============================================================================================================== */

            this.add.image(0, 0, "gameUI").setOrigin(0, 0);
            this.add.image(1820, 850, "home").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    //音樂
                    PART1_music.stop();

                    //轉到房間
                    this.scene.start('scene_room');
                    this.scene.stop('scene_part1');
                    wardrobe_num = 0;
                    backpack_num = 0;

                });

            //血量
            blood = this.physics.add.group({
                key: "blood",
                repeat: 2,
                setXY: {
                    x: 1550,
                    y: 100,
                    stepX: 100
                },
                setScale: {
                    x: 0.2,
                    y: 0.2,
                }
            });


            cam1 = this.cameras.add(1080, 0, config.width - 1080, 1080);
            cam1.setBounds(1080, 0, config.width - 1080, 1080);
            cam1.setViewport(1080, 0, config.width - 1080, 1080);

            dis = 45;


            map = this.make.tilemap({
                key: 'map',
                tileWidth: 90,
                tileHeight: 90,
            });


            tileset = map.addTilesetImage('mazeTiles');
            layer = map.createLayer(0, tileset, 0, 0);
            map.setCollisionBetween(0, 3, true, layer);


            if (!map2_1) {

                loves = this.physics.add.group();
                loves.createMultiple([{
                    key: "love",
                    setXY: {
                        x: 21 * dis,
                        y: 23 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 7 * dis,
                        y: 5 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 9 * dis,
                        y: 7 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 23 * dis,
                        y: 11 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 7 * dis,
                        y: 11 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 13 * dis,
                        y: 17 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 5 * dis,
                        y: 19 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 15 * dis,
                        y: 19 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }, {
                    key: "love",
                    setXY: {
                        x: 15 * dis,
                        y: 21 * dis
                    },
                    setScale: {
                        x: 0.3,
                        y: 0.3
                    }
                }]);
                brickLock = this.physics.add.sprite(1 * dis, 13 * dis, "brickLock_map1").setScale(0.25);
                brickLock.setImmovable();
                girl = this.physics.add.sprite(13 * dis, 13 * dis, "girl").setScale(0.06);
                girl.setVisible(false);
                ugle = this.physics.add.sprite(23 * dis, 15 * dis, "ugle").setScale(0.06);
                ugle.setVisible(false);
                flowers = this.physics.add.group();
                flowers.createMultiple([{
                    key: "flower",
                    setXY: {
                        x: 13 * dis,
                        y: 11 * dis
                    },
                    setScale: {
                        x: 0.25,
                        y: 0.25
                    }
                }, {
                    key: "flower",
                    setXY: {
                        x: 21 * dis,
                        y: 15 * dis
                    },
                    setScale: {
                        x: 0.25,
                        y: 0.25
                    }
                }]);

            }

            brick1_m1s = this.physics.add.group();
            brick1_m1s.createMultiple([{
                key: "brick1_map1",
                setXY: {
                    x: 9 * dis,
                    y: 7 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "brick1_map1",
                setXY: {
                    x: 3 * dis,
                    y: 19 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "brick1_map1",
                setXY: {
                    x: 17 * dis,
                    y: 21 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }]);

            brick2_m1s = this.physics.add.group();
            brick2_m1s.createMultiple([{
                key: "brick2_map1",
                setXY: {
                    x: 1 * dis,
                    y: 11 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 3 * dis,
                    y: 9 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 9 * dis,
                    y: 13 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 13 * dis,
                    y: 21 * dis
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }]);

            if (map2_1) {
                ugle_move = true;
                ugle = this.physics.add.group();
                ugle.createMultiple([{
                    key: "ugle",
                    setXY: {
                        x: 13 * dis,
                        y: 13 * dis
                    },
                    setScale: {
                        x: 0.06,
                        y: 0.06
                    }
                }, {
                    key: "ugle",
                    setXY: {
                        x: 21 * dis,
                        y: 3 * dis
                    },
                    setScale: {
                        x: 0.06,
                        y: 0.06
                    }
                }, {
                    key: "ugle",
                    setXY: {
                        x: 19 * dis,
                        y: 23 * dis
                    },
                    setScale: {
                        x: 0.06,
                        y: 0.06
                    }
                }]);
                flower_map2 = this.physics.add.group();
                flower_map2.createMultiple([{
                    key: "flower",
                    setXY: {
                        x: 13 * dis,
                        y: 9 * dis
                    },
                    setScale: {
                        x: 0.2,
                        y: 0.2
                    }
                }, {
                    key: "flower",
                    setXY: {
                        x: 23 * dis,
                        y: 7 * dis
                    },
                    setScale: {
                        x: 0.2,
                        y: 0.2
                    }
                }, {
                    key: "flower",
                    setXY: {
                        x: 13 * dis,
                        y: 19 * dis
                    },
                    setScale: {
                        x: 0.2,
                        y: 0.2
                    }
                }, {
                    key: "flower",
                    setXY: {
                        x: 14 * dis,
                        y: 1 * dis
                    },
                    setScale: {
                        x: 0.2,
                        y: 0.2
                    }
                }, {
                    key: "flower",
                    setXY: {
                        x: 19 * dis,
                        y: 11 * dis
                    },
                    setScale: {
                        x: 0.2,
                        y: 0.2
                    }
                }]);
            }

            Fboy = this.physics.add.sprite(1 * dis, 23 * dis, "Fboy").setScale(0.05);

            switch (Fboy_clothe) {
                case 0:
                    Fboy.setTexture('Fboy');
                    break;
                case 1:
                    Fboy.setTexture('clothe1_change');
                    break;
                case 2:
                    Fboy.setTexture('clothe2_change');
                    break;
                case 3:
                    Fboy.setTexture('clothe3_change');
                    break;
                case 4:
                    Fboy.setTexture('clothe4_change');
                    break;
                case 5:
                    Fboy.setTexture('clothe5_change');
                    break;
                case 6:
                    Fboy.setTexture('clothe6_change');
                    break;
                case 7:
                    Fboy.setTexture('clothe7_change');
                    break;
                case 8:
                    Fboy.setTexture('clothe8_change');
                    break;
                case 9:
                    Fboy.setTexture('clothe9_change');
                    break;
                case 10:
                    Fboy.setTexture('clothe10_change');
                    break;
                case 11:
                    Fboy.setTexture('clothe11_change');
                    break;
                case 12:
                    Fboy.setTexture('clothe12_change');
                    break;
                case 13:
                    Fboy.setTexture('clothe13_change');
                    break;

            }


            plotText = this.add.text(1550, 250, '野生小尼獸雖然\n不是肉食性動物，\n但吵到牠們絕對\n不會給你好看!', {
                fontSize: "30px",
                fill: "#000"
            });

            if (map2_1) {
                taskText = this.add.text(1400, 480, "收集紫丁香", {
                    fontSize: "32px",
                    fill: "#000"
                });
            } else {
                taskText = this.add.text(1400, 480, "收集小美的愛心~", {
                    fontSize: "32px",
                    fill: "#000"
                });
            }


            if (map2_1) {
                plotText.visible = taskText.visible = false;
            }

            cursors = this.input.keyboard.createCursorKeys();

            cam = this.cameras.main;
            cam.setBounds(0, 0, 1080, 1080);
            cam.startFollow(Fboy);
            this.cameras.main.setZoom(4);
            cam.setViewport(0, 0, 1080, 1080);

            min_cam = this.cameras.add(1110 - 180, -140, 500, 500);
            min_cam.setZoom(0.3).setViewport(1110 - 180, -140, 500, 500);

            Fboy.setCollideWorldBounds(true);

            if (map2_1) {
                for (let i = 0; i < ugle.children.entries.length; i++) {
                    ugle.children.entries[i].setCollideWorldBounds(true);

                }
            } else {
                ugle.setCollideWorldBounds(true);

            }


            this.physics.add.collider(Fboy, layer);

            if (!map2_1) {
                this.physics.add.collider(Fboy, brickLock);
                this.physics.add.collider(brick1_m1s, brick2_m1s);

                this.physics.add.overlap(Fboy, loves, collectLove, null, this);
                this.physics.add.overlap(Fboy, flowers, pass_map1, null, this);
            }

            this.physics.add.collider(Fboy, brick1_m1s, Hit_wall, null, this);
            this.physics.add.collider(Fboy, brick2_m1s, Hit_wall, null, this);

            this.physics.add.collider(ugle, brick1_m1s, Hit_U_wall);
            this.physics.add.collider(ugle, brick2_m1s, Hit_U_wall);
            this.physics.add.collider(ugle, layer, Hit_U_wall);


            this.physics.add.overlap(Fboy, flower_map2, collectFlower, null, this);
            this.physics.add.collider(Fboy, ugle, lose, null, this);

            for (i = 2; i > blood_num; i--) {
                blood.children.entries[i].setVisible(false);
            }

            /* ============================================================================================================== */
            //開啟/關閉音樂

            let speaker = this.add.image(config.width - 50, config.height - 50, 'speaker').setScale(0.2)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (PART1_music.mute) {
                        PART1_music.setMute(false);
                    } else {
                        PART1_music.setMute(true);
                    }

                });
            /* ============================================================================================================== */
            if (map2_to_map1) {
                if (egg_num > 0) {
                    B_egg = this.add.image(1450, 720, "egg").setScale(0.25);
                    B1_text = this.add.text(1490, 750, "X" + egg_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                    B1_text.visible = true;
                }
                if (Dumb_num > 0) {
                    B_drug = this.add.image(1450, 910, "Dumbbell").setScale(0.5);

                    B2_text = this.add.text(1490, 950, "X" + Dumb_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                if (drug_num > 0) {
                    B_drug = this.add.image(1630, 720, "drug").setScale(0.5);

                    B3_text = this.add.text(1670, 750, "X" + drug_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                if (poison_num > 0) {
                    B_poison = this.add.image(1630, 910, "poison").setScale(0.5);

                    B4_text = this.add.text(1670, 950, "X" + poison, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
            }
        }

        let Move = true;
        let movetime = 0;
        let change = false;

        function scene_part1_update() {
            if (Move) {
                if (cursors.left.isDown) {
                    Fboy.setVelocityX(-100);
                    Fboy.setVelocityY(0);
                } else if (cursors.right.isDown) {
                    Fboy.setVelocityX(100);
                    Fboy.setVelocityY(0);
                } else if (cursors.up.isDown) {
                    Fboy.setVelocityY(-100);
                    Fboy.setVelocityX(0);
                } else if (cursors.down.isDown) {
                    Fboy.setVelocityY(100);
                    Fboy.setVelocityX(0);
                } else {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                }
            }

            if (Fboy.x > 1080 - dis / 2) {
                Fboy.x = 1080 - dis / 2;
            }


            if (map2_1) {
                for (let i = 0; i < ugle.children.entries.length; i++) {
                    if (ugle.children.entries[i].x > 1080 - dis / 2) {
                        ugle.children.entries[i].x = 1080 - dis;
                        change = true;

                    }
                }
            } else {
                if (ugle.x > 1080 - dis / 2) {
                    ugle.x = 1080 - dis / 2;
                    change = true;
                }
            }

            brick1_m1s.setVelocityX(50);
            brick2_m1s.setVelocityY(50);
            move_brick1();

            brick1_m1s.setVelocityX(50);
            brick2_m1s.setVelocityY(50);
            move_brick2();

            if (Hit_W == true) {
                secound_hit++;
                // let x = Math.floor(Math.random() * 2);
                // let y = Math.floor(Math.random() * 2);

                // if (x) {
                //     Fboy.setVelocityX(50);
                // } else {
                //     Fboy.setVelocityX(-50);
                // }
                // if (y) {
                //     Fboy.setVelocityY(50);
                // } else {
                //     Fboy.setVelocityY(-50);
                // }


                if (secound_hit > 200) {
                    Hit_W = false;
                    secound_hit = 0;
                }
            }

            if (blood_num == -1) {
                console.log("失敗");
                this.scene.start('scene_lose');
                this.scene.stop('scene_part1');
                PART1_music.stop();
                Move = false;
            }

            if (ugle_move) {
                movetime++;
                if (movetime > 400 || change) {
                    if (map2_1) {
                        for (let i = 0; i < ugle.children.entries.length; i++) {
                            switch (Math.floor(Math.random() * 9)) {
                                case 0:
                                case 1:
                                case 6:
                                    ugle.children.entries[i].setVelocityY(80);
                                    break;
                                case 5:
                                case 7:
                                    ugle.children.entries[i].setVelocityY(-80);
                                    break;
                                case 2:
                                case 3:
                                case 8:
                                    ugle.children.entries[i].setVelocityX(80);
                                    break;
                                case 4:
                                    ugle.children.entries[i].setVelocityX(-80);
                                    break;
                            }
                        }
                    } else {
                        switch (Math.floor(Math.random() * 9)) {
                            case 0:
                            case 1:
                            case 6:
                                ugle.setVelocityY(80);
                                break;
                            case 5:
                            case 7:
                                ugle.setVelocityY(-80);
                                break;
                            case 2:
                            case 3:
                            case 8:
                                ugle.setVelocityX(80);
                                break;
                            case 4:
                                ugle.setVelocityX(-80);
                                break;
                        }
                    }
                    movetime = 0;
                    change = false;
                }
            }

            if (Dumb_use) {
                Dumb_secound++;
                Hit_W = true;
                if (Dumb_secound > 500) {
                    Dumb_use = false;
                }
            }

        }

        let Dumb_use = false,
            Dumb_secound = 0;
        let Is_move1 = true;
        let Is_move2 = true;
        let i1 = 0;
        let i2 = 0;

        function move_brick1() {
            for (let j = 0; j < 3; j++) {
                if (Is_move1) {
                    if (i1++ > 1800) {
                        Is_move1 = false;
                    }
                    brick1_m1s.children.entries[j].x -= 0.12;
                } else {
                    if (i1-- < 0) {
                        Is_move1 = true;
                    }
                    brick1_m1s.children.entries[j].x += 0.12;
                }
                brick1_m1s.children.entries[j].refreshBody();
            }
        }

        function move_brick2() {
            for (let j = 0; j < 4; j++) {
                if (Is_move2) {
                    if (i2++ > 2000) {
                        Is_move2 = false;
                    }
                    brick2_m1s.children.entries[j].y -= 0.12;
                } else {
                    if (i2-- < 0) {
                        Is_move2 = true;
                    }
                    brick2_m1s.children.entries[j].y += 0.12;
                }
                brick2_m1s.children.entries[j].refreshBody();
            }
        }

        let collect = 0;
        let ugle_move = false;

        function collectLove(boy, love) {
            eat_heart.play();
            love.disableBody(true, true);
            collect++;

            if (collect == 1) {
                plotText.setText('你知道小美嗎?\n她可是全村最受歡迎\n又漂亮的女生喔');
            } else if (collect == 2) {
                plotText.setText('她特別喜歡小尼獸');
            } else if (collect == 3) {
                plotText.setText('也常常帶著小泥獸\n玩偶趴趴走');
            } else if (collect == 4) {
                plotText.setText('她也很喜歡紫丁香');
            } else if (collect == 5) {
                plotText.setText('據說紫丁香的花語\n是初戀，想必她也很想\n談戀愛吧！');
            } else if (collect == 6) {
                plotText.setText('她常常在開有紫丁香\n的地方出現');
            } else if (collect == 7) {
                plotText.setText('不過要小心喔！\n常常盯著你的阿雯\n也常常在紫丁香的地方\n出現，小心不要被他\n發現你喔');
            } else if (collect == 8) {
                plotText.setText('小美沒事的話應該就在充滿\n紫丁香的地方觀賞著小泥獸吧～');
            } else if (collect == 9) {
                plotText.setText('去找找小美吧！');
            }

            if (collect == 4) {
                brickLock.disableBody(true, true);
            }

            if (collect == 6) {
                //                taskText.setVisible(true);
                ugle.setVisible(true);
                ugle_move = true;
            }

            if (collect == 9) {
                taskText.setText("尋找小美！");
            }
        }

        function pass_map1(boy, flower) {
            if (collect != 9) {
                //失敗畫面
                this.scene.start('scene_lose');
                this.scene.stop('scene_part1');
                PART1_music.stop();
            } else {
                if (flower == flowers.children.entries[0]) {
                    girl.visible = true;
                    setTimeout(() => {
                        //轉到劇情
                        this.scene.start('scene_part1_text');
                        map1_pass = true;
                        //可以有特效
                    }, 2000);
                } else {
                    //失敗畫面
                    this.scene.start('scene_lose');
                    this.scene.stop('scene_part1');
                    PART1_music.stop();
                }
            }
        }

        function Hit_wall(boy, wall) {
            if (Hit_W == false) {

                hit_the_wall.play();
                if (egg_num > 0) {
                    egg_num--;
                    B1_text.setText("X" + egg_num);
                    wall.disableBody(true, true);
                    if (egg_num == 0) {
                        B_egg.visible = false;
                        B1_text.visible = false;
                    }
                } else {
                    if (drug_num > 0) {
                        drug_num--;
                        B3_text.setText("X" + drug_num);
                        if (drug_num == 0) {
                            B_drug.visible = false;
                            B3_text.visible = false;
                        }
                    } else {
                        if (Dumb_num > 0) {
                            Dumb_num--;
                            B2_text.setText("X" + Dumb_num);
                            if (Dumb_num == 0) {
                                B_Dumb.visible = false;
                                B2_text.visible = false;
                            }
                            Dumb_use = true;
                        } else {
                            loseLove();
                            if (blood_num == -1) {
                                this.scene.start('scene_lose');
                                PART3_music.stop();
                            }
                        }
                    }
                }

                if (blood_num == -1) {
                    console.log("失敗");
                    this.scene.start('scene_lose');
                    this.scene.stop('scene_part1');
                    PART1_music.stop();
                    Move = false;
                }

                Hit_W = true;
            }
        }

        function Hit_U_wall(ugle, wall) {
            if (!map2_1) {
                change = true;
            }
        }

        function lose(boy, ugle) {
            Move = false;
            //轉到失敗畫面
            this.scene.start('scene_lose');
            PART1_music.stop();
        }

        let flower_num = 0;

        function collectFlower(boy, flower) {
            flower_num++;
            eat_heart.play();
            if (flower_num == 5) {
                Fboy.setVelocityY(0);
                Fboy.setVelocityX(0);
                console.log("成功");
                Move = false;
                taskText.setText("快回去找服飾店老闆吧!~");
                map2_to_map1_task = true;
                ugle_move = false;
                ugle.setVelocityY(0);
                ugle.setVelocityX(0);
            }
            flower.disableBody(true, true);
        }
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第一關劇情

        function scene_part1_text_preload() {
            /* ============================================================================================================== */
            //第一關劇情故事
            this.load.image('PART1', 'assets/plot_of_a_play/PART1_2.png');
            this.load.spritesheet('PART1_text', 'assets/plot_of_a_play/PART1_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            /* ============================================================================================================== */
        }

        let PART1_text, s = 0;

        function scene_part1_text_create() {
            this.add.image(0, 0, 'PART1').setOrigin(0, 0);
            PART1_text = this.add.sprite(0, 0, 'PART1_text').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    s++;
                    PART1_text.setFrame(s);
                    if (s == 3) {
                        s = 0;
                        this.scene.start('scene_room');
                        this.scene.stop('scene_part1');
                        wardrobe_num = 0;
                        backpack_num = 1;
                        PART1_music.stop();
                        playagain_num = 1;
                    }
                });
        }
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第二關

        //音樂音效
        let PART2_music;

        //地圖
        let map2;
        let tileset2, layer2;
        //人物
        let NPC_cle, NPC_clo, NPC_coo, NPC_peo;
        //距離位置
        let dis2;
        //道具
        let egg, flour, milk, coin;

        //文字
        let taskText2;
        let cleText, cooText, cloText, peoText;
        let cook_chat;
        let S_coo = false;
        let chat, yes, no, map2_next, map2_previous;
        let coin_text;

        //function變數
        let Hit_M = false;
        // let blood_num = 2;
        // let secound_hit = 0;

        function scene_part2_preload() {
            //
            this.load.crossOrigin = 'anonymous';
            this.load.image("home", "assets/room/home.png");

            //道具
            // this.load.image("apple", "room/apple.png");

            //血條
            this.load.image("blood", "assets/blood.png");

            //UI介面
            this.load.image("gameUI2", "assets/map2/game2UI.jpg");

            //地圖
            this.load.image('mazeTiles2', 'assets/map/tiles_map2.png');
            this.load.tilemapCSV('map2', 'assets/map/map_2.csv');

            //人物-1
            this.load.image("boy", "assets/role/boy.png");
            this.load.image("Fboy", "assets/role/fat_boy.png");
            this.load.image("girl", "assets/role/girl.png");
            this.load.image("ugle", "assets/role/ugle.png");

            //人物-2
            this.load.image("NPC_clo", "assets/map2/NPC_clothes.png");
            this.load.image("NPC_cle", "assets/map2/NPC_clerk.png");
            this.load.image("NPC_coo", "assets/map2/NPC_cook.png");
            this.load.image("NPC_peo", "assets/map2/NPC_people.png");

            //map2道具
            this.load.image("egg", "assets/map2/tool2_egg.png");
            this.load.image("flour", "assets/map2/tool2_flour.png");
            this.load.image("milk", "assets/map2/tool2_milk.png");
            this.load.image("coin", "assets/map2/coin.png");
            this.load.image("drug", "assets/tool/tool_drug.png");
            this.load.image("poison", "assets/tool/poison.png");
            this.load.image("Dumbbell", "assets/tool/Dumbbell.png");
            this.load.image("backpack", "assets/map2/tool2_backpack.png");


            //樓梯
            this.load.image("stairL", "assets/map2/stairs1.png");
            this.load.image("stairR", "assets/map2/stairs2.png");
            this.load.image("stairU", "assets/map2/stairs_up.png");
            this.load.image("stairD", "assets/map2/stairs_down.png");

            this.load.image("brick2_map1", "assets/map1/Brick2.png");
            this.load.image("lock", "assets/map1/brick_lock.png");

            //map2對話框
            this.load.image("chat", "assets/map2/chat.png");
            this.load.image("map2_next", "assets/map2/next.png");
            this.load.image("map2_previous", "assets/map2/previous.png");
            this.load.image("yes", "assets/map2/yes.png");
            this.load.image("no", "assets/map2/no.png");

            /* ============================================================================================================== */
            //衣服
            this.load.image("clothe1_change", "assets/clothes/clothe1.png");
            this.load.image("clothe2_change", "assets/clothes/clothe2.png");
            this.load.image("clothe3_change", "assets/clothes/clothe3.png");
            this.load.image("clothe4_change", "assets/clothes/clothe4.png");
            this.load.image("clothe5_change", "assets/clothes/clothe5.png");
            this.load.image("clothe6_change", "assets/clothes/clothe6.png");
            this.load.image("clothe7_change", "assets/clothes/clothe7.png");
            this.load.image("clothe8_change", "assets/clothes/clothe8.png");
            this.load.image("clothe9_change", "assets/clothes/clothe9.png");
            this.load.image("clothe10_change", "assets/clothes/clothe10.png");
            this.load.image("clothe11_change", "assets/clothes/clothe11.png");
            this.load.image("clothe12_change", "assets/clothes/clothe12.png");
            this.load.image("clothe13_change", "assets/clothes/clothe13.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');
            this.load.audio('PART2_music', 'assets/backgroundmusic/PART2.mp3');

            this.load.audio('eat_heart', 'assets/effectsound/eat_heart.wav');
            this.load.audio('hit_the_wall', 'assets/effectsound/hit_the_wall.wav');
            this.load.audio('change_place', 'assets/effectsound/change_place.wav');
            this.load.audio('give_music', 'assets/effectsound/give.mp3');
            this.load.audio('coin_music', 'assets/effectsound/coin.mp3');
            this.load.audio('drug_music', 'assets/effectsound/drug.wav');
            this.load.audio('dumbbell_music', 'assets/effectsound/dumbbell.mp3');
            /* ============================================================================================================== */
        }

        let chat_num = 0;
        let B_egg, B_milk, B_flour;
        let H_egg = 0,
            H_milk = 0,
            H_flour = 0,
            H_coin = 30;
        let B1_text, B2_text, B3_text, B4_text;
        let monster;
        let stairL, stairR, stairU, stairD;
        let lock;

        let change_place, give_music, coin_music; //音樂音效

        function scene_part2_create() {

            /* ============================================================================================================== */
            //音樂音效

            PART2_music = this.sound.add('PART2_music', {
                volume: 1,
                loop: true
            });
            PART2_music.play();

            //音效
            eat_heart = this.sound.add('eat_heart', {
                volume: 1,
                loop: false
            });
            eat_heart.stop();

            hit_the_wall = this.sound.add('hit_the_wall', {
                volume: 1,
                loop: false
            });
            hit_the_wall.stop();

            change_place = this.sound.add('change_place', {
                volume: 1,
                loop: false
            });
            change_place.stop();

            give_music = this.sound.add('give_music', {
                volume: 1,
                loop: false
            });
            give_music.stop();

            coin_music = this.sound.add('coin_music', {
                volume: 1,
                loop: false
            });
            coin_music.stop();

            let drug_music = this.sound.add('drug_music', {
                volume: 1,
                loop: false
            });
            drug_music.stop();

            let dumbbell_music = this.sound.add('dumbbell_music', {
                volume: 1,
                loop: false
            });
            dumbbell_music.stop();
            /* ============================================================================================================== */

            // ------------------------------------------------------------------------------------------------------------------------
            this.add.image(0, 0, "gameUI2").setOrigin(0, 0);
            this.add.image(1820, 850, "home").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    this.scene.start('scene_room');
                    this.scene.stop('scene_part2');
                    PART2_music.stop();
                    wardrobe_num = 0;
                    backpack_num = 1;
                });

            let speaker = this.add.image(1820, 950, "speaker").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (PART2_music.mute) {
                        PART2_music.setMute(false);
                    } else {
                        PART2_music.setMute(true);
                    }
                });

            //血量
            blood = this.physics.add.group({
                key: "blood",
                repeat: 2,
                setXY: {
                    x: 1550,
                    y: 100,
                    stepX: 100
                },
                setScale: {
                    x: 0.2,
                    y: 0.2,
                }
            });


            cam1 = this.cameras.add(1080, 0, config.width - 1080, 1080);
            cam1.setBounds(1080, 0, config.width - 1080, 1080);
            cam1.setViewport(1080, 0, config.width - 1080, 1080);

            dis2 = 36;
            // map2 = this.physics.add.sprite(0, 0, "map2").setOrigin(0, 0).setScale(1);
            map2 = this.make.tilemap({
                key: 'map2',
                tileWidth: 72,
                tileHeight: 72,
            });

            tileset2 = map2.addTilesetImage('mazeTiles2');
            layer2 = map2.createLayer(0, tileset2, 0, 0);
            map2.setCollisionBetween(0, 37, true, layer2);


            coin = this.add.image(1580, 300, "coin").setScale(0.3);

            drug = this.physics.add.group();
            drug.createMultiple([{
                key: "drug",
                repeat: 2,
                setXY: {
                    x: 11 * dis2,
                    y: 17 * dis2,
                    stepX: dis2 * 2
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }, {
                key: "drug",
                setXY: {
                    x: 15 * dis2,
                    y: 15 * dis2
                },
                setScale: {
                    x: 0.25,
                    y: 0.25
                }
            }]);

            egg = this.physics.add.group();
            egg.createMultiple([{
                key: "egg",
                setXY: {
                    x: 1 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 5 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 3 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 5 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 7 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 11 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 11 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 11 * dis2,
                    y: 7 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                setXY: {
                    x: 13 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            milk = this.physics.add.group();
            milk.createMultiple([{
                key: "milk",
                setXY: {
                    x: 1 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "milk",
                setXY: {
                    x: 1 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "milk",
                setXY: {
                    x: 7 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "milk",
                setXY: {
                    x: 7 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "milk",
                setXY: {
                    x: 9 * dis2,
                    y: 7 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "milk",
                setXY: {
                    x: 13 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            flour = this.physics.add.group();
            flour.createMultiple([{
                key: "flour",
                setXY: {
                    x: 3 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flour",
                setXY: {
                    x: 3 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flour",
                setXY: {
                    x: 5 * dis2,
                    y: 3 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flour",
                setXY: {
                    x: 7 * dis2,
                    y: 7 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flour",
                setXY: {
                    x: 9 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flour",
                setXY: {
                    x: 11 * dis2,
                    y: 5 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            // poison = this.physics.add.sprite(21 * dis2, 27 * dis2, "poison").setScale(0.3);
            Dumbbell = this.physics.add.group();
            Dumbbell.createMultiple([{
                key: "Dumbbell",
                setXY: {
                    x: 13 * dis2,
                    y: 21 * dis2
                },
                setScale: {
                    x: 0.3,
                    y: 0.3
                }
            }, {
                key: "Dumbbell",
                repeat: 4,
                setXY: {
                    x: 13 * dis2,
                    y: 23 * dis2,
                    stepX: dis2 * 2
                },
                setScale: {
                    x: 0.3,
                    y: 0.3
                }
            }]);

            backpack = this.physics.add.image(29 * dis2, 29 * dis2, "backpack").setScale(0.15);

            NPC_cle = this.physics.add.sprite(1 * dis2, 7 * dis2, "NPC_cle").setScale(0.15);
            NPC_coo = this.physics.add.sprite(1 * dis2, 21 * dis2, "NPC_coo").setScale(0.15);
            NPC_peo = this.physics.add.sprite(27 * dis2, 15 * dis2, "NPC_peo").setScale(0.15);
            NPC_clo = this.physics.add.sprite(19 * dis2, 11 * dis2, "NPC_clo").setScale(0.15);

            monster = this.physics.add.group();
            monster.createMultiple([{
                key: "brick2_map1",
                setXY: {
                    x: 27 * dis2,
                    y: 1 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 29 * dis2,
                    y: 23 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 29 * dis2,
                    y: 27 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 23 * dis2,
                    y: 29 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "brick2_map1",
                setXY: {
                    x: 25 * dis2,
                    y: 27 * dis2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);
            monster.children.entries[0].setImmovable();


            lock = this.physics.add.sprite(11 * dis2, 27 * dis2, "lock").setScale(0.2);
            lock.setImmovable();

            chat = this.add.image(2.5 * dis2, 23 * dis2, "chat").setScale(0.25);
            chat.setVisible(false);

            yes = this.add.image(2 * dis2, 9.5 * dis2, "yes").setScale(0.15);
            no = this.add.image(4 * dis2, 9.5 * dis2, "no").setScale(0.15);
            yes.setVisible(false);
            no.setVisible(false);





            yes.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                if (coin_num >= 0) {
                    if (!Re) {
                        if (egg_num > 0) {
                            B_egg = this.add.image(1450, 720, "egg").setScale(0.25);
                            B1_text.setText("X" + egg_num);
                            B1_text.visible = true;
                        }
                        if (flour_num > 0) {
                            B_flour = this.add.image(1450, 910, "flour").setScale(0.25);
                            B2_text.setText("X" + flour_num);
                            B2_text.visible = true;
                        }
                        if (milk_num > 0) {
                            B_milk = this.add.image(1630, 720, "milk").setScale(0.25);
                            B3_text.setText("X" + milk_num);
                            B3_text.visible = true;
                        }
                        yes.visible = no.visible = chat.visible = cleText.visible = false;
                        H_egg = egg_num;
                        H_flour = flour_num;
                        H_milk = milk_num;
                        Move = true;
                        H_coin = coin_num;
                        buy = false;
                        coin_music.play();

                    } else {
                        for (let i = 0; i < egg.children.entries.length; i++) {
                            egg.children.entries[i].disableBody(true, true);
                        }
                        for (let i = 0; i < milk.children.entries.length; i++) {
                            milk.children.entries[i].disableBody(true, true);
                        }
                        for (let i = 0; i < flour.children.entries.length; i++) {
                            flour.children.entries[i].disableBody(true, true);
                        }
                        for (let i = 0; i < egg.children.entries.length; i++) {
                            egg.children.entries[i].enableBody();
                            egg.children.entries[i].setVisible(true);
                        }
                        for (let i = 0; i < milk.children.entries.length; i++) {
                            milk.children.entries[i].enableBody();
                            milk.children.entries[i].setVisible(true);
                        }
                        for (let i = 0; i < flour.children.entries.length; i++) {
                            flour.children.entries[i].enableBody();
                            flour.children.entries[i].setVisible(true);
                        }
                        no.setVisible(false);
                        H_egg = H_flour = H_milk = milk_num = flour_num = egg_num = 0;
                        H_coin = coin_num = 30;
                        text_tmp = "雞蛋７顆(7/" + egg_num + ")、\n牛奶５瓶(5/" + milk_num + ")、\n麵粉４袋(4/" + flour_num +
                            ")";
                        taskText2.setText(text_tmp);
                        coin_text.setText("X " + coin_num);
                        B1_text.setText("X0");
                        B2_text.setText("X0");
                        B3_text.setText("X0");

                        Re = false;
                        chat.visible = yes.visible = cleText.visible = false;
                        blood.children.entries[blood_num].visible = false;
                        blood_num--;
                        if (blood_num == -1) {
                            console.log("失敗");
                            this.scene.start('scene_lose');
                            this.scene.stop('scene_part2');
                            PART2_music.stop();
                            Move = false;
                        }

                    }
                    if (egg_num == 7 && milk_num == 5 & flour_num == 4) {
                        pass_task1 = true;
                    }
                }
            });
            no.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                for (let i = 0; i < egg.children.entries.length; i++) {
                    egg.children.entries[i].disableBody(true, true);
                }
                for (let i = 0; i < milk.children.entries.length; i++) {
                    milk.children.entries[i].disableBody(true, true);
                }
                for (let i = 0; i < flour.children.entries.length; i++) {
                    flour.children.entries[i].disableBody(true, true);
                }
                for (let i = 0; i < egg.children.entries.length - H_egg; i++) {
                    egg.children.entries[i].enableBody();
                    egg.children.entries[i].setVisible(true);
                }
                for (let i = 0; i < milk.children.entries.length - H_milk; i++) {
                    milk.children.entries[i].enableBody();
                    milk.children.entries[i].setVisible(true);
                }
                for (let i = 0; i < flour.children.entries.length - H_flour; i++) {
                    flour.children.entries[i].enableBody();
                    flour.children.entries[i].setVisible(true);
                }
                yes.visible = no.visible = chat.visible = cleText.visible = false;
                Move = true;
                egg_num = H_egg;
                flour_num = H_flour;
                milk_num = H_milk;
                coin_num = H_coin;
                coin_text.setText("X " + coin_num);
                text_tmp = "雞蛋７顆(7/" + egg_num + ")、\n牛奶５瓶(5/" + milk_num + ")、\n麵粉４袋(4/" + flour_num + ")";
                taskText2.setText(text_tmp);
                buy = false;

            });

            map2_next = this.add.image(5.5 * dis2, 23.5 * dis2, "map2_next").setScale(0.2);
            map2_next.setVisible(false);
            map2_next.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                chat_num++;
            });
            map2_previous = this.add.image(0.5 * dis2, 23.5 * dis2, "map2_previous").setScale(0.2);
            map2_previous.setVisible(false);
            map2_previous.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                chat_num--;
            });

            stairL = this.physics.add.sprite(17 * dis2, 29 * dis2, "stairL").setScale(0.2);
            stairR = this.physics.add.sprite(13 * dis2, 29 * dis2, "stairR").setScale(0.2);
            stairU = this.physics.add.sprite(27 * dis2, 11 * dis2, "stairU").setScale(0.2);
            stairD = this.physics.add.sprite(29 * dis2, 7 * dis2, "stairD").setScale(0.2);

            Fboy = this.physics.add.sprite(1 * dis2, 29 * dis2, "Fboy").setScale(0.05);

            switch (Fboy_clothe) {
                case 0:
                    Fboy.setTexture('Fboy');
                    break;
                case 1:
                    Fboy.setTexture('clothe1_change');
                    break;
                case 2:
                    Fboy.setTexture('clothe2_change');
                    break;
                case 3:
                    Fboy.setTexture('clothe3_change');
                    break;
                case 4:
                    Fboy.setTexture('clothe4_change');
                    break;
                case 5:
                    Fboy.setTexture('clothe5_change');
                    break;
                case 6:
                    Fboy.setTexture('clothe6_change');
                    break;
                case 7:
                    Fboy.setTexture('clothe7_change');
                    break;
                case 8:
                    Fboy.setTexture('clothe8_change');
                    break;
                case 9:
                    Fboy.setTexture('clothe9_change');
                    break;
                case 10:
                    Fboy.setTexture('clothe10_change');
                    break;
                case 11:
                    Fboy.setTexture('clothe11_change');
                    break;
                case 12:
                    Fboy.setTexture('clothe12_change');
                    break;
                case 13:
                    Fboy.setTexture('clothe13_change');
                    break;

            }
            if (!map2_to_map1_task) {
                taskText2 = this.add.text(1400, 450, "今天也要來努力減肥啦！\n有空的話跟\"附近\"的人打招呼\n看看有沒有甚麼需要幫忙的吧～", {
                    fontSize: "32px",
                    fill: "#000"
                });
            } else {
                taskText2 = this.add.text(1400, 450, "尋找服飾店老闆", {
                    fontSize: "32px",
                    fill: "#000"
                });
            }




            coin_text = this.add.text(1650, 280, "X 0", {
                fontSize: "52px",
                fill: "#000"
            });

            cooText = this.add.text(0.5 * dis2, 22.5 * dis2, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            cooText.setVisible(false);
            cleText = this.add.text(0.5 * dis2, 8.5 * dis2, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            cleText.setVisible(false);
            cloText = this.add.text(18 * dis2, 12 * dis2, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            cloText.setVisible(false);
            peoText = this.add.text(25.5 * dis2, 16.5 * dis2, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            peoText.visible = false;
            cursors = this.input.keyboard.createCursorKeys();

            cam = this.cameras.main;
            cam.setBounds(0, 0, 1080, 1080);
            cam.startFollow(Fboy);
            this.cameras.main.setZoom(5);
            cam.setViewport(0, 0, 1080, 1080);

            min_cam = this.cameras.add(1110 - 180, -140, 500, 500);
            min_cam.setZoom(0.3).setViewport(1110 - 180, -140, 500, 500);

            Fboy.setCollideWorldBounds(true);

            this.physics.add.collider(Fboy, layer2);
            this.physics.add.overlap(Fboy, monster, giveEgg, null, this);

            this.physics.add.overlap(Fboy, egg, collectEgg, null, this);
            this.physics.add.overlap(Fboy, flour, collectflour, null, this);
            this.physics.add.overlap(Fboy, milk, collectmilk, null, this);
            // this.physics.add.overlap(Fboy, poison, collectpoison, null, this);
            this.physics.add.overlap(Fboy, drug, collectdrug, null, this);
            this.physics.add.overlap(Fboy, Dumbbell, collectDumb, null, this);

            this.physics.add.overlap(Fboy, stairL, moveL, null, this);
            this.physics.add.overlap(Fboy, stairR, moveR, null, this);
            this.physics.add.overlap(Fboy, stairU, moveU, null, this);
            this.physics.add.overlap(Fboy, stairD, moveD, null, this);

            this.physics.add.overlap(Fboy, backpack, pickBP, null, this);

            //-----------------------------------------------------------------------------------------------------------------------------

            for (i = 2; i > blood_num; i--) {
                blood.children.entries[i].setVisible(false);
            }

            if (map2_to_map1 == true) {
                change_cle = true;
            }
            if (map2_to_map1) {
                if (egg_num > 0) {
                    B_egg = this.add.image(1450, 720, "egg").setScale(0.25);
                    B1_text = this.add.text(1490, 750, "X" + egg_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                if (Dumb_num > 0) {
                    B_drug = this.add.image(1450, 910, "Dumbbell").setScale(0.5);

                    B2_text = this.add.text(1490, 950, "X" + Dumb_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                if (drug_num > 0) {
                    B_drug = this.add.image(1630, 720, "drug").setScale(0.5);

                    B3_text = this.add.text(1670, 750, "X" + drug_num, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                if (poison_num > 0) {
                    B_poison = this.add.image(1630, 910, "poison").setScale(0.5);

                    B4_text = this.add.text(1670, 950, "X" + poison, {
                        fontSize: "40px",
                        fill: "#000"
                    });
                }
                coin_text.setText("X" + coin_num);
            } else {
                B1_text = this.add.text(1490, 750, "X0", {
                    fontSize: "40px",
                    fill: "#000"
                });
                B2_text = this.add.text(1490, 950, "X0", {
                    fontSize: "40px",
                    fill: "#000"
                });
                B3_text = this.add.text(1670, 750, "X0", {
                    fontSize: "40px",
                    fill: "#000"
                });
                B4_text = this.add.text(1670, 950, "X0", {
                    fontSize: "40px",
                    fill: "#000"
                });
                B1_text.visible = B2_text.visible = B3_text.visible = B4_text.visible = false;

            }

        }

        let enable_cle = false,
            enable_clo = false,
            enable_peo = false;
        let coin_num = 0;
        let egg_num = 0,
            milk_num = 0,
            flour_num = 0;
        let task1 = false,
            task2 = false;
        task3 = false;
        let Re = false;
        let map2_to_map1_task = false;
        let pass_task1 = false;
        let change_cle = false,
            can_buy_egg = false;

        function scene_part2_update() {


            if (change_cle) {
                create_mul_egg();
                change_cle = false;
            }

            if (Move == true) {
                if (cursors.left.isDown) {
                    Fboy.setVelocityX(-100);
                    Fboy.setVelocityY(0);
                } else if (cursors.right.isDown) {
                    Fboy.setVelocityX(100);
                    Fboy.setVelocityY(0);
                } else if (cursors.up.isDown) {
                    Fboy.setVelocityY(-100);
                    Fboy.setVelocityX(0);
                } else if (cursors.down.isDown) {
                    Fboy.setVelocityY(100);
                    Fboy.setVelocityX(0);
                } else {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                }
            }

            if (Fboy.x > 1080 - dis2 / 2) {
                Fboy.x = 1080 - dis2 / 2;
            }


            if (buy) {
                if (Fboy.y > 9 * dis2) {
                    Fboy.y = 9 * dis2;
                }
            }


            //店員
            if (Fboy.x > dis2 * 2 && Fboy.x < dis2 * 4 && Fboy.y > dis2 * 7 && Fboy.y < dis2 * 8) {
                if (cursors.space.isDown) {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                    chat.x = 2.5 * dis2;
                    chat.y = 9 * dis2;
                    if (Re) {
                        cleText.setText("是否消耗一顆愛心重製一次");
                        yes.visible = no.visible = chat.visible = cleText.visible = true;
                        task1 = true;
                    } else {
                        if (milk_num != 0 || egg_num != 0 || flour_num != 0) {
                            cleText.setText("是否購買");
                            yes.setVisible(true);
                            no.setVisible(true);
                            chat.setVisible(true);
                            cleText.setVisible(true);
                            Move = false;
                        }
                    }
                }

            }

            //麵包店
            if (Fboy.x > dis2 * 2 && Fboy.x < dis2 * 4 && Fboy.y > dis2 * 20 && Fboy.y < dis2 * 22) {
                if (cursors.space.isDown) {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                    chat.x = 2.5 * dis2;
                    chat.y = 23 * dis2;
                    map2_next.x = 5.5 * dis2;
                    map2_next.y = 23.5 * dis2;
                    map2_previous.x = 0.5 * dis2;
                    map2_previous.y = 23.5 * dis2;
                    chat.setVisible(true);
                    Move = false;
                    cook_chat = true;
                    map2_next.setVisible(true);
                    cooText.setVisible(true);
                }

            }



            if (cook_chat) {
                if (task1) {
                    if (pass_task1) {
                        switch (chat_num) {
                            case 0:
                                map2_previous.setVisible(false);
                                cooText.setText("小明:叔叔給你\n（交出了牛奶、雞蛋、麵粉）");
                                B1_text.visible = B2_text.visible = B3_text.visible = false;
                                B_milk.visible = B_flour.visible = B_egg.visible = false;
                                egg_num = flour_num = milk_num = 0;
                                break;
                            case 1:
                                map2_previous.setVisible(true);
                                cooText.setText("老闆：謝謝啦弟弟～真是幫大忙！\n來，這是給你的小費");
                                break;
                            case 2:
                                cooText.setText("小明:哇哇！不用了啦！");
                                break;
                            case 3:
                                cooText.setText("老闆:客氣甚麼？來來來");
                                break;
                            case 4:
                                cooText.setText("（得到了金幣＊3０）");
                                coin_text.setText("X 30");
                                coin_num = 30;
                                coin_music.play();
                                break;
                            case 5:
                                cooText.setText("老闆:我發現其實我還有雞蛋耶\n哈哈哈，煮了雞蛋給你吃哈哈哈");
                                break;
                            case 6:
                                cooText.setText("（得到了雞蛋＊1）");
                                B_egg.visible = true;
                                B1_text.visible = true;
                                B1_text.setText("X1");
                                egg_num = 1;
                                coin_music.play();
                                break;
                            case 7:
                                cooText.setText("小明:（…也太ㄎㄧㄤ）謝謝老闆！");
                                break;
                            case 8:
                                cooText.setVisible(false);
                                chat.setVisible(false);
                                map2_next.setVisible(false);
                                map2_previous.setVisible(false);
                                Move = true;
                                chat_num = 0;
                                taskText2.setText("找尋服飾店老闆！");
                                cook_chat = false;
                                pass_task1 = false;
                                change_cle = true;
                                can_buy_egg = true;
                                break;
                        }
                    } else {
                        switch (chat_num) {
                            case 0:
                                map2_previous.setVisible(false);
                                cooText.setText("老闆：感覺還缺點甚麼呢！\n要不要問問看店員");
                                break;
                            case 1:
                                cooText.setVisible(false);
                                chat.setVisible(false);
                                map2_next.setVisible(false);
                                map2_previous.setVisible(false);
                                Move = true;
                                chat_num = 0;
                                Re = true;
                                task1 = false;
                                cook_chat = false;
                                break;
                        }
                    }
                } else {
                    switch (chat_num) {
                        case 0:
                            map2_previous.setVisible(false);
                            cooText.setText("老闆：阿阿阿～沒了！！！\n怎麼在這種時候沒了阿阿阿！！！");
                            break;
                        case 1:
                            map2_previous.setVisible(true);
                            cooText.setText("老闆：咳咳…。嘿帥哥～\n又來買麵包呀？");
                            break;
                        case 2:
                            cooText.setText("小明：不是啦～路過想說打個招呼～");
                            break;
                        case 3:
                            cooText.setText("老闆：弟弟真乖～");
                            break;
                        case 4:
                            cooText.setText("小明：話說叔叔怎麼慘叫呀？");
                            break;
                        case 5:
                            cooText.setText("老闆：我要試做新麵包，可是材料沒了…\n現在店裡只有我一個人值班…");
                            break;
                        case 6:
                            cooText.setText("小明：我來幫叔叔吧～要買甚麼呢～");
                            break;
                        case 7:
                            cooText.setText("老闆：真的嗎！？我需要雞蛋７顆、\n牛奶５瓶、麵粉４袋");
                            break;
                        case 8:
                            cooText.setText("（得到了金幣＊３０）");
                            coin_text.setText("X 30");
                            coin_num = 30;
                            coin_music.play();
                            break;
                        case 9:
                            cooText.setText("小明：沒問題～");
                            break;
                        case 10:
                            cooText.setText("老闆：真的很感謝！");
                            break;
                        case 11:
                            cooText.setVisible(false);
                            chat.setVisible(false);
                            map2_next.setVisible(false);
                            map2_previous.setVisible(false);
                            Move = true;
                            chat_num = 0;
                            taskText2.setText("雞蛋７顆(7/0)、\n牛奶５瓶(5/0)、\n麵粉４袋(4/0)");
                            task1 = true;
                            // enable_cle = true;
                            cook_chat = false;
                            break;
                    }
                }
            }
            //服裝店

            if (Fboy.x < 22 * dis2 && Fboy.x > 20 * dis2 && Fboy.y < 12 * dis2 && Fboy.y > 10 * dis2) {
                if (cursors.space.isDown) {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);

                    chat.x = 21 * dis2;
                    chat.y = 12.8 * dis2;
                    chat.visible = map2_next.visible = true;
                    map2_next.x = 22.5 * dis2;
                    map2_next.y = map2_previous.y = 13.5 * dis2;
                    map2_previous.x = 18.5 * dis2;
                    Move = false;
                    enable_clo = true;
                }
            }
            if (enable_clo) {
                if (map2_to_map1_task) {
                    switch (chat_num) {
                        case 0:
                            cloText.setVisible(true);
                            cloText.setText("阿強:哇哇謝謝你耶真的幫大忙！");
                            map2_previous.visible = false;
                            break;
                        case 1:
                            cloText.setText("阿強:嗨～小明，衣服隨便挑喔～");
                            map2_previous.visible = true;
                            break;
                        case 2:
                            cloText.setText("阿強:對了，你剛剛說你有想追的女生對吧，\n我把我身邊目前沒賣、\n多出來的衣服送你穿吧！");
                            break;
                        case 3:
                            cloText.setText("小明:真的假的！");
                            break;
                        case 4:
                            cloText.setText("阿強:要告白的時候穿帥一點呀～");
                            break;
                        case 5:
                            cloText.setText("小明:謝謝阿強哥哥！");
                            break;
                        case 6:
                            cloText.visible = chat.visible = map2_next.visible = map2_previous.visible = false;
                            enable_clo = false;
                            task2 = true;
                            chat_num = 0;
                            Move = true;
                            wardrobe_num = 1;
                            taskText2.setText("小泥獸棲息地似乎有人需要幫忙！\n(記得先買東西裝備自己！)");
                            break;

                    }
                } else {
                    switch (chat_num) {
                        case 0:
                            cloText.setVisible(true);
                            cloText.setText("小明:哈囉～阿強哥哥");
                            map2_previous.visible = false;
                            break;
                        case 1:
                            cloText.setText("阿強:嗨～小明，衣服隨便挑喔～");
                            map2_previous.visible = true;
                            break;
                        case 2:
                            cloText.setText("小明:我只是路過來打招呼的～\n要準備去運動中心運動");
                            break;
                        case 3:
                            cloText.setText("阿強:哇～甚麼讓你開始運動呀");
                            break;
                        case 4:
                            cloText.setText("小明:我有想追的女孩嘿嘿");
                            break;
                        case 5:
                            cloText.setText("阿強:年輕真好～都有空追女孩～\n哀～我想送東西給女朋友，\n最近店裡太忙沒甚麼空去找，哀...");
                            break;
                        case 6:
                            cloText.setText("小明:找甚麼呀？我來幫你吧！");
                            break;
                        case 7:
                            cloText.setText("阿強:真的嗎？豬豬村後山有紫丁香，\n我女友很喜歡，我想收集５朵");
                            break;
                        case 8:
                            cloText.setText("小明:交給我吧！");
                            break;
                        case 9:
                            cloText.setText("阿強:謝謝你～");
                            break;
                        case 10:
                            cloText.visible = chat.visible = map2_next.visible = map2_previous.visible = false;
                            chat_num = 0;
                            Move = true;
                            taskText2.setText("前往豬豬村後山\n蒐集紫丁香(5/0)");
                            map2_to_map1 = true;
                            cloText.visible = false;
                            enable_clo = false;
                            break;
                    }
                }
            }

            if (Fboy.x > 28 * dis2 && Fboy.x < 30 * dis2 && Fboy.y < 16 * dis2 && Fboy.y > 14 * dis2) {
                if (cursors.space.isDown) {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                    ugle_move
                    enable_peo = true;
                    chat.x = 26.2 * dis2;
                    chat.y = 17 * dis2;
                    chat.visible = map2_next.visible = true;
                    map2_next.x = 29 * dis2;
                    map2_next.y = map2_previous.y = 17.5 * dis2;
                    map2_previous.x = 25 * dis2;
                    peoText.visible = true;
                    Move = false;
                }
            }

            if (enable_peo) {
                if (task3) {
                    switch (chat_num) {
                        case 0:
                            peoText.setVisible(true);
                            peoText.setText("（交出阿文的袋子）");
                            map2_previous.visible = false;
                            break;
                        case 1:
                            peoText.setText("阿文:謝謝小明～");
                            map2_previous.visible = true;
                            break;
                        case 2:
                            peoText.setText("這是給你的謝禮～\n(毒蘋果*1)");
                            poison_num = 1;
                            break;
                        case 1:
                            peoText.setText("這是什麼鬼東西=3=\n還不如果把妹大全呢");
                            break;
                        case 4:
                            pass();
                            //進劇情
                            this.scene.start('scene_part2_text');
                            chat_num = 0;
                            break;
                    }
                } else {
                    switch (chat_num) {
                        case 0:
                            peoText.setVisible(true);
                            peoText.setText("鄰居阿文:我的袋子…");
                            map2_previous.visible = false;
                            break;
                        case 1:
                            peoText.setText("小明:阿文，你怎麼一個人在這種地方");
                            map2_previous.visible = true;
                            break;
                        case 2:
                            peoText.setText("小明:阿文，你怎麼一個人在這種地方");
                            break;
                        case 3:
                            peoText.setText("阿文:是小明呀…我的袋子被小泥獸搶走了…");
                            break;
                        case 4:
                            peoText.setText("阿文:對!!!我剛剛去超市完\n想說順便來公園散散步，結果就…");
                            break;
                        case 5:
                            peoText.setText("小明:我幫你拿回袋子吧！");
                            break;
                        case 6:
                            peoText.setText("阿文:謝謝小明～");
                            break;
                        case 7:
                            peoText.visible = chat.visible = map2_next.visible = map2_previous.visible = false;
                            Move = true;
                            chat_num = 0;
                            enable_peo = false;
                            break;
                    }
                }
            }


            if (Hit_M == true) {
                secound_hit++;
                if (secound_hit > 200) {
                    Hit_M = false;
                    secound_hit = 0;
                }
            }

            if (task3) {
                lock.visible = false;
                eat_heart.play();
            }

            if (Dumb_use2) {
                Dumb_secound2++;
                Hit_M = true;
                if (Dumb_secound2 > 500) {
                    Dumb_use2 = false;
                }
            }

        }

        let Dumb_secound2 = 0;

        let text_tmp;
        let buy = false;
        let leave = false;
        let drug_num = 0,
            Dumb_num = 0,
            poison_num = 0;
        let B_drug, B_Dumb, B_poison;

        function pass() {
            console.log("過關");
        }

        function collectEgg(boy, egg) {
            if (cursors.space.isDown && (task1 || change_cle) && coin_num >= 1) {
                egg.disableBody(false, true);
                coin_num--;

                coin_text.setText("X " + coin_num);
                egg_num++;

                eat_heart.play();

                if (!can_buy_egg) {
                    text_tmp = "雞蛋７顆(7/" + egg_num + ")、\n牛奶５瓶(5/" + milk_num + ")、\n麵粉４袋(4/" + flour_num + ")";
                    taskText2.setText(text_tmp);
                }
                buy = true;
            }
        }

        function collectflour(boy, flour) {
            if (cursors.space.isDown && task1 && coin_num >= 2) {
                flour.disableBody(false, true);
                coin_num -= 2;

                coin_text.setText("X " + coin_num);
                flour_num++;

                eat_heart.play();

                text_tmp = "雞蛋７顆(7/" + egg_num + ")、\n牛奶５瓶(5/" + milk_num + ")、\n麵粉４袋(4/" + flour_num + ")";
                taskText2.setText(text_tmp);
                buy = true;
            }
        }

        function collectmilk(boy, milk) {
            if (cursors.space.isDown && task1 && coin_num >= 3) {
                milk.disableBody(false, true);
                coin_num -= 3;

                coin_text.setText("X " + coin_num);
                milk_num++;

                eat_heart.play();

                text_tmp = "雞蛋７顆(7/" + egg_num + ")、\n牛奶５瓶(5/" + milk_num + ")、\n麵粉４袋(4/" + flour_num + ")";
                taskText2.setText(text_tmp);
                buy = true;
            }
        }

        function create_mul_egg() {
            egg.clear(true);
            milk.clear(true);
            flour.clear(true);

            egg.createMultiple([{
                key: "egg",
                repeat: 5,
                setXY: {
                    x: 1 * dis2,
                    y: 1 * dis2,
                    stepX: dis2 * 2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                repeat: 3,
                setXY: {
                    x: 1 * dis2,
                    y: 3 * dis2,
                    stepX: dis2 * 2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                repeat: 3,
                setXY: {
                    x: 1 * dis2,
                    y: 5 * dis2,
                    stepX: dis2 * 2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                repeat: 1,
                setXY: {
                    x: 11 * dis2,
                    y: 3 * dis2,
                    stepX: dis2 * 2,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                repeat: 1,
                setXY: {
                    x: 11 * dis2,
                    y: 5 * dis2,
                    stepX: dis2 * 2,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "egg",
                repeat: 2,
                setXY: {
                    x: 7 * dis2,
                    y: 7 * dis2,
                    stepX: dis2 * 2,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);
        }


        let give_num = 0;
        let Dumb_use2 = false;

        function giveEgg(boy, monster) {
            if (map2_to_map1) {
                if (Hit_M == false) {
                    give_num++;
                    if (give_num == 1) {
                        chat.x = 26 * dis2;
                        chat.y = 3 * dis2;
                        chat.visible = true;

                        give_music.stop();

                        let prompt = this.add.text(24 * dis2, 2.5 * dis2, "小尼獸最喜歡吃雞蛋，\n它偷偷拿走你的雞蛋逃走了!", {
                            fontSize: "15px",
                            fill: "#000"
                        });
                        setTimeout(() => {
                            chat.visible = prompt.visible = false;
                        }, 2000);
                    }
                    egg_num--;

                    if (egg_num < 0) {
                        egg_num = 0;
                        if (drug_num > 0) {
                            drug_num--;
                            B3_text.setText("X" + drug_num);
                            if (drug_num == 0) {
                                B_drug.visible = false;
                                B3_text.visible = false;
                            }
                        } else {
                            if (Dumb_num > 0) {
                                Dumb_num--;
                                B2_text.setText("X" + Dumb_num);
                                Dumb_use = true;
                                if (Dumb_num == 0) {
                                    B_Dumb.visible = false;
                                    B2_text.visible = false;
                                }
                            } else {
                                loseLove();
                                if (blood_num == -1) {
                                    this.scene.start('scene_lose');
                                    PART3_music.stop();
                                }
                            }
                        }

                        if (blood_num == -1) {
                            console.log("失敗");
                            this.scene.start('scene_lose');
                            this.scene.stop('scene_part2');
                            PART2_music.stop();
                            Move = false;
                        }

                    } else if (egg_num == 0) {
                        B_egg.visible = false;
                        B1_text.visible = false;
                        monster.disableBody(true, true);
                    } else {
                        B1_text.setText("X" + egg_num);
                        monster.disableBody(true, true);
                    }
                    Hit_M = true;
                }

                hit_the_wall.play();
            } else {
                if (Fboy.x > 26 * dis2 && Fboy.y < 2 * dis) {
                    Fboy.x = 26 * dis;
                }
            }
        }

        function collectdrug(boy, drug) {
            if (cursors.space.isDown) {
                if (coin_num >= 2) {
                    drug.disableBody(true, true);
                    coin_num -= 2;

                    coin_music.play();

                    coin_text.setText("X " + coin_num);
                    drug_num++;
                    B3_text.setText("X" + drug_num);
                    eat_heart.play();
                }
                if (drug_num == 1) {
                    if (blood_num == 2) {
                        B_drug = this.add.image(1630, 720, "drug").setScale(0.5);
                        B3_text.setText("X" + drug_num);
                        B3_text.setVisible(true);

                    } else {
                        blood.children.entries[blood_num].visible = true;
                        blood_num++;
                    }
                }
            }
        }

        function collectDumb(boy, Dumb) {
            if (cursors.space.isDown) {
                if (coin_num >= 3) {
                    Dumb.disableBody(true, true);
                    coin_num -= 3;
                    coin_music.play();
                    coin_text.setText("X " + coin_num);
                    Dumb_num++;
                    B2_text.setText("X" + Dumb_num);
                    eat_heart.play();
                }
                if (Dumb_num == 1) {
                    B_drug = this.add.image(1450, 910, "Dumbbell").setScale(0.5);
                    B2_text.setText("X" + Dumb_num);
                    B2_text.setVisible(true);
                }
            }
        }

        // function collectpoison(boy, poison) {
        //     if (cursors.space.isDown) {
        //         poison.disableBody(true, true);
        //         B_poison = this.add.image(1630, 910, "poison").setScale(0.5);
        //         poison_num++;

        //         eat_heart.play();

        //         B4_text.setText("X" + poison_num);
        //         B4_text.setVisible(true);
        //     }
        // }

        function moveL(boy, L) {
            if (cursors.space.isDown) {
                Move = false;
                setTimeout(() => {
                    boy.x = 13 * dis2;
                    boy.y = 29 * dis2;
                    Move = true;
                }, 1000);

                change_place.play();
            }
        }

        function moveR(boy, R) {
            if (cursors.space.isDown) {
                Move = false;
                setTimeout(() => {
                    boy.x = 17 * dis2;
                    boy.y = 29 * dis2;
                    Move = true;
                }, 1000);

                change_place.play();
            }
        }

        function moveU(boy, U) {
            if (cursors.space.isDown) {
                Move = false;
                setTimeout(() => {
                    boy.x = 29 * dis2;
                    boy.y = 7 * dis2;
                    Move = true;
                }, 1000);

                change_place.play();
            }
        }

        function moveD(boy, D) {
            if (cursors.space.isDown) {
                Move = false;
                setTimeout(() => {
                    boy.x = 27 * dis2;
                    boy.y = 11 * dis2;
                    Move = true;
                }, 1000);

                change_place.play();
            }
        }

        function pickBP(boy, BP) {
            BP.visible = false;
            task3 = true;
        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第二關劇情

        function scene_part2_text_preload() {
            /* ============================================================================================================== */
            //第二關劇情故事
            this.load.image('PART2', 'assets/plot_of_a_play/PART2.jpg');
            this.load.spritesheet('PART2_text', 'assets/plot_of_a_play/PART2_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            /* ============================================================================================================== */
        }

        let PART2, PART2_text;

        function scene_part2_text_create() {
            PART2 = this.add.image(0, 0, 'PART2').setOrigin(0, 0);
            PART2_text = this.add.sprite(0, 0, 'PART2_text').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    s++;
                    PART2_text.setFrame(s);
                    if (s == 3) {
                        s = 0;
                        this.scene.start('scene_room');
                        this.scene.stop('scene_part2');
                        wardrobe_num = 1;
                        backpack_num = 2;
                        PART2_music.stop();
                        playagain_num = 2;
                    }
                });
        }
        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第三關

        let dis3;
        let dialogue;
        let Awan;

        let taskText_map3;

        let wolve_H_2, wolve_S_1;
        let wolve_H_3;
        let monster_S, monster_H;
        let boss;
        let trapR, trapL, trapU, trapD, trapD_D, trapD_L, trapD_R;
        let trap_move1, trap_move2, trap_move3;
        let incline_H_4, incline_S_2, incline_S_4;
        let swamp, big_swamp;
        let AwanText;
        let pos;

        function scene_part3_preload() {
            this.load.crossOrigin = 'anonymous';
            this.load.image("gameUI3", "assets/map3/game3UI.jpg");
            this.load.image("home", "assets/room/home.png");

            //血條
            this.load.image("blood", "assets/blood.png");

            //地圖
            this.load.image('mazeTiles3', 'assets/map/tiles_map3.png');
            this.load.tilemapCSV('map3', 'assets/map/map_3.csv');

            //人物
            this.load.image("wolve", "assets/role/wolve.png");
            this.load.image("monster", "assets/map1/Brick2.png");
            this.load.image("Fboy", "assets/role/fat_boy.png");
            this.load.image("boss", "assets/map3/boss_wolf.png");
            this.load.image("Awan", "assets/map2/NPC_people.png");

            //陷阱
            this.load.image("trapU", "assets/map3/trap3_1.png");
            this.load.image("trapD", "assets/map3/trap3_2.png");
            this.load.image("trapL", "assets/map3/trap3_3.png");
            this.load.image("trapR", "assets/map3/trap3_4.png");

            this.load.image("trapD_U", "assets/map3/trap4_3.png");
            this.load.image("trapD_D", "assets/map3/trap4_1.png");
            this.load.image("trapD_L", "assets/map3/trap4_4.png");
            this.load.image("trapD_R", "assets/map3/trap4_2.png");

            this.load.image("trap_move1", "assets/map3/trap.png");
            this.load.image("trap_move2", "assets/map3/trap2.png");

            //坡度
            this.load.image("incline_S_2", "assets/map3/incline1.png");
            this.load.image("incline_S_4", "assets/map3/incline2.png");
            this.load.image("incline_H_4", "assets/map3/incline3.png");

            //沼澤
            this.load.image("swamp", "assets/map3/swamp.png");
            this.load.image("big_swamp", "assets/map3/swamp_big.png");

            //對話框
            this.load.image("chat", "assets/map2/chat.png");
            this.load.image("next", "assets/map2/next.png");
            this.load.image("previous", "assets/map2/previous.png");

            //道具
            this.load.image("egg", "assets/map2/tool2_egg.png");
            this.load.image("drug", "assets/tool/tool_drug.png");
            this.load.image("poison", "assets/tool/poison.png");
            this.load.image("Dumbbell", "assets/tool/Dumbbell.png");

            /* ============================================================================================================== */
            //衣服
            this.load.image("clothe1_change", "assets/clothes/clothe1.png");
            this.load.image("clothe2_change", "assets/clothes/clothe2.png");
            this.load.image("clothe3_change", "assets/clothes/clothe3.png");
            this.load.image("clothe4_change", "assets/clothes/clothe4.png");
            this.load.image("clothe5_change", "assets/clothes/clothe5.png");
            this.load.image("clothe6_change", "assets/clothes/clothe6.png");
            this.load.image("clothe7_change", "assets/clothes/clothe7.png");
            this.load.image("clothe8_change", "assets/clothes/clothe8.png");
            this.load.image("clothe9_change", "assets/clothes/clothe9.png");
            this.load.image("clothe10_change", "assets/clothes/clothe10.png");
            this.load.image("clothe11_change", "assets/clothes/clothe11.png");
            this.load.image("clothe12_change", "assets/clothes/clothe12.png");
            this.load.image("clothe13_change", "assets/clothes/clothe13.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');
            this.load.audio('PART3_music', 'assets/backgroundmusic/PART3.mp3');

            this.load.audio('shoot_music', 'assets/effectsound/shoot.mp3');
            this.load.audio('wind_music', 'assets/effectsound/wind.mp3');
            this.load.audio('drug_music', 'assets/effectsound/drug.wav');
            this.load.audio('dumbbell_music', 'assets/effectsound/dumbbell.mp3');
            /* ============================================================================================================== */
        }

        //音效
        let PART3_music;
        let shoot_music, wind_music;

        function scene_part3_create() {

            /* ============================================================================================================== */
            //音樂音效

            PART3_music = this.sound.add('PART3_music', {
                volume: 1,
                loop: true
            });
            PART3_music.play();

            //音效
            shoot_music = this.sound.add('shoot_music', {
                volume: 1,
                loop: false
            });
            shoot_music.stop();

            wind_music = this.sound.add('wind_music', {
                volume: 1,
                loop: false
            });
            wind_music.stop();

            let drug_music = this.sound.add('drug_music', {
                volume: 1,
                loop: false
            });
            drug_music.stop();

            let dumbbell_music = this.sound.add('dumbbell_music', {
                volume: 1,
                loop: false
            });
            dumbbell_music.stop();
            /* ============================================================================================================== */
            // ------------------------------------------------------------------------------------------------------------------------
            this.add.image(0, 0, "gameUI3").setOrigin(0, 0);
            this.add.image(1820, 850, "home").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    this.scene.start('scene_room');
                    this.scene.stop('scene_part3');
                    PART3_music.stop();
                    wardrobe_num = 0;
                    backpack_num = 2;
                });

            let speaker = this.add.image(1820, 950, "speaker").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (PART3_music.mute) {
                        PART3_music.setMute(false);
                    } else {
                        PART3_music.setMute(true);
                    }
                });

            //血量
            blood = this.physics.add.group({
                key: "blood",
                repeat: 2,
                setXY: {
                    x: 1550,
                    y: 100,
                    stepX: 100
                },
                setScale: {
                    x: 0.2,
                    y: 0.2,
                }
            });


            //道具欄位至
            // apple = this.add.image(1400, 650, 'apple').setOrigin(0, 0).setScale(0.75);
            // poison = this.add.image(1400, 840, 'poison').setOrigin(0, 0).setScale(0.75);
            // Dumbbell = this.add.image(1580, 650, 'Dumbbell').setOrigin(0, 0).setScale(0.75);
            // drug = this.add.image(1580, 840, 'drug').setOrigin(0, 0).setScale(0.75);

            cam1 = this.cameras.add(1080, 0, config.width - 1080, 1080);
            cam1.setBounds(1080, 0, config.width - 1080, 1080);
            cam1.setViewport(1080, 0, config.width - 1080, 1080);

            dis3 = 30;

            incline_H_4 = this.physics.add.sprite(16 * dis3, 9 * dis3, "incline_H_4").setScale(0.5);
            incline_S_4 = this.physics.add.sprite(35 * dis3, 30 * dis3, "incline_S_4").setScale(0.5);
            incline_S_2 = this.physics.add.group();
            incline_S_2.createMultiple([{
                key: "incline_S_2",
                setXY: {
                    x: 5 * dis3,
                    y: 7 * dis3,
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }, {
                key: "incline_S_2",
                setXY: {
                    x: 17 * dis3,
                    y: 33 * dis3,
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }]);

            swamp = this.physics.add.sprite(26 * dis3, 34 * dis3, "swamp").setScale(0.5);
            big_swamp = this.physics.add.sprite(5 * dis3, 16 * dis3, "big_swamp").setScale(0.5);

            trap_move1 = this.physics.add.group();
            trap_move1.createMultiple([{
                key: "trap_move2",
                setXY: {
                    x: 15 * dis3,
                    y: 35 * dis3,
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }, {
                key: "trap_move2",
                setXY: {
                    x: 29 * dis3,
                    y: 31 * dis3,
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }]);

            trap_move2 = this.physics.add.group();
            trap_move2.createMultiple([{
                key: "trap_move1",
                setXY: {
                    x: 31 * dis3,
                    y: 3 * dis3,
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }, {
                key: "trap_move1",
                repeat: 1,
                setXY: {
                    x: 31 * dis3,
                    y: 5 * dis3,
                    stepX: dis3 * 2
                },
                setScale: {
                    x: 0.5,
                    y: 0.5
                }
            }]);

            trap_move3 = this.physics.add.sprite(15 * dis3, 15 * dis3, "trap_move2").setScale(0.5);

            trapU = this.physics.add.sprite(11 * dis3, 11.5 * dis3, "trapU").setScale(0.25);
            trapU1 = this.physics.add.sprite(27 * dis3, 27.5 * dis3, "trapU").setScale(0.25);

            trapD = this.physics.add.sprite(23 * dis3, 24.5 * dis3, "trapD").setScale(0.25);
            trapL = this.physics.add.sprite(13.5 * dis3, 21 * dis3, "trapL").setScale(0.25);
            trapR = this.physics.add.sprite(8.5 * dis3, 25 * dis3, "trapR").setScale(0.25);

            trapD_D = this.physics.add.group();
            trapD_D.createMultiple([{
                key: "trapD_D",
                repeat: 2,
                setXY: {
                    x: 9 * dis3,
                    y: 5 * dis3,
                    stepX: dis3 * 4
                },
                setScale: {
                    x: 0.4,
                    y: 0.4
                }
            }]);

            trapD_R = this.physics.add.group();
            trapD_R.createMultiple([{
                key: "trapD_R",
                repeat: 1,
                setXY: {
                    x: 23 * dis3,
                    y: 5 * dis3,
                    stepX: dis3 * 4,
                    stepY: dis3 * -4
                },
                setScale: {
                    x: 0.4,
                    y: 0.4,

                }
            }]);

            trapD_L = this.physics.add.group();
            trapD_L.createMultiple([{
                key: "trapD_L",
                repeat: 1,
                setXY: {
                    x: 23 * dis3,
                    y: 1 * dis3,
                    stepX: dis3 * 4,
                    stepY: dis3 * 4
                },
                setScale: {
                    x: 0.4,
                    y: 0.4,

                }
            }]);

            monster_S = this.physics.add.group();
            monster_S.createMultiple([{
                key: "monster",
                setXY: {
                    x: 9 * dis3,
                    y: 17 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 3 * dis3,
                    y: 19 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 23 * dis3,
                    y: 31 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 27 * dis3,
                    y: 32 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 31 * dis3,
                    y: 33 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            monster_H = this.physics.add.group();
            monster_H.createMultiple([{
                key: "monster",
                setXY: {
                    x: 0.5 * dis3,
                    y: 11 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 0.5 * dis3,
                    y: 15 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "monster",
                setXY: {
                    x: 6.5 * dis3,
                    y: 11 * dis3,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            wolve_S_1 = this.physics.add.group();
            wolve_S_1.createMultiple([{
                key: "wolve",
                setXY: {
                    x: 17 * dis3,
                    y: 13 * dis3,
                },
                setScale: {
                    x: 0.05,
                    y: 0.05
                }
            }, {
                key: "wolve",
                setXY: {
                    x: 21 * dis3,
                    y: 13 * dis3,
                },
                setScale: {
                    x: 0.05,
                    y: 0.05
                }
            }, {
                key: "wolve",
                setXY: {
                    x: 7 * dis3,
                    y: 19 * dis3,
                },
                setScale: {
                    x: 0.06,
                    y: 0.06
                }
            }])

            wolve_H_2 = this.physics.add.sprite(2 * dis3, 5 * dis3, "wolve").setScale(0.06);

            wolve_H_3 = this.physics.add.group();
            wolve_H_3.createMultiple([{
                key: "wolve",
                setXY: {
                    x: 14.5 * dis3,
                    y: 35 * dis3,
                },
                setScale: {
                    x: 0.06,
                    y: 0.06
                }
            }, {
                key: "wolve",
                setXY: {
                    x: 5 * dis3,
                    y: 29 * dis3,
                },
                setScale: {
                    x: 0.06,
                    y: 0.06
                }
            }, {
                key: "wolve",
                setXY: {
                    x: 15 * dis3,
                    y: 1 * dis3,
                },
                setScale: {
                    x: 0.06,
                    y: 0.06
                }
            }, {
                key: "wolve",
                setXY: {
                    x: 23 * dis3,
                    y: 13 * dis3,
                },
                setScale: {
                    x: 0.06,
                    y: 0.06
                }
            }]);

            Awan = this.physics.add.sprite(3 * dis3, 25 * dis3, "Awan").setScale(0.11);
            boss = this.physics.add.sprite(34 * dis3, 2 * dis3, "boss").setScale(0.12);

            map = this.make.tilemap({
                key: 'map3',
                tileWidth: 60,
                tileHeight: 60,
            });

            tileset = map.addTilesetImage('mazeTiles3');
            layer = map.createLayer(0, tileset, 0, 0);
            map.setCollisionBetween(0, 3, true, layer);
            Fboy = this.physics.add.sprite(1 * dis3, 35 * dis3, "Fboy").setScale(0.04);


            chat = this.add.image(2.5 * dis3, 33 * dis3, "chat").setScale(0.2);
            next = this.add.image(5 * dis3, 33.5 * dis3, "next").setScale(0.15);
            previous = this.add.image(1 * dis3, 33.5 * dis3, "previous").setScale(0.15);
            next.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                chat_num++;
            });
            previous.setInteractive({
                useHandCursor: true
            }).on("pointerdown", () => {
                chat_num--;
            });
            previous.visible = false;

            dialogue = this.add.text(0.5 * dis3, 32.3 * dis3, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            AwanText = this.add.text(0.5 * dis3, 28.3 * dis3, "...", {
                fontSize: "10px",
                fill: "#000"
            });
            AwanText.visible = false;

            taskText = this.add.text(1400, 450, "", {
                fontSize: "32px",
                fill: "#000"
            });


            B1_text = this.add.text(1490, 750, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B2_text = this.add.text(1490, 950, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B3_text = this.add.text(1670, 750, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B4_text = this.add.text(1670, 950, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B1_text.visible = B2_text.visible = B3_text.visible = B4_text.visible = false;

            if (egg_num > 0) {
                B_egg = this.add.image(1450, 720, "egg").setScale(0.25);
                B1_text.setText("X" + egg_num);
                B1_text.visible = true;
            }
            if (Dumb_num > 0) {
                B_Dumb = this.add.image(1450, 910, "Dumbbell").setScale(0.25);
                B2_text.setText("X" + Dumb_num);
                B2_text.visible = true;
            }
            if (drug_num > 0) {
                B_drug = this.add.image(1630, 720, "drug").setScale(0.25);
                B3_text.setText("X" + drug_num);
                B3_text.visible = true;
            }
            if (poison_num > 0) {
                B_poison = this.add.image(1630, 910, "poison").setScale(0.25);
                B4_text.setText("X" + poison_num);
                B4_text.visible = true;
            }

            pos = this.physics.add.sprite(10, 10, "poison").setScale(0.2);
            pos.visible = false;

            cursors = this.input.keyboard.createCursorKeys();

            cam = this.cameras.main;
            cam.setBounds(0, 0, 1080, 1080);
            cam.startFollow(Fboy);
            this.cameras.main.setZoom(6);
            cam.setViewport(0, 0, 1080, 1080);

            min_cam = this.cameras.add(1110 - 180, -140, 500, 500);
            min_cam.setZoom(0.3).setViewport(1110 - 180, -140, 500, 500);

            Fboy.setCollideWorldBounds(true);

            switch (Fboy_clothe) {
                case 0:
                    Fboy.setTexture('Fboy');
                    break;
                case 1:
                    Fboy.setTexture('clothe1_change');
                    break;
                case 2:
                    Fboy.setTexture('clothe2_change');
                    break;
                case 3:
                    Fboy.setTexture('clothe3_change');
                    break;
                case 4:
                    Fboy.setTexture('clothe4_change');
                    break;
                case 5:
                    Fboy.setTexture('clothe5_change');
                    break;
                case 6:
                    Fboy.setTexture('clothe6_change');
                    break;
                case 7:
                    Fboy.setTexture('clothe7_change');
                    break;
                case 8:
                    Fboy.setTexture('clothe8_change');
                    break;
                case 9:
                    Fboy.setTexture('clothe9_change');
                    break;
                case 10:
                    Fboy.setTexture('clothe10_change');
                    break;
                case 11:
                    Fboy.setTexture('clothe11_change');
                    break;
                case 12:
                    Fboy.setTexture('clothe12_change');
                    break;
                case 13:
                    Fboy.setTexture('clothe13_change');
                    break;

            }


            this.physics.add.collider(Fboy, layer);
            this.physics.add.collider(Fboy, wolve_H_3, lose_love_W, null, this);
            this.physics.add.collider(Fboy, wolve_H_2, lose_love_W, null, this);
            this.physics.add.collider(Fboy, wolve_S_1, lose_love_W, null, this);
            this.physics.add.collider(Fboy, monster_S, lose_love_M, null, this);
            this.physics.add.collider(Fboy, monster_H, lose_love_M, null, this);

            this.physics.add.collider(Fboy, trapD_D, lose_love_tD, null, this);
            this.physics.add.collider(Fboy, trapD_R, lose_love_tD, null, this);
            this.physics.add.collider(Fboy, trapD_L, lose_love_tD, null, this);

            this.physics.add.collider(Fboy, trapD, lose_love_t, null, this);
            this.physics.add.collider(Fboy, trapU, lose_love_t, null, this);
            this.physics.add.collider(Fboy, trapU1, lose_love_t, null, this);
            this.physics.add.collider(Fboy, trapR, lose_love_t, null, this);
            this.physics.add.collider(Fboy, trapL, lose_love_t, null, this);

            this.physics.add.overlap(Fboy, incline_H_4, influence_speed_H_4, null, this);
            this.physics.add.overlap(Fboy, incline_S_2, influence_speed_S_2, null, this);
            this.physics.add.overlap(Fboy, incline_S_4, influence_speed_S_4, null, this);

            this.physics.add.overlap(Fboy, swamp, influence_speed_S, null, this);
            this.physics.add.overlap(Fboy, big_swamp, influence_speed_S, null, this);

            this.physics.add.overlap(Fboy, trap_move1, trap_move_1, null, this);
            this.physics.add.overlap(Fboy, trap_move2, trap_move_2, null, this);
            this.physics.add.overlap(Fboy, trap_move3, trap_move_3, null, this);


            this.physics.add.overlap(Fboy, boss, lose_map3, null, this);
            this.physics.add.overlap(boss, pos, win, null, this);
            //-----------------------------------------------------------------------------------------------------------------------------

        }

        let wait = false;
        let speed = 80;
        let s_wait = 0;
        let s_Re_speed = 0;
        let recap_1 = true,
            enable_Awan = false;

        function scene_part3_update() {
            if (Move) {
                if (cursors.left.isDown) {
                    Fboy.setVelocityX(speed * -1);
                    Fboy.setVelocityY(0);
                } else if (cursors.right.isDown) {
                    Fboy.setVelocityX(speed);
                    Fboy.setVelocityY(0);
                } else if (cursors.up.isDown) {
                    Fboy.setVelocityY(speed * -1);
                    Fboy.setVelocityX(0);
                } else if (cursors.down.isDown) {
                    Fboy.setVelocityY(speed);
                    Fboy.setVelocityX(0);
                } else {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                }
            }

            if (Fboy.x > 1080 - dis3 / 2) {
                Fboy.x = 1080 - 3 / 2;
            }

            if (wait == true) {
                s_wait++;

                if (s_wait > 1000) {
                    wait = false;
                    s_wait = 0;
                }
            }

            if (speed != 80) {
                s_Re_speed++;
                if (s_Re_speed > 100) {
                    speed = 80;
                    s_Re_speed = 0;
                }
            }

            if (Fboy.x > 10 * dis3 && Fboy.x < 32 * dis3 && Fboy.y < 28 * dis3 && Fboy.y > 16 * dis3) {
                //東西射出來的聲音
                shoot_music.play();
            }

            wind_change_speed();

            secound_move();
            move_WS1();
            move_WH2();
            move_WH3();
            move_MS1();
            move_MH1();

            secound_appear();
            appear_trapUD();
            appear_trapLR();

            secound_shit();
            shut_DL();
            shut_UR();

            appear_boss();

            Recap();
            if (Fboy.x > 2 * dis3 && Fboy.x < 4 * dis3 && Fboy.y < 28 * dis3 && Fboy.y > 26 * dis3) {
                if (cursors.space.isDown) {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                    enable_Awan = true;
                    chat.x = 2.5 * dis3;
                    chat.y = 28.8 * dis3;
                    next.x = 5 * dis3;
                    next.y = previous.y = 29 * dis3;
                    previous.x = 1 * dis3;
                    chat.visible = next.visible = true;
                    AwanText.visible = true;
                    Move = false;

                }
            }
            chat_Awan();

            set_poison();



            if (Dumb_use3) {
                Dumb_secound3++;
                wait = true;
                if (Dumb_secound3 > 500) {
                    Dumb_use3 = false;
                }
            }

        }

        let Dumb_use3 = false,
            Dumb_secound3 = 0;

        let change_s_1;
        let s_1 = 0;
        let change_s_2;
        let s_2 = 0;
        let change_s_3;
        let s_3 = 0;

        let appear_UD, appear_LR;
        let s_UD = 0,
            S_LR = 0;


        let s_wait_shutUR = 0,
            s_wait_shutDL = 0;
        let is_shit_UR, is_shit_DL;

        let s_boss = 0;
        let a_boss;

        function appear_boss() {
            if (a_boss) {
                if (s_boss++ > 500) {
                    a_boss = false;
                }
            } else {
                if (s_boss-- < 0) {
                    a_boss = true;
                }
            }
            if (a_boss) {
                boss.enableBody();
                boss.setVisible(true);
                boss.setVelocityY(50);
                boss.refreshBody();
            } else {
                boss.disableBody(true, true);
            }
        }

        function secound_shit() {
            if (is_shit_DL) {
                if (s_wait_shutDL++ > 300) {
                    is_shit_DL = false;
                }
            } else {
                if (s_wait_shutDL-- < 0) {
                    is_shit_DL = true;
                }
            }
            if (is_shit_UR) {
                if (s_wait_shutUR++ > 200) {
                    is_shit_UR = false;
                }
            } else {
                if (s_wait_shutUR-- < 0) {
                    is_shit_UR = true;
                }
            }
        }

        function shut_UR() {
            if (!is_shit_UR) {
                // trapD.enableBody();
                trapU.visible = true;
                trapU.setVelocityY(-100);
                trapU.y -= 0.5;
                trapU.refreshBody();
            } else {
                trapU.x = 11 * dis3;
                trapU.y = 13.5 * dis3;
                // trapD.disableBody(true, true);
                trapU.visible = false;
            }
            if (!is_shit_UR) {
                // trapD.enableBody();
                trapU1.visible = true;
                trapU1.setVelocityY(-100);
                trapU1.y -= 0.5;
                trapU1.refreshBody();
            } else {
                trapU1.x = 27 * dis3;
                trapU1.y = 29.5 * dis3;
                // trapD.disableBody(true, true);
                trapU1.visible = false;
            }
            if (!is_shit_UR) {
                // trapD.enableBody();
                trapR.visible = true;
                trapR.setVelocityX(100);
                trapR.x += 0.5;
                trapR.refreshBody();
            } else {
                trapR.x = 7.5 * dis3;
                trapR.y = 25 * dis3;
                // trapD.disableBody(true, true);
                trapR.visible = false;
            }
        }

        function shut_DL() {
            if (!is_shit_DL) {
                // trapD.enableBody();
                trapD.visible = true;
                trapD.setVelocityY(100);
                trapD.y += 0.3;
                trapD.refreshBody();
            } else {
                trapD.x = 23 * dis3;
                trapD.y = 23.5 * dis3;
                // trapD.disableBody(true, true);
                trapD.visible = false;
            }
            if (!is_shit_DL) {
                // trapD.enableBody();
                trapL.visible = true;
                trapL.setVelocityX(-100);
                trapL.x -= 0.3;
                trapL.refreshBody();
            } else {
                trapL.x = 14.5 * dis3;
                trapL.y = 21 * dis3;
                // trapD.disableBody(true, true);
                trapL.visible = false;
            }
        }

        function secound_appear() {
            if (appear_UD) {
                if (s_UD++ > 220) {
                    appear_UD = false;
                }
            } else {
                if (s_UD-- < 0) {
                    appear_UD = true;
                }
            }
            if (appear_LR) {
                if (S_LR++ > 250) {
                    appear_LR = false;
                }
            } else {
                if (S_LR-- < 0) {
                    appear_LR = true;
                }
            }
        }

        function appear_trapUD() {
            for (let i = 0; i < trapD_D.children.entries.length; i++) {
                if (appear_UD) {
                    trapD_D.children.entries[i].enableBody();
                    trapD_D.children.entries[i].setVisible(true);
                    // trapD_D.children.entries[i].visible = true;
                    trapD_D.children.entries[i].setVelocityY(50);
                    trapD_D.children.entries[i].refreshBody();
                } else {
                    trapD_D.children.entries[i].disableBody(true, true);
                    // trapD_D.children.entries[i].visible = false;
                }

            }
        }

        function appear_trapLR() {
            for (let i = 0; i < trapD_L.children.entries.length; i++) {
                if (!appear_LR) {
                    trapD_L.children.entries[i].enableBody();
                    trapD_L.children.entries[i].setVisible(true);
                    // trapD_D.children.entries[i].visible = true;
                    trapD_L.children.entries[i].setVelocityX(-50);
                    trapD_L.children.entries[i].refreshBody();
                } else {
                    trapD_L.children.entries[i].disableBody(true, true);
                    // trapD_D.children.entries[i].visible = false;
                }

            }
            for (let i = 0; i < trapD_R.children.entries.length; i++) {
                if (appear_LR) {
                    trapD_R.children.entries[i].enableBody();
                    trapD_R.children.entries[i].setVisible(true);
                    // trapD_D.children.entries[i].visible = true;
                    trapD_R.children.entries[i].setVelocityX(50);
                    trapD_R.children.entries[i].refreshBody();
                } else {
                    trapD_R.children.entries[i].disableBody(true, true);
                    // trapD_D.children.entries[i].visible = false;
                }

            }
        }

        function secound_move() {
            if (change_s_3) {
                if (s_3++ > 760) {
                    change_s_3 = false;
                }
            } else {
                if (s_3-- < -20) {
                    change_s_3 = true;
                }
            }
            if (change_s_2) {
                if (s_2++ > 600) {
                    change_s_2 = false;
                }
            } else {
                if (s_2-- < 0) {
                    change_s_2 = true;
                }
            }
            if (change_s_1) {
                if (s_1++ > 320) {
                    change_s_1 = false;
                }
            } else {
                if (s_1-- < 0) {
                    change_s_1 = true;
                }
            }
        }

        function move_WS1() {
            for (let i = 0; i < wolve_S_1.children.entries.length; i++) {
                if (change_s_1) {
                    wolve_S_1.children.entries[i].y += 0.12;
                } else {
                    wolve_S_1.children.entries[i].y -= 0.12;
                }
                wolve_S_1.children.entries[i].refreshBody();
            }
        }

        function move_WH2() {
            if (change_s_2) {
                wolve_H_2.x += 0.15;
            } else {
                wolve_H_2.x -= 0.15;
            }
            wolve_H_2.refreshBody();
        }

        function move_WH3() {
            for (let i = 0; i < wolve_H_3.children.entries.length; i++) {
                if (change_s_3) {
                    wolve_H_3.children.entries[i].x += 0.16;
                } else {
                    wolve_H_3.children.entries[i].x -= 0.16;
                }
                wolve_H_3.children.entries[i].refreshBody();
            }
        }

        function move_MS1() {
            for (let i = 0; i < monster_S.children.entries.length; i++) {
                if (change_s_2) {
                    monster_S.children.entries[i].y += 0.08;
                } else {
                    monster_S.children.entries[i].y -= 0.08;
                }
                monster_S.children.entries[i].refreshBody();
            }
        }

        function move_MH1() {
            for (let i = 0; i < monster_H.children.entries.length; i++) {
                if (change_s_2) {
                    monster_H.children.entries[i].x += 0.09;
                } else {
                    monster_H.children.entries[i].x -= 0.09;
                }
                monster_H.children.entries[i].refreshBody();
            }
        }

        function loseLove() {
            blood.children.entries[blood_num].visible = false;
            blood_num--;
            if (blood_num == -1) {
                console.log("lose");
            }
        }

        function lose_love_W(boy, wolve) {
            if (!wait) {
                if (drug_num > 0) {
                    drug_num--;
                    B3_text.setText("X" + drug_num);
                    if (drug_num == 0) {
                        B_drug.visible = false;
                        B3_text.visible = false;
                    }
                } else {
                    if (Dumb_num > 0) {
                        Dumb_num--;
                        B2_text.setText("X" + Dumb_num);
                        Dumb_use = true;
                        if (Dumb_num == 0) {
                            B_Dumb.visible = false;
                            B2_text.visible = false;
                        }
                    } else {
                        loseLove();
                        if (blood_num == -1) {
                            this.scene.start('scene_lose');
                            PART3_music.stop();
                        }
                    }
                }
                wait = true;
            }
        }

        function lose_love_M(boy, monster) {
            if (!wait) {
                if (egg_num > 0) {
                    wait = true;
                    egg_num--;
                    monster.disableBody(true, true);
                } else {

                }
                if (egg_num > 0) {
                    wait = true;
                    egg_num--;
                    B1_text.setText("X" + egg_num);
                    monster.disableBody(true, true);
                    if (egg_num == 0) {
                        B_egg.visible = false;
                        B1_text.visible = false;
                    }
                } else {
                    if (drug_num > 0) {
                        drug_num--;
                        B3_text.setText("X" + drug_num);
                        if (drug_num == 0) {
                            B_drug.visible = false;
                            B3_text.visible = false;
                        }
                    } else {
                        if (Dumb_num > 0) {
                            Dumb_num--;
                            B2_text.setText("X" + Dumb_num);
                            Dumb_use = true;
                            if (Dumb_num == 0) {
                                B_Dumb.visible = false;
                                B2_text.visible = false;
                            }
                        } else {
                            loseLove();
                            if (blood_num == -1) {
                                this.scene.start('scene_lose');
                                PART3_music.stop();
                            }
                        }
                    }
                }
                wait = true;
            }
        }

        function lose_love_tD(boy, trap) {
            Fboy.x = 9 * dis3;
            Fboy.y = 1 * dis3;
            if (drug_num > 0) {
                drug_num--;
                B3_text.setText("X" + drug_num);
                if (drug_num == 0) {
                    B_drug.visible = false;
                    B3_text.visible = false;
                }
            } else {
                if (Dumb_num > 0) {
                    Dumb_num--;
                    B2_text.setText("X" + Dumb_num);
                    Dumb_use = true;
                    if (Dumb_num == 0) {
                        B_Dumb.visible = false;
                        B2_text.visible = false;
                    }
                } else {
                    loseLove();
                    if (blood_num == -1) {
                        this.scene.start('scene_lose');
                        PART3_music.stop();
                    }
                }
            }
            wait = true;

        }

        function lose_love_t(boy, trap) {
            Fboy.x = 27 * dis3;
            Fboy.y = 21 * dis3;
            if (drug_num > 0) {
                drug_num--;
                B3_text.setText("X" + drug_num);
                if (drug_num == 0) {
                    B_drug.visible = false;
                    B3_text.visible = false;
                }
            } else {
                if (Dumb_num > 0) {
                    Dumb_num--;
                    B2_text.setText("X" + Dumb_num);
                    Dumb_use = true;
                    if (Dumb_num == 0) {
                        B_Dumb.visible = false;
                        B2_text.visible = false;
                    }
                } else {
                    loseLove();
                    if (blood_num == -1) {
                        this.scene.start('scene_lose');
                        PART3_music.stop();
                    }
                }
            }
            wait = true;

        }

        function influence_speed_H_4(boy, inc) {
            if (cursors.left.isDown) {
                speed = 120;
            } else {
                speed = 50;
            }
            Fboy.x -= 0.7;
        }

        function influence_speed_S_2(boy, inc) {
            if (cursors.down.isDown) {
                speed = 120;
            } else {
                speed = 50;
            }
            Fboy.y += 0.3;
        }

        function influence_speed_S_4(boy, inc) {
            if (cursors.down.isDown) {
                speed = 120;
            } else {
                speed = 50;
            }
            Fboy.y += 0.5;
        }

        function influence_speed_S(boy, swamp) {
            speed = 50;
        }

        function trap_move_1(boy, trap) {
            Fboy.x = 9 * dis3;
            Fboy.y = 27 * dis3;
        }

        function trap_move_2(boy, trap) {
            Fboy.x = 9 * dis3;
            Fboy.y = 1 * dis3;
        }

        function trap_move_3(boy, trap) {
            Fboy.x = 23 * dis3;
            Fboy.y = 21 * dis3;
        }

        function Recap() {
            if (recap_1) {
                Move = false;
                switch (chat_num) {
                    case 0:
                        dialogue.visible = true;
                        dialogue.setText("小明:怎麼那麼多狼…\n得找點東西制伏狼…");
                        previous.visible = false;
                        break;
                    case 1:
                        dialogue.setText("小明:……");
                        previous.visible = true;
                        break;
                    case 2:
                        dialogue.setText("小明:…阿!小美家是種田的!\n說不定會有可以當作防身用的農具！");
                        break;
                    case 3:
                        dialogue.setText("小明:還可以順便跟她聊天～\n嘿嘿嘿～我是天才吧～");
                        break;
                    case 4:
                        dialogue.setText("？？？:救命啊！！！");
                        break;
                    case 5:
                        dialogue.setText("小明:!!!???該不會是被狼突襲了！？\n聲音是從前方傳來的！去救那個人吧！");
                        break;
                    case 6:
                        chat.visible = next.visible = previous.visible = false;
                        dialogue.visible = false;
                        Move = true;
                        taskText.setText("找出尖叫的人");
                        recap_1 = false;
                        chat_num = 0;
                        break;

                }
            }
        }

        let record_s = 0;

        function chat_Awan() {
            if (enable_Awan) {
                switch (chat_num) {
                    case 0:
                        AwanText.visible = true;
                        AwanText.setText("阿文:呼～～～謝謝你耶！\n...咦？這不是小明嗎？又見面了");
                        previous.visible = false;
                        break;
                    case 1:
                        AwanText.setText("小明:原來是阿文呀...\n你怎麼又一個人在危險的地方...");
                        previous.visible = true;
                        break;
                    case 2:
                        AwanText.setText("阿文:想要出村外探險呀！");
                        break;
                    case 3:
                        AwanText.setText("阿文:那你怎麼會在這?");
                        break;
                    case 4:
                        AwanText.setText("小明:我要去白鸛村一趟");
                        break;
                    case 5:
                        AwanText.setText("阿文:原來，那你要小心喔，\n為了防止狼大大突襲我們村莊，\n路上設置了很多機關！");
                        break;
                    case 6:
                        AwanText.setText("阿文:還有一隻是首領狼大大，\n超級厲害的，對了\n我剛剛不是有給你一個蘋果嗎");
                        break;
                    case 7:
                        AwanText.setText("阿文:你可以將毒蘋果放置在他的老窩，\n以那隻首領大大貪婪的個性，\n一定會毫不猶豫的吃掉");
                        break;
                    case 8:
                        AwanText.setText("阿文:小心不要被首領看到，\n不然他一定會吃了你");
                        break;
                    case 9:
                        AwanText.setText("阿文:我想要在探險一會耶嘿～\n對了，這個是謝謝你救我的獎勵");
                        break;
                    case 10:
                        record_s++;
                        AwanText.setText("（得到了藥丸*2、雞蛋*2）");
                        if (record_s == 1) {
                            drug_num += 2;
                            egg_num += 2;
                        }
                        break;
                    case 11:
                        AwanText.setText("阿明:...(算了，\n目前這附近沒有狼就隨他開心吧");
                        break;
                    case 12:
                        chat.visible = next.visible = previous.visible = false;
                        AwanText.visible = false;
                        Move = true;
                        taskText.setText("擊敗首領大大！\n(到達指定位置以空白鍵放置蘋果)");
                        enable_Awan = false;
                        chat_num = 0;
                        break;

                }
            }
        }

        function wind_change_speed() {
            if (Fboy.x > 6 * dis3 && Fboy.x < 20 * dis3 && Fboy.y > 4 * dis3 && Fboy.y < 6 * dis3) {
                if (cursors.right.isDown) {
                    speed = 120;
                } else {
                    speed = 50;
                }
                wind_music.play();

            }
            if (Fboy.x > 12 * dis3 && Fboy.x < 22 * dis3 && Fboy.y > 12 * dis3 && Fboy.y < 16 * dis3) {
                if (cursors.right.isDown) {
                    speed = 120;
                } else {
                    speed = 50;
                }
                wind_music.play();

            }
            //這裡要有風的音效
        }

        function set_poison() {
            if (Fboy.x > 32 * dis3 && Fboy.x < 36 * dis3 && Fboy.y > 0 * dis3 && Fboy.y < 4 * dis3) {
                if (cursors.space.isDown) {
                    poison_num--;
                    pos.visible = true;
                    pos.x = Fboy.x;
                    pos.y = Fboy.y;
                }
            }
        }

        function lose_map3() {
            console.log("lose");
            this.scene.start('scene_lose');
            PART3_music.stop();
        }


        function win() {
            console.log("win");
            this.scene.start('scene_part3_text');
        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第三關劇情

        function scene_part3_text_preload() {
            /* ============================================================================================================== */
            //第三關劇情故事
            this.load.image('PART3', 'assets/plot_of_a_play/PART3.jpg');
            this.load.spritesheet('PART3_text', 'assets/plot_of_a_play/PART3_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            /* ============================================================================================================== */
        }

        function scene_part3_text_create() {
            this.add.image(0, 0, 'PART3').setOrigin(0, 0);
            let PART3_text = this.add.sprite(0, 0, 'PART3_text').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    s++;
                    PART3_text.setFrame(s);
                    if (s == 2) {
                        s = 0;
                        this.scene.start('scene_room');
                        this.scene.stop('scene_part3');
                        wardrobe_num = 1;
                        backpack_num = 3;
                        PART3_music.stop();
                        playagain_num = 3;
                    }
                    if (s == 1) {
                        PART3_music.stop();
                    }
                });
        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第四關

        let dis4;
        let plotText4;
        let ugle_map4;

        let taskText_map4;
        let brick_flower, brick1, brick2;
        let brick2_map4_P_S_2, brick2_map4_P_H_1;
        let brick1_map4_H_2;
        let brick1_map4_S_1, brick1_map4_H_1;
        let brick1_map4_C_H_3, brick1_map4_C_S_3;
        let change_vD, change_vR;
        let exit_end, puddle;
        let flower4, lighting;
        let trap_hole4, trap_hole3, trap_hole2, trap_hole1, trap2_hole4;
        let change_speed_H, change_speed_S;

        function scene_part4_preload() {
            this.load.crossOrigin = 'anonymous';
            this.load.image("gameUI4", "assets/map4/game4UI.png");
            this.load.image("home", "assets/room/home.png");

            //血條
            this.load.image("blood", "assets/blood.png");

            //地圖
            this.load.image('mazeTiles4', 'assets/map/tiles_map4.png');
            this.load.tilemapCSV('map4', 'assets/map/map_4.csv');

            //人物
            this.load.image("Fboy", "assets/role/fat_boy.png");
            this.load.image("ugle", "assets/role/ugle.png");

            //道具
            this.load.image("flower4", "assets/map4/flower4.png");

            //map2道具
            this.load.image("egg", "assets/map2/tool2_egg.png");
            this.load.image("drug", "assets/tool/tool_drug.png");
            this.load.image("poison", "assets/tool/poison.png");
            this.load.image("Dumbbell", "assets/tool/Dumbbell.png");


            //陷阱效果
            this.load.image("brick", "assets/map4/brick3.png");
            this.load.image("brick1_map4", "assets/map1/Brick1.png");
            this.load.image("brick2_map4", "assets/map1/Brick2.png");
            this.load.image("change_vD", "assets/map4/change4_V.png");
            this.load.image("change_vR", "assets/map4/change4_V2.png");

            this.load.image("exit_end", "assets/map4/exit_end.png");
            this.load.image("puddle", "assets/map4/trap_Puddle.png");

            this.load.image("brick_flower", "assets/map4/brick_flower.png");
            this.load.image("lighting", "assets/map4/lighting.png");

            this.load.image("trap_hole", "assets/map4/trap_hole.png");
            this.load.image("trap2_hole", "assets/map4/trap_hole2.png");

            this.load.image("change_speed_S", "assets/map4/change4_V.png");
            this.load.image("change_speed_H", "assets/map4/change4_V2.png");

            /* ============================================================================================================== */
            //衣服
            this.load.image("clothe1_change", "assets/clothes/clothe1.png");
            this.load.image("clothe2_change", "assets/clothes/clothe2.png");
            this.load.image("clothe3_change", "assets/clothes/clothe3.png");
            this.load.image("clothe4_change", "assets/clothes/clothe4.png");
            this.load.image("clothe5_change", "assets/clothes/clothe5.png");
            this.load.image("clothe6_change", "assets/clothes/clothe6.png");
            this.load.image("clothe7_change", "assets/clothes/clothe7.png");
            this.load.image("clothe8_change", "assets/clothes/clothe8.png");
            this.load.image("clothe9_change", "assets/clothes/clothe9.png");
            this.load.image("clothe10_change", "assets/clothes/clothe10.png");
            this.load.image("clothe11_change", "assets/clothes/clothe11.png");
            this.load.image("clothe12_change", "assets/clothes/clothe12.png");
            this.load.image("clothe13_change", "assets/clothes/clothe13.png");
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');
            this.load.audio('PART4_music', 'assets/backgroundmusic/PART4.mp3');

            this.load.audio('wind_music', 'assets/effectsound/wind.mp3');
            this.load.audio('water_music', 'assets/effectsound/water.mp3');
            this.load.audio('jump_music', 'assets/effectsound/jump.mp3');
            this.load.audio('drug_music', 'assets/effectsound/drug.wav');
            this.load.audio('dumbbell_music', 'assets/effectsound/dumbbell.mp3');
            /* ============================================================================================================== */
        }

        //音效
        // water_music;
        let PART4_music;

        function scene_part4_create() {

            /* ============================================================================================================== */
            //音樂音效

            PART4_music = this.sound.add('PART4_music', {
                volume: 1,
                loop: true
            });
            PART4_music.play();

            //音效
            wind_music = this.sound.add('wind_music', {
                volume: 1,
                loop: false
            });
            wind_music.stop();

            water_music = this.sound.add('water_music', {
                volume: 1,
                loop: false
            });
            water_music.stop();

            jump_music = this.sound.add('jump_music', {
                volume: 1,
                loop: false
            });
            jump_music.stop();

            let drug_music = this.sound.add('drug_music', {
                volume: 1,
                loop: false
            });
            drug_music.stop();

            let dumbbell_music = this.sound.add('dumbbell_music', {
                volume: 1,
                loop: false
            });
            dumbbell_music.stop();
            /* ============================================================================================================== */

            // ------------------------------------------------------------------------------------------------------------------------
            this.add.image(0, 0, "gameUI4").setOrigin(0, 0);
            this.add.image(1820, 850, "home").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    this.scene.start('scene_room');
                    this.scene.stop('scene_part4');
                    PART4_music.stop();
                    wardrobe_num = 0;
                    backpack_num = 3;
                });

            let speaker = this.add.image(1820, 950, "speaker").setOrigin(0, 0).setScale(0.25)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (PART4_music.mute) {
                        PART4_music.setMute(false);
                    } else {
                        PART4_music.setMute(true);
                    }
                });

            //血量
            blood = this.physics.add.group({
                key: "blood",
                repeat: 2,
                setXY: {
                    x: 1550,
                    y: 100,
                    stepX: 100
                },
                setScale: {
                    x: 0.2,
                    y: 0.2,
                }
            });


            //道具欄位至
            // apple = this.add.image(1400, 650, 'apple').setOrigin(0, 0).setScale(0.75);
            // poison = this.add.image(1400, 840, 'poison').setOrigin(0, 0).setScale(0.75);
            // Dumbbell = this.add.image(1580, 650, 'Dumbbell').setOrigin(0, 0).setScale(0.75);
            // drug = this.add.image(1580, 840, 'drug').setOrigin(0, 0).setScale(0.75);

            cam1 = this.cameras.add(1080, 0, config.width - 1080, 1080);
            cam1.setBounds(1080, 0, config.width - 1080, 1080);
            cam1.setViewport(1080, 0, config.width - 1080, 1080);

            dis4 = 30;

            flower4 = this.physics.add.group();
            flower4.createMultiple([{
                key: "flower4",
                setXY: {
                    x: 21 * dis4,
                    y: 9 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flower4",
                setXY: {
                    x: 29 * dis4,
                    y: 1 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flower4",
                setXY: {
                    x: 13 * dis4,
                    y: 33 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "flower4",
                setXY: {
                    x: 33 * dis4,
                    y: 35 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            flower4.children.entries[1].setImmovable();


            change_speed_H = this.physics.add.group();
            change_speed_H.createMultiple([{
                key: "change_speed_H",
                setXY: {
                    x: 25 * dis4,
                    y: 35 * dis4,
                },
                setScale: {
                    x: 0.18,
                    y: 0.18
                }
            }, {
                key: "change_speed_H",
                setXY: {
                    x: 31 * dis4,
                    y: 21 * dis4,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            change_speed_S = this.physics.add.sprite(5 * dis4, 21 * dis4, "change_speed_S").setScale(0.18);

            brick_flower = this.physics.add.sprite(25 * dis4, 3 * dis4, "brick_flower").setScale(0.5);
            brick_flower.setImmovable();


            brick1 = this.physics.add.sprite(23 * dis4, 31 * dis4, "brick").setScale(0.06);
            brick2 = this.physics.add.sprite(33 * dis4, 3 * dis4, "brick").setScale(0.06);

            brick1_map4_H_1 = this.physics.add.sprite(15 * dis4, 23 * dis4, "brick1_map4").setScale(0.15);

            brick1_map4_H_2 = this.physics.add.group();
            brick1_map4_H_2.createMultiple([{
                key: "brick1_map4",
                repeat: 1,
                setXY: {
                    x: 1 * dis4,
                    y: 11 * dis4,
                    stepY: dis4 * 4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            brick1_map4_S_1 = this.physics.add.group();
            brick1_map4_S_1.createMultiple([{
                key: "brick2_map4",
                repeat: 1,
                setXY: {
                    x: 9 * dis4,
                    y: 21 * dis4,
                    stepX: dis4 * 4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "brick2_map4",
                setXY: {
                    x: 31 * dis4,
                    y: 33 * dis4,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            brick1_map4_C_H_3 = this.physics.add.sprite(23 * dis4, 35 * dis4, "brick1_map4").setScale(0.15);
            brick1_map4_C_S_3 = this.physics.add.sprite(5 * dis4, 18 * dis4, "brick2_map4").setScale(0.15);

            brick2_map4_P_H_1 = this.physics.add.group();
            brick2_map4_P_H_1.createMultiple([{
                key: "brick1_map4",
                repeat: 1,
                setXY: {
                    x: 21 * dis4,
                    y: 15 * dis4,
                    stepY: dis4 * 4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            brick2_map4_P_S_2 = this.physics.add.group();
            brick2_map4_P_S_2.createMultiple([{
                key: "brick2_map4",
                repeat: 1,
                setXY: {
                    x: 25 * dis4,
                    y: 13 * dis4,
                    stepX: dis4 * 2,
                    stepY: dis4 * 2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);


            trap_hole1 = this.physics.add.group();
            trap_hole1.createMultiple([{
                key: "trap_hole",
                repeat: 2,
                setXY: {
                    x: 7 * dis4,
                    y: 13 * dis4,
                    stepY: 2 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            trap_hole2 = this.physics.add.group();
            trap_hole2.createMultiple([{
                key: "trap_hole",
                repeat: 2,
                setXY: {
                    x: 15 * dis4,
                    y: 17 * dis4,
                    stepY: 2 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            trap_hole3 = this.physics.add.sprite(19 * dis4, 31 * dis4, "trap_hole").setScale(0.15);

            trap_hole4 = this.physics.add.group();
            trap_hole4.createMultiple([{
                key: "trap_hole",
                setXY: {
                    x: 29 * dis4,
                    y: 5 * dis4,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "trap_hole",
                repeat: 1,
                setXY: {
                    x: 29 * dis4,
                    y: 17 * dis4,
                    stepX: dis4 * 4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            trap2_hole4 = this.physics.add.group();
            trap2_hole4.createMultiple([{
                key: "trap2_hole",
                setXY: {
                    x: 35 * dis4,
                    y: 21 * dis4,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "trap2_hole",
                repeat: 1,
                setXY: {
                    x: 33 * dis4,
                    y: 31 * dis4,
                    stepY: dis4 * 2
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            lighting = this.physics.add.group();
            lighting.createMultiple([{
                key: "lighting",
                repeat: 3,
                setXY: {
                    x: 11 * dis4,
                    y: 13 * dis4,
                    stepY: 2 * dis4
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }, {
                key: "lighting",
                setXY: {
                    x: 33 * dis4,
                    y: 7 * dis4,
                },
                setScale: {
                    x: 0.15,
                    y: 0.15
                }
            }]);

            ugle_map4 = this.physics.add.sprite(11 * dis4, 5 * dis4, "ugle").setScale(0.05);

            map = this.make.tilemap({
                key: 'map4',
                tileWidth: 60,
                tileHeight: 60,
            });

            tileset = map.addTilesetImage('mazeTiles4');
            layer = map.createLayer(0, tileset, 0, 0);
            map.setCollisionBetween(0, 9, true, layer);

            Fboy = this.physics.add.sprite(1 * dis4, 35 * dis4, "Fboy").setScale(0.04);

            switch (Fboy_clothe) {
                case 0:
                    Fboy.setTexture('Fboy');
                    break;
                case 1:
                    Fboy.setTexture('clothe1_change');
                    break;
                case 2:
                    Fboy.setTexture('clothe2_change');
                    break;
                case 3:
                    Fboy.setTexture('clothe3_change');
                    break;
                case 4:
                    Fboy.setTexture('clothe4_change');
                    break;
                case 5:
                    Fboy.setTexture('clothe5_change');
                    break;
                case 6:
                    Fboy.setTexture('clothe6_change');
                    break;
                case 7:
                    Fboy.setTexture('clothe7_change');
                    break;
                case 8:
                    Fboy.setTexture('clothe8_change');
                    break;
                case 9:
                    Fboy.setTexture('clothe9_change');
                    break;
                case 10:
                    Fboy.setTexture('clothe10_change');
                    break;
                case 11:
                    Fboy.setTexture('clothe11_change');
                    break;
                case 12:
                    Fboy.setTexture('clothe12_change');
                    break;
                case 13:
                    Fboy.setTexture('clothe13_change');
                    break;

            }


            taskText = this.add.text(1400, 450, "收集紫丁香\n尋找白鸛", {
                fontSize: "32px",
                fill: "#000"
            });

            plotText4 = this.add.text(1550, 250, '電電雖然不會攻擊人，\n但是碰到會有麻痺效果喔！', {
                fontSize: "30px",
                fill: "#000"
            });
            cursors = this.input.keyboard.createCursorKeys();

            cam = this.cameras.main;
            cam.setBounds(0, 0, 1080, 1080);
            cam.startFollow(Fboy);
            this.cameras.main.setZoom(5);
            cam.setViewport(0, 0, 1080, 1080);

            min_cam = this.cameras.add(1110 - 180, -140, 500, 500);
            min_cam.setZoom(0.3).setViewport(1110 - 180, -140, 500, 500);

            Fboy.setCollideWorldBounds(true);

            B1_text = this.add.text(1490, 750, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B2_text = this.add.text(1490, 950, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B3_text = this.add.text(1670, 750, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B4_text = this.add.text(1670, 950, "X0", {
                fontSize: "40px",
                fill: "#000"
            });
            B1_text.visible = B2_text.visible = B3_text.visible = B4_text.visible = false;

            if (egg_num > 0) {
                B_egg = this.add.image(1450, 720, "egg").setScale(0.25);
                B1_text.setText("X" + egg_num);
                B1_text.visible = true;
            }
            if (Dumb_num > 0) {
                B_Dumb = this.add.image(1450, 910, "Dumbbell").setScale(0.25);
                B2_text.setText("X" + Dumb_num);
                B2_text.visible = true;
            }
            if (drug_num > 0) {
                B_drug = this.add.image(1630, 720, "drug").setScale(0.25);
                B3_text.setText("X" + drug_num);
                B3_text.visible = true;
            }
            if (poison_num > 0) {
                B_poison = this.add.image(1630, 910, "poison").setScale(0.25);
                B4_text.setText("X" + poison_num);
                B4_text.visible = true;
            }

            this.physics.add.collider(Fboy, layer);
            this.physics.add.collider(ugle_map4, layer, c_ugle_move, null, this);

            this.physics.add.collider(brick1, layer, changeMove1, null, this);
            this.physics.add.collider(brick2, layer, changeMove2, null, this);
            this.physics.add.collider(brick2, flower4, changeMove2, null, this);

            this.physics.add.collider(Fboy, brick_flower);
            this.physics.add.collider(ugle_map4, brick_flower);
            this.physics.add.collider(Fboy, ugle_map4, lose_map4, null, this);


            this.physics.add.overlap(Fboy, brick1_map4_C_H_3, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick1_map4_C_S_3, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick1_map4_H_1, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick1_map4_H_2, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick1_map4_S_1, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick2, lose_love_M_map, null, this);
            this.physics.add.overlap(Fboy, brick2_map4_P_H_1, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick2_map4_P_S_2, lose_love_M_map4, null, this);
            this.physics.add.overlap(Fboy, brick1, lose_love_M_map, null, this);

            this.physics.add.overlap(Fboy, trap_hole1, move_1, null, this);
            this.physics.add.overlap(Fboy, trap_hole2, move_2, null, this);
            this.physics.add.overlap(Fboy, trap_hole3, move_3, null, this);
            this.physics.add.overlap(Fboy, trap_hole4, move_4, null, this);
            this.physics.add.overlap(Fboy, trap2_hole4, move_4, null, this);

            this.physics.add.overlap(Fboy, lighting, Lighting, null, this);
            this.physics.add.overlap(Fboy, flower4, collect_flower, null, this);

            this.physics.add.overlap(Fboy, change_speed_S, CVD_speed, null, this);
            this.physics.add.overlap(Fboy, change_speed_H, CVR_speed, null, this);

            //-----------------------------------------------------------------------------------------------------------------------------

        }

        let speed4 = 80;
        let wait4 = false;
        let s_wait4 = 0;

        function scene_part4_update() {
            if (Move == true) {
                if (cursors.left.isDown) {
                    Fboy.setVelocityX(speed4 * -1);
                    Fboy.setVelocityY(0);
                } else if (cursors.right.isDown) {
                    Fboy.setVelocityX(speed4);
                    Fboy.setVelocityY(0);
                } else if (cursors.up.isDown) {
                    Fboy.setVelocityY(speed4 * -1);
                    Fboy.setVelocityX(0);
                } else if (cursors.down.isDown) {
                    Fboy.setVelocityY(speed4);
                    Fboy.setVelocityX(0);
                } else {
                    Fboy.setVelocityX(0);
                    Fboy.setVelocityY(0);
                }
            }

            if (Fboy.x > 1080 - dis4 / 2) {
                Fboy.x = 1080 - dis4 / 2;
            }

            if (Fboy.x < 4 * dis4 && Fboy.y < 4 * dis4) {
                console.log('win');
                this.scene.start('scene_part4_text');
                PART4_music.stop();
            }

            if (ugle_map4.x > 1080 - dis4 / 2) {
                ugle_map4.x = 1080 - dis4 / 2;
            }
            if (wait4 == true) {
                s_wait4++;

                if (s_wait4 > 100) {
                    wait4 = false;
                    s_wait4 = 0;
                }
            }

            move_brick();

            secound_move4();
            move_BS1();
            move_BH1();
            move_BH2();
            move_BCH3();
            move_BCS3();
            move_BPH();
            move_BPS();

            ugle_move4();

            wind_water();
        }

        let secound_light = 0;

        let collect_num = 0;
        let change_B_1 = true,
            change_B_2 = true;
        let x, y, x2, y2;
        let con = true,
            con2 = true;

        let c_s_1, c_s_2, c_s_3, c_s_4;
        let sec_3 = 0,
            sec_2 = 0,
            sec_1 = 0,
            sec_4 = 0;

        let U_move_time = 0,
            U_change = true;

        function secound_move4() {
            if (c_s_3) {
                if (sec_3++ > 400) {
                    sec_3 = 800;
                    c_s_3 = false;
                }
            } else {
                if (sec_3-- < 0) {
                    c_s_3 = true;
                }
            }
            if (c_s_2) {
                if (sec_2++ > 600) {
                    c_s_2 = false;
                }
            } else {
                if (sec_2-- < 0) {
                    c_s_2 = true;
                }
            }
            if (c_s_1) {
                if (sec_1++ > 350) {
                    c_s_1 = false;
                }
            } else {
                if (sec_1-- < 0) {
                    c_s_1 = true;
                }
            }
            if (c_s_4) {
                if (sec_4++ > 1200) {
                    c_s_4 = false;
                }
            } else {
                if (sec_4-- < 0) {
                    c_s_4 = true;
                }
            }
        }

        function move_BS1() {
            for (let i = 0; i < brick1_map4_S_1.children.entries.length; i++) {
                if (c_s_1) {
                    brick1_map4_S_1.children.entries[i].y += 0.12;
                } else {
                    brick1_map4_S_1.children.entries[i].y -= 0.12;
                }
                brick1_map4_S_1.children.entries[i].refreshBody();
            }
        }

        function move_BH1() {
            if (c_s_1) {
                brick1_map4_H_1.x += 0.12;
            } else {
                brick1_map4_H_1.x -= 0.12;
            }
            brick1_map4_H_1.refreshBody();
        }

        function move_BH2() {
            for (let i = 0; i < brick1_map4_H_2.children.entries.length; i++) {
                if (c_s_2) {
                    brick1_map4_H_2.children.entries[i].x += 0.15;
                } else {
                    brick1_map4_H_2.children.entries[i].x -= 0.15;
                }
                brick1_map4_H_2.children.entries[i].refreshBody();
            }
        }

        function move_BCH3() {
            if (c_s_3) {
                brick1_map4_C_H_3.x += 0.3;
            } else {
                brick1_map4_C_H_3.x -= 0.15;
            }
            brick1_map4_C_H_3.refreshBody();
        }

        function move_BCS3() {
            if (c_s_3) {
                brick1_map4_C_S_3.y += 0.3;
            } else {
                brick1_map4_C_S_3.y -= 0.15;
            }
            brick1_map4_C_S_3.refreshBody();
        }

        function move_BPH() {

            for (let i = 0; i < brick2_map4_P_H_1.children.entries.length; i++) {
                if (c_s_2) {
                    brick2_map4_P_H_1.children.entries[i].x += 0.07;
                } else {
                    brick2_map4_P_H_1.children.entries[i].x -= 0.07;
                }
                brick2_map4_P_H_1.children.entries[i].refreshBody();
            }

        }

        function move_BPS() {

            for (let i = 0; i < brick2_map4_P_S_2.children.entries.length; i++) {
                if (c_s_4) {
                    brick2_map4_P_S_2.children.entries[i].y += 0.1;
                } else {
                    brick2_map4_P_S_2.children.entries[i].y -= 0.1;
                }
                brick2_map4_P_S_2.children.entries[i].refreshBody();
            }

        }

        function collect_flower(boy, flower) {
            collect_num++;
            flower.disableBody(true, true);
            switch (collect_num) {
                case 1:
                    plotText4.setText("掉進黑洞會被傳回\n未知的地方喔！");
                    break;
                case 2:
                    plotText4.setText("白色小泥獸比紫色小泥獸\n活動力更強，要小心\n不要撞到喔！");
                    break;
                case 3:
                    plotText4.setText("有些地方風特別大，\n走路要小心了。");
                    break;
                case 4:
                    plotText4.setText("收集完畢！出發尋找白鸛！\n要小心阿雯喔～");
                    brick_flower.disableBody(true, true);
                    break;
            }
        }

        function move_brick() {
            if (change_B_1) {
                do {
                    con = false;
                    x = Math.floor(Math.random() * 9);
                    y = Math.floor(Math.random() * 9);
                    if ((x == 1 || x == 3 || x == 8) && (y == 1 || y == 3 || y == 8)) {
                        con = true;
                    }
                }
                while (con);
                change_B_1 = false;
            }

            if (change_B_2) {
                do {
                    con2 = false;
                    x2 = Math.floor(Math.random() * 9);
                    y2 = Math.floor(Math.random() * 9);
                    if ((x2 == 1 || x2 == 3 || x2 == 8) && (y2 == 1 || y2 == 3 || y2 == 8)) {
                        con2 = true;
                    }
                }
                while (con2);
                change_B_2 = false;
            }
            switch (x) {
                case 0:
                case 5:
                case 7:
                    brick1.setVelocityX(100);
                    break;
                case 1:
                case 3:
                case 9:
                    brick1.setVelocityX(0);
                    break;
                case 2:
                case 4:
                case 6:
                    brick1.setVelocityX(-100);
                    break;

            }
            switch (y) {
                case 2:
                case 4:
                case 6:
                    brick1.setVelocityY(100);
                    break;
                case 1:
                case 3:
                case 8:
                    brick1.setVelocityY(0);
                    break;
                case 0:
                case 5:
                case 7:
                    brick1.setVelocityY(-100);
                    break;

            }

            switch (x2) {
                case 0:
                case 5:
                case 7:
                    brick2.setVelocityX(100);
                    break;
                case 1:
                case 3:
                case 9:
                    brick2.setVelocityX(0);
                    break;
                case 2:
                case 4:
                case 6:
                    brick2.setVelocityX(-100);
                    break;

            }
            switch (y2) {
                case 2:
                case 4:
                case 6:
                    brick2.setVelocityY(100);
                    break;
                case 1:
                case 3:
                case 8:
                    brick2.setVelocityY(0);
                    break;
                case 0:
                case 5:
                case 7:
                    brick2.setVelocityY(-100);
                    break;

            }

            if (brick1.y > 32 * dis4 || brick1.y < 26 * dis4) {
                change_B_1 = true;
            }
            if (brick2.y > 11.5 * dis4) {
                change_B_2 = true;
            }
        }

        function changeMove1(brick, map) {
            change_B_1 = true;
        }

        function changeMove2(brick, map) {
            change_B_2 = true;
        }

        function loseLove_map4() {
            blood.children.entries[blood_num].visible = false;
            blood_num--;
            if (blood_num == -1) {
                console.log("失敗");
            }
        }

        function lose_love_M_map4(boy, monster) {
            if (!wait4) {
                if (egg_num > 0) {
                    wait4 = true;
                    egg_num--;
                    B1_text.setText("X" + egg_num);
                    monster.disableBody(true, true);
                    if (egg_num == 0) {
                        B_egg.visible = false;
                        B1_text.visible = false;
                    }
                } else {
                    if (drug_num > 0) {
                        drug_num--;
                        B3_text.setText("X" + drug_num);
                        if (drug_num == 0) {
                            B_drug.visible = false;
                            B3_text.visible = false;
                        }
                    } else {
                        if (Dumb_num > 0) {
                            Dumb_num--;
                            B2_text.setText("X" + Dumb_num);
                            Dumb_use = true;
                            if (Dumb_num == 0) {
                                B_Dumb.visible = false;
                                B2_text.visible = false;
                            }

                        } else {
                            loseLove_map4();
                            if (blood_num == -1) {
                                this.scene.start('scene_lose');
                                PART4_music.stop();
                            }
                        }
                    }
                }
                wait4 = true;

            }
        }

        function lose_love_M_map(boy, monster) {
            if (!wait4) {
                if (egg_num > 0) {
                    wait4 = true;
                    egg_num--;
                    B1_text.setText("X" + egg_num);
                    monster.disableBody(true, true);
                    if (egg_num == 0) {
                        B_egg.visible = false;
                        B1_text.visible = false;
                    }
                } else {
                    if (drug_num > 0) {
                        drug_num--;
                        B3_text.setText("X" + drug_num);
                        if (drug_num == 0) {
                            B_drug.visible = false;
                            B3_text.visible = false;
                        }
                    } else {
                        if (Dumb_num > 0) {
                            Dumb_num--;
                            B2_text.setText("X" + Dumb_num);
                            Dumb_use = true;
                            if (Dumb_num == 0) {
                                B_Dumb.visible = false;
                                B2_text.visible = false;
                            }

                        } else {
                            loseLove_map4();
                            if (blood_num == -1) {
                                this.scene.start('scene_lose');
                                PART4_music.stop();
                            }
                        }
                    }
                }
                wait4 = true;
            }
        }

        function ugle_move4() {
            if (ugle_map4.y < dis4) {
                ugle_map4.y = dis4;
                c_ugle_move = true;
            }
            if (ugle_map4.x < dis4) {
                ugle_map4.x = dis4;
                c_ugle_move = true;
            }

            U_move_time++;
            if (U_move_time > 200 || U_change) {

                switch (Math.floor(Math.random() * 9)) {
                    case 0:
                    case 6:
                        ugle_map4.setVelocityY(80);
                        break;
                    case 5:
                        ugle_map4.setVelocityY(-80);
                        break;
                    case 2:
                    case 3:
                    case 8:
                        ugle_map4.setVelocityX(80);
                        break;
                    case 4:
                    case 1:
                    case 7:
                        ugle_map4.setVelocityX(-80);
                        break;
                }

                U_move_time = 0;
                U_change = false;
            }
        }

        function c_ugle_move() {
            U_change = true;
        }

        function move_1() {
            Fboy.x = 13 * dis4;
            Fboy.y = 25 * dis4;
        }

        function move_2() {
            Fboy.x = 13 * dis4;
            Fboy.y = 11 * dis4;
        }

        function move_3() {
            Fboy.x = 19 * dis4;
            Fboy.y = 9 * dis4;
        }

        function move_4() {
            Fboy.x = 31 * dis4;
            Fboy.y = 25 * dis4;
        }

        function Lighting(boy, lighting) {
            secound_light++;
            if (secound_light < 300) {
                console.log(1);
                let x = Math.floor(Math.random() * 2);
                let y = Math.floor(Math.random() * 2);
                if (x) {
                    Fboy.x += 3;
                } else {
                    Fboy.x -= 3;
                }
                if (y) {
                    Fboy.y += 3;
                } else {
                    Fboy.y -= 3;
                }
            } else {
                Fboy.x = lighting.x - dis4 * 4;
                secound_light = 0;
                loseLove_map4();
                if (blood_num == -1) {
                    this.scene.start('scene_lose');
                    PART4_music.stop();
                }
            }
        }

        function CVD_speed(boy, layer) {
            if (cursors.down.isDown) {
                speed4 = 150;
            } else {
                speed4 = 50;
            }
            Fboy.y += 0.3;
        }

        function CVR_speed(boy, layer) {
            if (cursors.right.isDown) {
                speed4 = 150;
            } else {
                speed4 = 50;
            }
            Fboy.x += 0.3;
        }

        function wind_water() {
            if (Fboy.x < 8 * dis4 && Fboy.y > 10 * dis4 && Fboy.y < 18 * dis4) {
                Fboy.x += 0.3;
                //風聲
                wind_music.play();
            }
            if (Fboy.x > 22 * dis4 && Fboy.x < 28 * dis4 && Fboy.y > 12 * dis4 && Fboy.y < 20 * dis4) {
                speed4 = 50;
                //水聲
                water_music.play();
            }
        }

        function music() {
            if (Fboy.x > 14 * dis4 && Fboy.x < 24 * dis4 && Fboy.y > 26 * dis4 && Fboy.y < 32 * dis4) {
                //彈跳聲
                jump_music.play();
            }
            if (Fboy.x > 28 * dis4 && Fboy.y < 10 * dis4) {
                //彈跳聲
                jump_music.play();
            }
        }

        function lose_map4() {
            this.scene.start('scene_lose');
            this, scene.stop('scene_part4');
            PART4_music.stop();
        }


        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //第四關劇情

        function scene_part4_text_preload() {
            /* ============================================================================================================== */
            //第四關劇情故事
            this.load.image('PART4', 'assets/plot_of_a_play/PART4.jpg');
            this.load.spritesheet('PART4_text', 'assets/plot_of_a_play/PART4_text.png', {
                frameWidth: 1920,
                frameHeight: 1080
            });
            this.load.audio('PART1_music', 'assets/backgroundmusic/PART1.mp3');
            /* ============================================================================================================== */
        }

        function scene_part4_text_create() {
            PART1_music = this.sound.add('PART1_music', {
                volume: 1,
                loop: true
            });
            PART1_music.play();
            this.add.image(0, 0, 'PART4').setOrigin(0, 0);
            let PART4_text = this.add.sprite(0, 0, 'PART4_text').setOrigin(0, 0)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    s++;
                    PART4_text.setFrame(s);
                    if (s == 6) {
                        s = 0;
                        this.scene.start('scene_start');
                        this.scene.stop('scene_part4');
                        wardrobe_num = 1;
                        backpack_num = 3;
                        PART1_music.stop();
                        playagain_num = 3;


                        //第一關變數
                        blood_num = 2;
                        Hit_W = false;
                        secound_hit = 0;

                        Move = true;
                        movetime = 0;
                        change = false;

                        Is_move1 = true;
                        Is_move2 = true;
                        i1 = 0;
                        i2 = 0;

                        collect = 0;
                        ugle_move = false;

                        //第二關變數

                        S_coo = false;

                        Hit_M = false;

                        chat_num = 0;
                        H_egg = 0,
                            H_milk = 0,
                            H_flour = 0,
                            H_coin = 30;

                        enable_cle = false,
                            enable_clo = false,
                            enable_peo = false;
                        coin_num = 0;
                        egg_num = 0,
                            milk_num = 0,
                            flour_num = 0;
                        task1 = false,
                            task2 = false;
                        task3 = false;
                        Re = false;
                        pass_task1 = false;
                        change_cle = false,
                            can_buy_egg = false;

                        buy = false;
                        leave = false;
                        drug_num = 0,
                            Dumb_num = 0,
                            poison_num = 0;

                        give_num = 0;

                        //第三關

                        s_1 = 0;
                        s_2 = 0;
                        s_3 = 0;

                        s_UD = 0,
                            S_LR = 0;


                        s_wait_shutUR = 0,
                            s_wait_shutDL = 0;

                        s_boss = 0;
                        record_s = 0;

                        //第四關

                        speed4 = 80;
                        wait4 = false;
                        s_wait4 = 0;

                        secound_light = 0;

                        collect_num = 0;
                        change_B_1 = true,
                            change_B_2 = true;
                        con = true,
                            con2 = true;
                        sec_3 = 0,
                            sec_2 = 0,
                            sec_1 = 0,
                            sec_4 = 0;
                    }
                });
        }

        /* ============================================================================================================== */

        /* ============================================================================================================== */
        //遊戲失敗 & 重新開始 & 回上一關

        function scene_lose_preload() {
            /* ============================================================================================================== */
            //遊戲重新開始 & 回上一關
            this.load.image('gameover', 'assets/gameover/gameover.jpg');
            this.load.image('gohome', 'assets/gameover/gohome.png');
            this.load.image('playagain', 'assets/gameover/playagain.png');
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //音樂音效
            this.load.image('speaker', 'assets/else/music.png');
            this.load.image('mute', 'assets/else/music_mute.png');

            this.load.audio('gameover_music', 'assets/effectsound/gameover.wav');
            /* ============================================================================================================== */
        }

        let gameover, gohome_btn, playagain;
        let playagain_num = 0; //遊戲重新開始 & 回上一關

        let gameover_music; //音樂音效

        function scene_lose_create() {

            /* ============================================================================================================== */
            //音樂音效
            gameover_music = this.sound.add('gameover_music', {
                volume: 1,
                loop: false
            });
            gameover_music.play();
            /* ============================================================================================================== */


            /* ============================================================================================================== */
            //遊戲重新開始 & 回上一關

            gameover = this.add.image(0, 0, 'gameover').setOrigin(0, 0);
            gohome_btn = this.add.image(90, 100, 'gohome').setOrigin(0, 0).setScale(0.5)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    this.scene.start('scene_start');
                    this.scene.stop('scene_lose');

                    //第一關變數
                    blood_num = 2;
                    Hit_W = false;
                    secound_hit = 0;

                    Move = true;
                    movetime = 0;
                    change = false;

                    Is_move1 = true;
                    Is_move2 = true;
                    i1 = 0;
                    i2 = 0;

                    collect = 0;
                    ugle_move = false;

                    //第二關變數

                    S_coo = false;

                    Hit_M = false;

                    chat_num = 0;
                    H_egg = 0,
                        H_milk = 0,
                        H_flour = 0,
                        H_coin = 30;

                    enable_cle = false,
                        enable_clo = false,
                        enable_peo = false;
                    coin_num = 0;
                    egg_num = 0,
                        milk_num = 0,
                        flour_num = 0;
                    task1 = false,
                        task2 = false;
                    task3 = false;
                    Re = false;
                    pass_task1 = false;
                    change_cle = false,
                        can_buy_egg = false;

                    buy = false;
                    leave = false;
                    drug_num = 0,
                        Dumb_num = 0,
                        poison_num = 0;

                    give_num = 0;

                    //第三關

                    s_1 = 0;
                    s_2 = 0;
                    s_3 = 0;

                    s_UD = 0,
                        S_LR = 0;


                    s_wait_shutUR = 0,
                        s_wait_shutDL = 0;

                    s_boss = 0;
                    record_s = 0;

                    //第四關

                    speed4 = 80;
                    wait4 = false;
                    s_wait4 = 0;

                    secound_light = 0;

                    collect_num = 0;
                    change_B_1 = true,
                        change_B_2 = true;
                    con = true,
                        con2 = true;
                    sec_3 = 0,
                        sec_2 = 0,
                        sec_1 = 0,
                        sec_4 = 0;

                    //關掉音樂
                    gameover_music.destroy();
                });
            playagain = this.add.image(1550, 100, 'playagain').setOrigin(0, 0).setScale(0.5)
                .setInteractive({
                    useHandCursor: true
                })
                .on("pointerdown", (pointer, localX, localY, event) => {
                    switch (playagain_num) {
                        case 0:
                            //第一關變數
                            blood_num = 2;
                            Hit_W = false;
                            secound_hit = 0;

                            Move = true;
                            movetime = 0;
                            change = false;

                            Is_move1 = true;
                            Is_move2 = true;
                            i1 = 0;
                            i2 = 0;

                            this.scene.start('part1');
                            gameover_music.destroy();

                            break;
                        case 1:
                            //第一關function變數
                            blood_num = 2;
                            Hit_W = false;
                            secound_hit = 0;

                            Move = true;
                            movetime = 0;
                            change = false;

                            Is_move1 = true;
                            Is_move2 = true;
                            i1 = 0;
                            i2 = 0;

                            collect = 0;
                            ugle_move = false;

                            //第二關變數

                            S_coo = false;

                            Hit_M = false;

                            chat_num = 0;
                            H_egg = 0,
                                H_milk = 0,
                                H_flour = 0,
                                H_coin = 30;

                            enable_cle = false,
                                enable_clo = false,
                                enable_peo = false;
                            coin_num = 0;
                            egg_num = 0,
                                milk_num = 0,
                                flour_num = 0;
                            task1 = false,
                                task2 = false;
                            task3 = false;
                            Re = false;
                            pass_task1 = false;
                            change_cle = false,
                                can_buy_egg = false;

                            buy = false;
                            leave = false;
                            drug_num = 0,
                                Dumb_num = 0,
                                poison_num = 0;

                            give_num = 0;

                            this.scene.start('part2');
                            gameover_music.destroy();
                            break;
                        case 2:
                            //第一關function變數
                            blood_num = 2;
                            Hit_W = false;
                            secound_hit = 0;

                            Move = true;
                            movetime = 0;
                            change = false;

                            Is_move1 = true;
                            Is_move2 = true;
                            i1 = 0;
                            i2 = 0;

                            collect = 0;
                            ugle_move = false

                            //第二關變數

                            S_coo = false;

                            Hit_M = false;

                            chat_num = 0;
                            H_egg = 0,
                                H_milk = 0,
                                H_flour = 0,
                                H_coin = 30;

                            enable_cle = false,
                                enable_clo = false,
                                enable_peo = false;
                            coin_num = 0;
                            egg_num = 0,
                                milk_num = 0,
                                flour_num = 0;
                            task1 = false,
                                task2 = false;
                            task3 = false;
                            Re = false;
                            pass_task1 = false;
                            change_cle = false,
                                can_buy_egg = false;

                            buy = false;
                            leave = false;
                            drug_num = 0,
                                Dumb_num = 0,
                                poison_num = 0;

                            give_num = 0;

                            //第三關

                            s_1 = 0;
                            s_2 = 0;
                            s_3 = 0;

                            s_UD = 0,
                                S_LR = 0;


                            s_wait_shutUR = 0,
                                s_wait_shutDL = 0;

                            s_boss = 0;
                            record_s = 0;

                            break;
                        case 3:
                            //第一關function變數
                            blood_num = 2;
                            Hit_W = false;
                            secound_hit = 0;

                            Move = true;
                            movetime = 0;
                            change = false;

                            Is_move1 = true;
                            Is_move2 = true;
                            i1 = 0;
                            i2 = 0;

                            collect = 0;
                            ugle_move = false

                            //第二關變數

                            S_coo = false;

                            Hit_M = false;

                            chat_num = 0;
                            H_egg = 0,
                                H_milk = 0,
                                H_flour = 0,
                                H_coin = 30;

                            enable_cle = false,
                                enable_clo = false,
                                enable_peo = false;
                            coin_num = 0;
                            egg_num = 0,
                                milk_num = 0,
                                flour_num = 0;
                            task1 = false,
                                task2 = false;
                            task3 = false;
                            Re = false;
                            pass_task1 = false;
                            change_cle = false,
                                can_buy_egg = false;

                            buy = false;
                            leave = false;
                            drug_num = 0,
                                Dumb_num = 0,
                                poison_num = 0;

                            give_num = 0;

                            //第三關

                            s_1 = 0;
                            s_2 = 0;
                            s_3 = 0;

                            s_UD = 0,
                                S_LR = 0;


                            s_wait_shutUR = 0,
                                s_wait_shutDL = 0;

                            s_boss = 0;
                            record_s = 0;

                            //第四關

                            speed4 = 80;
                            wait4 = false;
                            s_wait4 = 0;

                            secound_light = 0;

                            collect_num = 0;
                            change_B_1 = true,
                                change_B_2 = true;
                            con = true,
                                con2 = true;
                            sec_3 = 0,
                                sec_2 = 0,
                                sec_1 = 0,
                                sec_4 = 0;

                            U_move_time = 0,
                                U_change = true;

                            break;

                    }

                    //關掉音樂
                    gameover_music.destroy();

                });
            /* ============================================================================================================== */

            /* ============================================================================================================== */
            //開啟/關閉音樂

            let speaker = this.add.image(config.width - 50, config.height - 50, 'speaker').setScale(0.2)
                .setInteractive({
                    useHandCursor: true
                })
                .on('pointerdown', () => {
                    if (speaker.texture.key == 'speaker') {
                        speaker.setTexture('mute');
                    } else {
                        speaker.setTexture('speaker');
                    }

                    if (gameover_music.mute) {
                        gameover_music.setMute(false);
                    } else {
                        gameover_music.setMute(true);
                    }

                });
            /* ============================================================================================================== */
        }
    </script>
</body>

</html>